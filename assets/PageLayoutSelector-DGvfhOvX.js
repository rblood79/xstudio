import{r as u,u as m,a0 as h,h as S,j as a,P as _,q as f,e as b,a9 as v,aa as w}from"./index-CMpD_Ir5.js";const $=u.memo(function({pageId:l}){const i=m(e=>e.pages.find(t=>t.id===l)),o=h(e=>e.layouts),r=h(e=>e.fetchLayouts);u.useEffect(()=>{o.length===0&&i?.project_id&&r(i.project_id)},[o.length,r,i?.project_id]);const n=i?.layout_id||"",c=u.useMemo(()=>o.find(e=>e.id===n),[o,n]),L=u.useMemo(()=>{const e=[{value:"",label:"No Layout"}];return o.forEach(t=>{e.push({value:t.id,label:t.name})}),e},[o]),y=u.useCallback(async e=>{console.log("ðŸ“ Page Layout changed:",{pageId:l,oldLayoutId:n,newLayoutId:e||null});try{const{pages:t,setPages:j,elements:p,setElements:P}=m.getState(),d=await S();let g=[...p];if(e){const s=await d.elements.getByLayout(e);console.log(`ðŸ“¥ [PageLayoutSelector] Layout ${e.slice(0,8)} ìš”ì†Œ ${s.length}ê°œ ì„  ë¡œë“œ`),g=[...p.filter(E=>E.layout_id!==e),...s],P(g)}const x=t.map(s=>s.id===l?{...s,layout_id:e||null}:s);j(x),await d.pages.update(l,{layout_id:e||null}),console.log("âœ… Page layout updated successfully")}catch(t){console.error("âŒ Failed to update page layout:",t)}},[l,n]);return o.length===0?null:a.jsxs(_,{title:"Layout",icon:f,children:[a.jsx(b,{label:"Apply Layout",value:n,onChange:y,options:L,icon:f,description:c?`Using "${c.name}" layout`:"Select a layout template for this page"}),c&&a.jsxs("div",{className:"page-layout-info",children:[c.description&&a.jsx("p",{className:"page-layout-description",children:c.description}),a.jsxs("button",{className:"page-layout-clear",onClick:()=>y(""),title:"Remove layout from this page",children:[a.jsx(v,{size:w.size}),a.jsx("span",{children:"Remove Layout"})]})]})]})});export{$ as PageLayoutSelector,$ as default};
