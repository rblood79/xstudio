import{r as c,u as d,a3 as m,h as S,j as a,P as b,n as h,d as v,a0 as w}from"./index-CjM1KX21.js";const k=c.memo(function({pageId:l}){const f=d(e=>e.pages.find(t=>t.id===l)),o=m(e=>e.layouts),i=m(e=>e.fetchLayouts);c.useEffect(()=>{o.length===0&&i()},[o.length,i]);const n=f?.layout_id||"",u=c.useMemo(()=>o.find(e=>e.id===n),[o,n]),L=c.useMemo(()=>{const e=[{value:"",label:"No Layout"}];return o.forEach(t=>{e.push({value:t.id,label:t.name})}),e},[o]),r=c.useCallback(async e=>{console.log("ðŸ“ Page Layout changed:",{pageId:l,oldLayoutId:n,newLayoutId:e||null});try{const{pages:t,setPages:x,elements:y,setElements:P}=d.getState(),p=await S();let g=[...y];if(e){const s=await p.elements.getByLayout(e);console.log(`ðŸ“¥ [PageLayoutSelector] Layout ${e.slice(0,8)} ìš”ì†Œ ${s.length}ê°œ ì„  ë¡œë“œ`),g=[...y.filter(E=>E.layout_id!==e),...s],P(g,{skipHistory:!0})}const j=t.map(s=>s.id===l?{...s,layout_id:e||null}:s);x(j),await p.pages.update(l,{layout_id:e||null}),console.log("âœ… Page layout updated successfully")}catch(t){console.error("âŒ Failed to update page layout:",t)}},[l,n]);return o.length===0?null:a.jsxs(b,{title:"Layout",icon:h,children:[a.jsx(v,{label:"Apply Layout",value:n,onChange:r,options:L,icon:h,description:u?`Using "${u.name}" layout`:"Select a layout template for this page"}),u&&a.jsxs("div",{className:"page-layout-info",children:[u.description&&a.jsx("p",{className:"page-layout-description",children:u.description}),a.jsxs("button",{className:"page-layout-clear",onClick:()=>r(""),title:"Remove layout from this page",children:[a.jsx(w,{size:14}),a.jsx("span",{children:"Remove Layout"})]})]})]})});export{k as PageLayoutSelector,k as default};
