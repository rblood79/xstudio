import{aE as p,aF as F,aG as C,aH as x,aI as M,aJ as b,aK as _}from"./index-DGQUgweO.js";var l=(e=>(e.Margin="margin",e.Padding="padding",e.Border="border",e.Flex="flex",e.Content="content",e))(l||{});function w(e,t){const r=`getComputed${t.charAt(0).toUpperCase()+t.slice(1)}`;return{top:e.yoga[r](p.Top),right:e.yoga[r](p.Right),bottom:e.yoga[r](p.Bottom),left:e.yoga[r](p.Left)}}function B(e,t){const{width:r,height:h}=e.computedLayout,s=w(e,"margin"),i=w(e,"border"),c=w(e,"padding"),n=t.get("margin");n.outer.x=-s.left,n.outer.y=-s.top,n.outer.width=r+s.left+s.right,n.outer.height=h+s.top+s.bottom,n.inner.x=0,n.inner.y=0,n.inner.width=r,n.inner.height=h;const o=t.get("border");o.outer.x=0,o.outer.y=0,o.outer.width=r,o.outer.height=h,o.inner.x=i.left,o.inner.y=i.top,o.inner.width=r-i.left-i.right,o.inner.height=h-i.top-i.bottom;const a=t.get("padding");a.outer.copyFrom(o.inner),a.inner.x=c.left+i.left,a.inner.y=c.top+i.top,a.inner.width=r-c.left-c.right-i.left-i.right,a.inner.height=h-c.top-c.bottom-i.top-i.bottom,E(e,t)}function E(e,t){var r;const h=t.get("flex"),s=t.get("padding");h.outer.copyFrom(s.inner);const i=new F,c=e.yoga.getChildCount();for(let o=0;o<c;o++){const d=e.yoga.getChild(o).getComputedLayout();i.addRect(new C(d.left,d.top,d.width,d.height))}const n=e.yoga.getFlexDirection();n===x.Column||n===x.ColumnReverse?(i.width=h.outer.width,i.x=h.outer.x):(i.height=h.outer.height,i.y=h.outer.y),(r=h.inner)==null||r.copyFrom(i.rectangle),t.get("content").outer.copyFrom(i.rectangle)}var O=Object.defineProperty,A=(e,t,r)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v=(e,t,r)=>A(e,typeof t!="symbol"?t+"":t,r);function P(e,t,r){const h=Math.round(e[0]+(t[0]-e[0])*r),s=Math.round(e[1]+(t[1]-e[1])*r),i=Math.round(e[2]+(t[2]-e[2])*r);return`rgb(${h},${s},${i})`}class G extends M{constructor(){super(),v(this,"graphics"),v(this,"heatGraphics"),this.graphics=new Map,Object.values(l).forEach(t=>{const r=new b;this.graphics.set(t,r),this.addChild(r)}),this.heatGraphics=new b,this.addChild(this.heatGraphics)}init(t){const{target:r,alpha:h,heat:s}=t;t.heatOnly||Object.entries(t).forEach(([n,o])=>{if(n==="target"||n==="alpha"||n==="heat"||n==="heatOnly")return;o=o;const a=this.graphics.get(n);if(!(!a||!o.draw))if(o.inner)this.drawCutBox(a,o.outer,o.inner,o.color,h);else{const{x:d,y:u,width:g,height:m}=o.outer;a.rect(d,u,g,Math.max(m,1)),a.fill({color:o.color,alpha:h})}});const{invalidationCount:i,draw:c}=s;if(i>0&&c){const o=Math.min(i/20,1),a=t[l.Margin],g=P([255,255,0],[255,0,0],o);this.heatGraphics.rect(a.outer.x,a.outer.y,a.outer.width,a.outer.height),this.heatGraphics.fill({color:g,alpha:Math.min(.3,o)}),this.heatGraphics.stroke({color:g,alpha:Math.max(.3,o),pixelLine:!0})}this.position.set(r.x,r.y)}reset(){this.graphics.forEach(t=>t.clear()),this.heatGraphics.clear(),this.removeFromParent()}drawCutBox(t,r,h,s,i){const{x:c,y:n,width:o,height:a}=r,{x:d,y:u,width:g,height:m}=h;t.rect(c,n,o,a),t.fill({color:s,alpha:i}),t.rect(d,u,g,m),t.cut()}}var $=Object.defineProperty,R=(e,t,r)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f=(e,t,r)=>R(e,typeof t!="symbol"?t+"":t,r);class L{constructor(){f(this,"holder",new M),f(this,"regions",new Map),f(this,"colors",{[l.Margin]:"#B68655",[l.Padding]:"#BAC57F",[l.Border]:"#E7C583",[l.Content]:"#89B1BE",[l.Flex]:"#6E28D9"}),f(this,"alpha",.75),Object.values(l).forEach(t=>{this.regions.set(t,{outer:new C,inner:new C})}),this.holder.__devtoolIgnore=!0,this.holder.__devtoolIgnoreChildren=!0,this.holder.eventMode="none",this.holder.interactiveChildren=!1}reset(){for(let t=this.holder.children.length-1;t>=0;t--){const r=this.holder.children[t];_.return(r)}}render(t){B(t,this.regions);const r=Object.values(l).reduce((n,o)=>{const a=this.regions.get(o);if(!a)return n;const d=`debugDraw${o.charAt(0).toUpperCase()}${o.slice(1)}`;return n[o]={...a,color:this.colors[o],draw:t._styles.custom[d]??!0},n},{}),{left:h,top:s}=t.computedLayout,i=t.target.getGlobalPosition(),c=_.get(G,{...r,target:{x:i.x+h,y:i.y+s},alpha:this.alpha,heat:{invalidationCount:t._modificationCount,draw:t._styles.custom.debugHeat!==!1},heatOnly:!t._styles.custom.debug});this.holder.addChildAt(c,0)}destroy(){this.reset(),this.holder.destroy(),this.regions.clear()}}export{L as DebugRenderer};
