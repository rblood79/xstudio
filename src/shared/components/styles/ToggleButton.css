@layer components {
  .react-aria-ToggleButton {
    /* CSS Variables for variant theming */
    --tb-selected-bg: var(--primary);
    --tb-selected-bg-pressed: var(--primary-pressed);
    --tb-selected-border: var(--primary);
    --tb-selected-border-pressed: var(--primary-pressed);
    --tb-selected-text: var(--on-primary);

    color: var(--on-surface);
    background: var(--surface-container-high);
    border: 1px solid var(--outline-variant);
    forced-color-adjust: none;
    border-radius: var(--border-radius);
    appearance: none;
    vertical-align: middle;
    font-size: var(--text-sm);
    text-align: center;
    margin: 0;
    outline: none;
    padding: var(--spacing) var(--spacing-md);

    &[data-pressed] {
      box-shadow: var(--inset-shadow-sm);
      background: color-mix(in srgb, var(--surface-container-high) 92%, black);
      border-color: var(--outline);
    }

    &[data-selected] {
      background: var(--tb-selected-bg);
      border-color: var(--tb-selected-border);
      color: var(--tb-selected-text);

      &[data-pressed] {
        background: var(--tb-selected-bg-pressed);
        border-color: var(--tb-selected-border-pressed);
      }
    }

    &[data-focus-visible] {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    &[data-disabled] {
      background: color-mix(in srgb, var(--on-surface) 12%, transparent);
      color: color-mix(in srgb, var(--on-surface) 38%, transparent);
      border-color: transparent;
      opacity: 0.38;
    }
  }

  /* ===== M3 Primary ===== */
  .react-aria-ToggleButton.primary,
  .react-aria-ToggleButtonGroup[data-togglebutton-variant="primary"]
    .react-aria-ToggleButton {
    --tb-selected-bg: var(--primary);
    --tb-selected-bg-pressed: var(--primary-pressed);
    --tb-selected-border: var(--primary);
    --tb-selected-border-pressed: var(--primary-pressed);
    --tb-selected-text: var(--on-primary);
  }

  /* ===== M3 Secondary ===== */
  .react-aria-ToggleButton.secondary,
  .react-aria-ToggleButtonGroup[data-togglebutton-variant="secondary"]
    .react-aria-ToggleButton {
    --tb-selected-bg: var(--secondary);
    --tb-selected-bg-pressed: var(--secondary-pressed);
    --tb-selected-border: var(--secondary);
    --tb-selected-border-pressed: var(--secondary-pressed);
    --tb-selected-text: var(--on-secondary);
  }

  /* ===== M3 Tertiary ===== */
  .react-aria-ToggleButton.tertiary,
  .react-aria-ToggleButtonGroup[data-togglebutton-variant="tertiary"]
    .react-aria-ToggleButton {
    --tb-selected-bg: var(--tertiary);
    --tb-selected-bg-pressed: var(--tertiary-pressed);
    --tb-selected-border: var(--tertiary);
    --tb-selected-border-pressed: var(--tertiary-pressed);
    --tb-selected-text: var(--on-tertiary);
  }

  /* ===== M3 Error ===== */
  .react-aria-ToggleButton.error,
  .react-aria-ToggleButtonGroup[data-togglebutton-variant="error"]
    .react-aria-ToggleButton {
    --tb-selected-bg: var(--error);
    --tb-selected-bg-pressed: var(--error-pressed);
    --tb-selected-border: var(--error);
    --tb-selected-border-pressed: var(--error-pressed);
    --tb-selected-text: var(--on-error);
  }

  /* ===== M3 Surface ===== */
  .react-aria-ToggleButton.surface,
  .react-aria-ToggleButtonGroup[data-togglebutton-variant="surface"]
    .react-aria-ToggleButton {
    --tb-selected-bg: var(--surface-container-highest);
    --tb-selected-bg-pressed: color-mix(
      in srgb,
      var(--surface-container-highest) 88%,
      black
    );
    --tb-selected-border: var(--outline-variant);
    --tb-selected-border-pressed: var(--outline);
    --tb-selected-text: var(--on-surface);
  }

  /* ===== Size Variants ===== */
  /* Small */
  .react-aria-ToggleButton.sm,
  .react-aria-ToggleButtonGroup[data-togglebutton-size="sm"]
    .react-aria-ToggleButton {
    font-size: var(--text-sm);
    padding: var(--spacing) var(--spacing-md);
  }

  /* Medium (default) */
  .react-aria-ToggleButton.md,
  .react-aria-ToggleButtonGroup[data-togglebutton-size="md"]
    .react-aria-ToggleButton {
    font-size: var(--text-base);
    padding: var(--spacing-sm) var(--spacing-xl);
  }

  /* Large */
  .react-aria-ToggleButton.lg,
  .react-aria-ToggleButtonGroup[data-togglebutton-size="lg"]
    .react-aria-ToggleButton {
    font-size: var(--text-lg);
    padding: var(--spacing-md) var(--spacing-2xl);
  }
}
