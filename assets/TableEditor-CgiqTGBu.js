import{x as F,r as _,u as x,j as a,P as j,a as q,D as X,z as $,c as m,n as k,aC as u,aj as y,b as E,aD as Q,d as ee,T as ae,t as H,i as r,a9 as le,S as te,E as G,g as L,v as O}from"./index-CCrXmE_g.js";import{P as l}from"./labels-C7QIhqP9.js";import{T as B}from"./table-CHVj2Aa_.js";const se=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ne=F("book-open",se);const oe=[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"7",key:"11ol66"}],["path",{d:"M12 6v4",key:"16clxf"}]],ie=F("mouse",oe),me=_.memo(function({elementId:c,currentProps:s,onUpdate:T}){const i=x(e=>e.elements),A=x(e=>e.setElements),z=_.useMemo(()=>x.getState().elementsMap.get(c)?.customId||"",[c]),p=_.useMemo(()=>i.find(e=>e.id===c),[i,c]),n=_.useCallback(e=>{T({...s,...e})},[s,T]),U=e=>{const t=x.getState().updateElement;t&&c&&t(c,{customId:e})},Y=_.useCallback(e=>{T({...s,dataBinding:e||void 0})},[s,T]);if(!p||!p.id)return a.jsx("div",{className:"table-editor-empty",children:"Table ìš”ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”"});const C=i.find(e=>e.parent_id===p.id&&e.tag==="TableBody"),I=C?i.filter(e=>e.parent_id===C.id&&e.tag==="Row").sort((e,t)=>(e.order_num||0)-(t.order_num||0)):[],V=async()=>{if(C)try{const e=G.generateId(),t={id:e,customId:L("Row",i),tag:"Row",props:{},parent_id:C.id,page_id:p.page_id,order_num:I.length,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},o={...t,custom_id:t.customId};delete o.customId;const{error:d}=await O.from("elements").upsert([o],{onConflict:"id"});if(d){console.error("í–‰ ì¶”ê°€ ì‹¤íŒ¨:",d);return}const h=[],w=N,S=[...i,t];for(let b=0;b<w.length;b++){const M={id:G.generateId(),customId:L("Cell",S),tag:"Cell",props:{children:""},parent_id:e,page_id:p.page_id,order_num:b,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};h.push(M),S.push(M)}const J=h.map(b=>{const D={...b,custom_id:b.customId};return delete D.customId,D}),{error:R}=await O.from("elements").upsert(J,{onConflict:"id"});if(R){console.error("ì…€ ì¶”ê°€ ì‹¤íŒ¨:",R);return}const K=[...i,t,...h];A(K),console.log("âœ… í…Œì´ë¸” í–‰ ì¶”ê°€ ì™„ë£Œ")}catch(e){console.error("í–‰ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜:",e)}},W=async e=>{try{const{removeElement:t}=x.getState();await t(e),console.log("âœ… í…Œì´ë¸” í–‰ ì‚­ì œ ì™„ë£Œ:",e)}catch(t){console.error("í–‰ ì‚­ì œ ì¤‘ ì˜¤ë¥˜:",t)}},P=async()=>{if(g)try{const e=v.length>0?Math.max(...v.map(S=>S.order_num||0)):-1,o={id:G.generateId(),customId:L("ColumnGroup",i),tag:"ColumnGroup",props:{children:"New Group",label:"New Group",span:2,align:"center",variant:"default",sticky:!1},parent_id:g.id,page_id:p.page_id,order_num:e+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},d={...o,custom_id:o.customId};delete d.customId;const{error:h}=await O.from("elements").upsert([d],{onConflict:"id"});if(h){console.error("Column Group ì¶”ê°€ ì‹¤íŒ¨:",h);return}const w=[...i,o];A(w),console.log("âœ… Column Group ì¶”ê°€ ì™„ë£Œ")}catch(e){console.error("Column Group ì¶”ê°€ ì¤‘ ì˜¤ë¥˜:",e)}},Z=async e=>{try{const{removeElement:t}=x.getState();await t(e),console.log("âœ… Column Group ì‚­ì œ ì™„ë£Œ:",e)}catch(t){console.error("Column Group ì‚­ì œ ì¤‘ ì˜¤ë¥˜:",t)}},g=i.find(e=>e.parent_id===p?.id&&e.tag==="TableHeader"),N=g?i.filter(e=>e.parent_id===g.id&&e.tag==="Column").sort((e,t)=>(e.order_num||0)-(t.order_num||0)):[],v=g?i.filter(e=>e.parent_id===g.id&&e.tag==="ColumnGroup").sort((e,t)=>(e.order_num||0)-(t.order_num||0)):[];return a.jsxs(a.Fragment,{children:[a.jsx(j,{title:"Basic",children:a.jsx(q,{label:"ID",value:z,elementId:c,onChange:U,placeholder:"table_1"})}),a.jsx(j,{title:"Data Binding",icon:X,children:a.jsx($,{label:"ë°ì´í„° ì†ŒìŠ¤",value:s.dataBinding,onChange:Y})}),a.jsxs(j,{title:"Configuration",children:[a.jsx(m,{label:l.SELECTION_MODE,value:s?.selectionMode||"none",options:[{value:"none",label:l.NONE},{value:"single",label:l.SINGLE},{value:"multiple",label:l.MULTIPLE}],onChange:e=>n({selectionMode:e}),icon:k}),a.jsx(m,{label:l.TABLE_SIZE,value:s?.size||"md",options:[{value:"sm",label:l.SIZE_SM},{value:"md",label:l.SIZE_MD},{value:"lg",label:l.SIZE_LG}],onChange:e=>n({size:e}),icon:u}),a.jsx(m,{label:l.TABLE_STYLE,value:s?.variant||"default",options:[{value:"default",label:l.TABLE_STYLE_DEFAULT},{value:"striped",label:l.TABLE_STYLE_STRIPED},{value:"bordered",label:l.TABLE_STYLE_BORDERED}],onChange:e=>n({variant:e}),icon:B}),a.jsx(m,{label:l.HEADER_STYLE,value:s?.headerVariant||"default",options:[{value:"default",label:l.HEADER_STYLE_DEFAULT},{value:"dark",label:"Dark"},{value:"primary",label:"Primary"}],onChange:e=>n({headerVariant:e}),icon:u}),a.jsx(m,{label:l.CELL_STYLE,value:s?.cellVariant||"default",options:[{value:"default",label:l.CELL_STYLE_DEFAULT},{value:"striped",label:"Striped"}],onChange:e=>n({cellVariant:e}),icon:u})]}),a.jsxs("div",{className:"component-fieldset",children:[a.jsxs("legend",{className:"component-legend",children:[a.jsx(y,{className:"legend-icon"}),l.PAGINATION_MODE]}),a.jsx(m,{icon:s?.paginationMode==="infinite"?ie:ne,label:l.PAGINATION_MODE,value:s?.paginationMode||"infinite",options:[{value:"infinite",label:"Scroll"},{value:"pagination",label:"Pagination"}],onChange:e=>n({paginationMode:e})}),a.jsx("div",{className:"tab-overview",children:a.jsx("span",{className:"help-text",children:s?.paginationMode==="pagination"?"Traditional navigation with page numbers":"Automatically load more data on scroll"})}),s?.paginationMode==="pagination"&&a.jsx(E,{icon:u,label:l.ITEMS_PER_PAGE,value:s?.itemsPerPage||10,onChange:e=>n({itemsPerPage:parseInt(e)||10}),type:"number"})]}),a.jsxs("div",{className:"component-fieldset",children:[a.jsxs("legend",{className:"component-legend",children:[a.jsx(k,{className:"legend-icon"}),l.VIRTUALIZATION_SETTINGS]}),a.jsx(m,{icon:Q,label:l.TABLE_HEIGHT_MODE,value:s?.heightMode||"fixed",options:[{value:"auto",label:l.HEIGHT_AUTO},{value:"fixed",label:l.HEIGHT_FIXED},{value:"viewport",label:l.HEIGHT_VIEWPORT},{value:"full",label:"Full Screen"}],onChange:e=>n({heightMode:e})}),s?.heightMode==="fixed"&&a.jsxs("div",{className:"table-editor-height-controls",children:[a.jsx(E,{icon:u,label:l.HEIGHT_VALUE,value:String(s?.height||400),onChange:e=>n({height:parseInt(e)||400}),type:"number",className:"flex-1"}),a.jsx(m,{icon:u,label:l.UNIT,value:s?.heightUnit||"px",options:[{value:"px",label:"px"},{value:"vh",label:"vh"},{value:"rem",label:"rem"},{value:"em",label:"em"}],onChange:e=>n({heightUnit:e}),className:"w-32"})]}),s?.heightMode==="viewport"&&a.jsx(E,{icon:u,label:l.VIEWPORT_HEIGHT_RATIO,value:String(s?.viewportHeight||50),onChange:e=>n({viewportHeight:parseInt(e)||50}),type:"number",min:10,max:100}),a.jsx(E,{icon:u,label:l.ROW_HEIGHT,value:s?.itemHeight||50,onChange:e=>n({itemHeight:parseInt(e)||50})}),a.jsx(E,{icon:u,label:l.OVERSCAN,value:s?.overscan||5,onChange:e=>n({overscan:parseInt(e)||5})}),a.jsx(ee,{icon:B,label:l.STICKY_HEADER,isSelected:s?.stickyHeader||!1,onChange:e=>n({stickyHeader:e})}),a.jsx(E,{icon:u,label:l.STICKY_HEADER_OFFSET,value:s?.stickyHeaderOffset||0,onChange:e=>n({stickyHeaderOffset:parseInt(e)||0}),type:"number"})]}),a.jsxs("div",{className:"component-fieldset",children:[a.jsxs("legend",{className:"component-legend",children:[a.jsx(y,{className:"legend-icon"}),l.SORTING_SETTINGS]}),a.jsx("div",{className:"tab-overview",children:a.jsx("span",{className:"help-text",children:"ðŸ’¡ Set default sorting or maintain API order. Users can change sorting by clicking headers."})}),a.jsx(m,{icon:ae,label:l.DEFAULT_SORT_COLUMN,value:s?.sortColumn||"",options:[{value:"",label:"No Sorting (Keep API Order)"},{value:"id",label:"ID"},{value:"name",label:"Name"},{value:"email",label:"Email"},{value:"jobTitle",label:"Job Title"}],onChange:e=>n({sortColumn:e||void 0})}),a.jsx(m,{icon:y,label:l.DEFAULT_SORT_DIRECTION,value:s?.sortDirection||"ascending",options:[{value:"ascending",label:l.SORT_ASCENDING},{value:"descending",label:l.SORT_DESCENDING}],onChange:e=>n({sortDirection:e})})]}),a.jsxs(j,{title:l.COLUMN_MANAGEMENT,children:[a.jsxs("div",{className:"tab-overview",children:[a.jsxs("p",{className:"tab-overview-text",children:["Total columns: ",N.length||0]}),a.jsxs("p",{className:"section-overview-help",children:["ðŸ’¡ Select ",a.jsx("strong",{children:"TableHeader"})," to add/remove columns"]})]}),N.length>0&&a.jsx("div",{className:"tabs-list",children:N.map((e,t)=>{const o=e.props;return a.jsx("div",{className:"tab-list-item",children:a.jsxs("div",{className:"tab-content",children:[a.jsxs("span",{className:"tab-title",children:[t+1,"."," ",o?.children||"ì œëª© ì—†ìŒ",o?.key!=null&&a.jsxs("span",{className:"table-editor-label-hint",children:["(",String(o.key),")"]})]}),a.jsxs("div",{className:"tab-controls",children:[o?.allowsSorting!==!1&&a.jsx("span",{className:"table-editor-hint-text",title:"ì •ë ¬ ê°€ëŠ¥",children:"ðŸ“Š"}),o?.enableResizing!==!1&&a.jsx("span",{className:"table-editor-hint-text",title:"í¬ê¸° ì¡°ì ˆ ê°€ëŠ¥",children:"â†”ï¸"})]})]})},e.id)})}),N.length===0&&a.jsx("div",{className:"tab-overview",children:a.jsxs("p",{className:"section-overview-help",children:["âš ï¸ ì»¬ëŸ¼ì´ ì—†ìŠµë‹ˆë‹¤. ",a.jsx("strong",{children:"Layers"}),"ì—ì„œ"," ",a.jsx("strong",{children:"TableHeader"}),"ë¥¼ ì„ íƒí•˜ê³  ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ì„¸ìš”."]})})]}),a.jsxs(j,{title:"Column Group Management",children:[a.jsxs("div",{className:"tab-overview",children:[a.jsxs("p",{className:"tab-overview-text",children:["Total groups: ",v.length||0]}),a.jsx("p",{className:"section-overview-help",children:"ðŸ’¡ Column Groupì„ ì‚¬ìš©í•˜ì—¬ ê´€ë ¨ ì»¬ëŸ¼ë“¤ì„ ê·¸ë£¹í™”í•˜ê³  ë©€í‹°ë ˆë²¨ í—¤ë”ë¥¼ ë§Œë“¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"})]}),v.length>0&&a.jsx("div",{className:"tabs-list",children:v.map((e,t)=>{const o=e.props;return a.jsxs("div",{className:"tab-list-item",children:[a.jsxs("div",{className:"tab-content",children:[a.jsxs("span",{className:"tab-title",children:[t+1,". ",o?.label||"Group",a.jsxs("span",{className:"table-editor-label-hint",children:["(span: ",o?.span||2,")"]})]}),a.jsx("div",{className:"tab-controls",children:a.jsx("span",{className:"table-editor-hint-text",title:"Column Group",children:"ðŸ“Š"})})]}),a.jsx("button",{className:"control-button delete",onClick:()=>Z(e.id),children:a.jsx(H,{color:r.color,strokeWidth:r.stroke,size:r.size})})]},e.id)})}),v.length===0&&a.jsx("div",{className:"tab-overview",children:a.jsx("p",{className:"section-overview-help",children:"ðŸ“‹ Column Groupì´ ì—†ìŠµë‹ˆë‹¤. ì•„ëž˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ê·¸ë£¹ì„ ì¶”ê°€í•˜ì„¸ìš”."})}),a.jsx("div",{className:"tab-actions",children:a.jsxs("button",{className:"control-button add",onClick:P,children:[a.jsx(le,{color:r.color,strokeWidth:r.stroke,size:r.size}),"Add Column Group"]})}),a.jsx("div",{className:"tab-overview",children:a.jsxs("p",{className:"section-overview-help",children:[a.jsx("strong",{children:"ðŸ’¡ Column Group ì‚¬ìš©ë²•:"}),a.jsx("br",{}),"â€¢ Column Groupì€ ì—¬ëŸ¬ ì»¬ëŸ¼ì„ í•˜ë‚˜ì˜ í—¤ë”ë¡œ ê·¸ë£¹í™”í•©ë‹ˆë‹¤",a.jsx("br",{}),"â€¢ span ì†ì„±ìœ¼ë¡œ ê·¸ë£¹ì´ í¬í•¨í•  ì»¬ëŸ¼ ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤",a.jsx("br",{}),"â€¢ ì¤‘ì²©ëœ ê·¸ë£¹ êµ¬ì¡°ë„ ì§€ì›í•©ë‹ˆë‹¤"]})})]}),a.jsxs(j,{title:"Row Management",children:[a.jsxs("div",{className:"tab-overview",children:[a.jsxs("p",{className:"tab-overview-text",children:["Total rows: ",I.length||0]}),a.jsx("p",{className:"section-overview-help",children:"ðŸ’¡ Manage table rows and their cells"})]}),I.length>0&&a.jsx("div",{className:"tabs-list",children:I.map((e,t)=>{const o=i.filter(d=>d.parent_id===e.id&&d.tag==="Cell").sort((d,h)=>(d.order_num||0)-(h.order_num||0));return a.jsxs("div",{className:"tab-list-item",children:[a.jsxs("span",{className:"tab-title",children:["Row ",t+1," (",o.length," cells)"]}),a.jsx("button",{className:"control-button delete",onClick:()=>W(e.id),children:a.jsx(H,{color:r.color,strokeWidth:r.stroke,size:r.size})})]},e.id)})}),a.jsx("div",{className:"tab-actions",children:a.jsxs("button",{className:"control-button add",onClick:V,children:[a.jsx(te,{color:r.color,strokeWidth:r.stroke,size:r.size}),"Add Row"]})})]})]})},(f,c)=>f.elementId===c.elementId&&JSON.stringify(f.currentProps)===JSON.stringify(c.currentProps));export{me as TableEditor};
