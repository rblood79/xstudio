import{j as e,v as y,r as i}from"./index-BHE-KyRT.js";import{s}from"./supabase.client-C2dMp-kt.js";function E(){return e.jsx("div",{})}function _(){const d=y(),[m,c]=i.useState([]),[a,l]=i.useState("");i.useEffect(()=>{(async()=>{const{data:t,error:o}=await s.from("projects").select("*");o?console.error("프로젝트 조회 에러:",o):c(t)})()},[]);const p=async r=>{r.preventDefault();const{data:t,error:o}=await s.auth.getSession();if(o||!(t!=null&&t.session)){console.error("세션 조회 에러:",o);return}const n=t.session.user.id;if(!a.trim()){console.error("프로젝트 이름이 비어 있습니다.");return}const{data:g,error:u}=await s.from("projects").insert([{name:a,created_by:n}]).select();if(u){console.error("프로젝트 추가 에러:",u);return}const j=g[0],h=j.id,{error:f}=await s.from("pages").insert([{project_id:h,title:"Home",slug:"home"}]);f&&console.error("기본 페이지 생성 에러:",f);const{error:x}=await s.from("project_users").insert([{project_id:h,user_id:n,role:"owner"}]);x&&console.error("프로젝트 사용자 추가 에러:",x),c(v=>[...v,j]),l("")},b=async r=>{const{error:t}=await s.from("projects").delete().eq("id",r);t?console.error("프로젝트 삭제 에러:",t):c(o=>o.filter(n=>n.id!==r))},w=async r=>{const t=`/builder/${r.id}`;d(t)},P=async()=>{await s.auth.signOut(),d("/")};return e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("button",{onClick:P,children:"로그아웃"}),e.jsxs("main",{children:[e.jsx("h2",{children:"Projects List"}),e.jsxs("form",{onSubmit:p,children:[e.jsx("input",{type:"text",value:a,onChange:r=>l(r.target.value),placeholder:"프로젝트 이름 입력",required:!0}),e.jsx("button",{type:"submit",children:"프로젝트 추가"})]}),e.jsx("ul",{children:m.map(r=>e.jsxs("li",{children:[e.jsx("button",{onClick:()=>w(r),children:r.name})," - ",r.updated_at,e.jsx("button",{onClick:()=>b(r.id),children:"삭제"})]},r.id))})]}),e.jsx("aside",{children:"left-sidebar"}),e.jsx("nav",{children:"header"}),e.jsx("footer",{children:"footer"}),e.jsx(E,{})]})})}function N(){return e.jsx(_,{})}export{N as default};
