import{r as c,u as m,j as a,P as d,a as C,b as n,T as A,F as f,I as B,J as D,e as x,ah as L,d as h,c as _,H as I,ai as N,i as g,g as O,E as K,h as w}from"./index-jWQnn2ky.js";import{P as s}from"./labels-C7QIhqP9.js";import{F}from"./folder-tree-DgyQMi-M.js";import{S as R}from"./square-x-B2qUabUg.js";import{P as M}from"./pointer-off-CxyhDSCN.js";import{F as k}from"./focus-CtYyZ4d3.js";const Y=[{value:"none",label:s.NONE},{value:"single",label:s.SINGLE},{value:"multiple",label:s.MULTIPLE}],P=[{value:"replace",label:s.REPLACE},{value:"toggle",label:s.TOGGLE}],q=c.memo(function({elementId:r,currentProps:t,onUpdate:S}){const y=m(e=>e.addElement),[E,u]=c.useState(""),T=c.useMemo(()=>m.getState().elementsMap.get(r)?.customId||"",[r]),i=(e,l)=>{const o={...t,[e]:l};S(o)},j=e=>{const l={...t,dataBinding:e||void 0};S(l)},b=c.useMemo(()=>{const{elements:e}=m.getState();return e.filter(l=>l.parent_id===r&&l.tag==="TreeItem").sort((l,o)=>(l.order_num||0)-(o.order_num||0))},[r]);c.useEffect(()=>{const{currentPageId:e}=m.getState();e&&u(e)},[]);const v=async()=>{try{if(!E){alert("íŽ˜ì´ì§€ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.");return}const{elements:e}=m.getState(),l=b.length||0,o={id:K.generateId(),customId:O("TreeItem",e),page_id:E,tag:"TreeItem",props:{title:`Item ${l+1}`,value:`Item ${l+1}`,children:`Item ${l+1}`,isDisabled:!1,style:{},className:""},parent_id:r,order_num:l},p=await(await w()).elements.insert(o);y(p),console.log("âœ… [IndexedDB] ìƒˆ TreeItemì´ ì¶”ê°€ë¨:",p)}catch(e){console.error("Add TreeItem error:",e),alert("TreeItem ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}};return a.jsxs(a.Fragment,{children:[a.jsx(d,{title:"Basic",children:a.jsx(C,{label:"ID",value:T,elementId:r,placeholder:"tree_1"})}),a.jsxs(d,{title:"Content",children:[a.jsx(n,{label:s.LABEL,value:String(t.label||""),onChange:e=>i("label",e||void 0),icon:A}),a.jsx(n,{label:s.DESCRIPTION,value:String(t.description||""),onChange:e=>i("description",e||void 0),icon:f})]}),a.jsx(d,{title:"Data Binding",icon:B,children:a.jsx(D,{label:"ë°ì´í„° ì†ŒìŠ¤",value:t.dataBinding,onChange:j})}),a.jsxs(d,{title:"State",children:[a.jsx(x,{label:s.SELECTION_MODE,value:String(t.selectionMode||"single"),onChange:e=>i("selectionMode",e),options:Y,icon:F}),a.jsx(x,{label:s.SELECTION_BEHAVIOR,value:String(t.selectionBehavior||"replace"),onChange:e=>i("selectionBehavior",e),options:P,icon:L}),a.jsx(h,{label:s.DISALLOW_EMPTY_SELECTION,isSelected:!!t.disallowEmptySelection,onChange:e=>i("disallowEmptySelection",e),icon:R}),a.jsx(n,{label:s.EXPANDED_KEYS,value:Array.isArray(t.expandedKeys)?t.expandedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("expandedKeys",l)},placeholder:"item1, item2, item3"}),a.jsx(n,{label:s.SELECTED_KEYS,value:Array.isArray(t.selectedKeys)?t.selectedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("selectedKeys",l)},placeholder:"item1, item2"}),a.jsx(n,{label:s.DEFAULT_EXPANDED_KEYS,value:Array.isArray(t.defaultExpandedKeys)?t.defaultExpandedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("defaultExpandedKeys",l)},placeholder:"item1, item2"}),a.jsx(n,{label:s.DEFAULT_SELECTED_KEYS,value:Array.isArray(t.defaultSelectedKeys)?t.defaultSelectedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("defaultSelectedKeys",l)},placeholder:"item1"})]}),a.jsxs(d,{title:"Behavior",children:[a.jsx(h,{label:s.DISABLED,isSelected:!!t.isDisabled,onChange:e=>i("isDisabled",e),icon:M}),a.jsx(h,{label:s.AUTO_FOCUS,isSelected:!!t.autoFocus,onChange:e=>i("autoFocus",e),icon:k})]}),a.jsxs(d,{title:"Accessibility",children:[a.jsx(n,{label:s.ARIA_LABEL,value:String(t["aria-label"]||""),onChange:e=>i("aria-label",e||void 0),icon:_,placeholder:"Tree label for screen readers"}),a.jsx(n,{label:s.ARIA_LABELLEDBY,value:String(t["aria-labelledby"]||""),onChange:e=>i("aria-labelledby",e||void 0),icon:I,placeholder:"label-element-id"}),a.jsx(n,{label:s.ARIA_DESCRIBEDBY,value:String(t["aria-describedby"]||""),onChange:e=>i("aria-describedby",e||void 0),icon:I,placeholder:"description-element-id"})]}),a.jsxs(d,{title:s.TREE_ITEMS,children:[a.jsxs("div",{className:"tree-overview",children:[a.jsxs("p",{className:"tree-overview-text",children:["Total tree items: ",b.length||0]}),a.jsx("p",{className:"tree-overview-help",children:"ðŸ’¡ Select individual tree items from layer tree to edit their properties"})]}),a.jsx("div",{className:"tree-actions",children:a.jsxs("button",{className:"control-button add",onClick:v,disabled:!E,children:[a.jsx(N,{color:g.color,strokeWidth:g.strokeWidth,size:g.size}),"Add TreeItem"]})})]})]})});export{q as TreeEditor};
