import{x as Y,r as h,u as T,j as e,P as I,a as K,c as k,b as A,T as U,e as W,t as V,i as l,S as D,E as R,g as L,v as $}from"./index-bQLXpzmb.js";import{P as r}from"./labels-C7QIhqP9.js";import{T as q}from"./table-DLwEzqnp.js";const G=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],J=Y("pin",G),se=h.memo(function({elementId:x,currentProps:b,onUpdate:P}){const n=T(t=>t.elements),{addElement:z,removeElement:H}=T(),[C,g]=h.useState(!1),[m,v]=h.useState(""),[u,j]=h.useState(""),o=n.find(t=>t.id===x),O=o?.customId||"";if(!o||!o.id)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"TableHeader ìš”ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”"});const N=t=>{P({...b,...t})},c=n.filter(t=>t.parent_id===o.id&&t.tag==="Column").sort((t,i)=>(t.order_num||0)-(i.order_num||0)),_=n.find(t=>t.id===o.parent_id),B=async()=>{if(!(!m.trim()||!u.trim()||!_))try{const t=c.length+1,s={id:R.generateId(),customId:L("Column",n),tag:"Column",props:{key:u.trim(),children:m.trim(),isRowHeader:!1,allowsSorting:!0,enableResizing:!0,width:150},parent_id:x,page_id:o.page_id,order_num:t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},f=n.find(a=>a.parent_id===_.id&&a.tag==="TableBody"),E=[];if(f){const a=n.filter(p=>p.parent_id===f.id&&p.tag==="Row"),d=[...n,s];for(const p of a){const S={id:R.generateId(),customId:L("Cell",d),tag:"Cell",props:{children:""},parent_id:p.id,page_id:o.page_id,order_num:t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};E.push(S),d.push(S)}}const w=[s,...E],M=w.map(a=>{const d={...a,custom_id:a.customId};return delete d.customId,d}),{error:y}=await $.from("elements").insert(M);if(y){console.error("ì»¬ëŸ¼ ì¶”ê°€ ì‹¤íŒ¨:",y);return}w.forEach(a=>z(a)),v(""),j(""),g(!1),console.log("âœ… í—¤ë”ì—ì„œ ì»¬ëŸ¼ ì¶”ê°€ ì™„ë£Œ:",m,`(key: ${u}, ì»¬ëŸ¼ 1ê°œ + ì…€ ${E.length}ê°œ)`)}catch(t){console.error("ì»¬ëŸ¼ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜:",t)}},F=async t=>{try{await H(t),console.log("âœ… í—¤ë”ì—ì„œ ì»¬ëŸ¼ ì‚­ì œ ì™„ë£Œ:",t)}catch(i){console.error("ì»¬ëŸ¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜:",i)}};return e.jsxs("div",{className:"component-props",children:[e.jsxs(I,{title:r.TABLE_HEADER_PROPERTIES,children:[e.jsx(K,{label:"ID",value:O,elementId:x,placeholder:"tableheader_1"}),e.jsxs("div",{className:"tab-overview",children:[e.jsxs("p",{className:"tab-overview-text",children:["Total columns: ",c.length||0]}),e.jsx("p",{className:"section-overview-help",children:"ðŸ’¡ Configure table header appearance and behavior"})]}),e.jsx(k,{label:r.HEADER_STYLE,value:b?.variant||"default",options:[{value:"default",label:r.HEADER_STYLE_DEFAULT},{value:"dark",label:"Dark"},{value:"light",label:"Light"},{value:"bordered",label:"Bordered"}],onChange:t=>N({variant:t}),icon:q}),e.jsx(k,{label:r.STICKY_HEADER,value:b?.sticky?"true":"false",options:[{value:"false",label:"Normal"},{value:"true",label:"Fixed to Top"}],onChange:t=>N({sticky:t==="true"}),icon:J})]}),e.jsxs(I,{title:r.COLUMN_MANAGEMENT,children:[e.jsxs("div",{className:"tab-overview",children:[e.jsxs("p",{className:"tab-overview-text",children:["Total columns: ",c.length||0]}),e.jsx("p",{className:"section-overview-help",children:"ðŸ’¡ Add, edit, and manage table columns"})]}),C&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{label:r.DATA_KEY,value:u,onChange:j,placeholder:"Data field name (e.g. id, name)",icon:U}),e.jsx(A,{label:r.COLUMN_TITLE,value:m,onChange:v,placeholder:"Display title",icon:W})]}),c.length>0&&e.jsx("div",{className:"tabs-list",children:c.map((t,i)=>{const s=t.props;return e.jsxs("div",{className:"tab-list-item",children:[e.jsxs("div",{className:"tab-content",children:[e.jsxs("span",{className:"tab-title",children:[i+1,". ",s?.children||"ì œëª© ì—†ìŒ",s?.key&&e.jsxs("span",{className:"ml-2 text-gray-500 text-sm",children:["(",s.key,")"]}),s?.isRowHeader&&e.jsx("span",{className:"ml-2 px-1 py-0.5 text-xs bg-blue-100 text-blue-600 rounded",children:"í—¤ë”"})]}),e.jsxs("div",{className:"tab-controls",children:[s?.allowsSorting!==!1&&e.jsx("span",{className:"text-xs text-gray-500",children:"ðŸ“Š"}),s?.enableResizing!==!1&&e.jsx("span",{className:"text-xs text-gray-500",children:"â†”ï¸"})]})]}),e.jsx("button",{className:"control-button delete",onClick:()=>F(t.id),children:e.jsx(V,{color:l.color,strokeWidth:l.stroke,size:l.size})})]},t.id)})}),e.jsx("div",{className:"tab-actions",children:C?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"control-button add",onClick:B,children:[e.jsx(D,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Column"]}),e.jsx("button",{className:"control-button secondary",onClick:()=>{g(!1),v(""),j("")},children:"Cancel"})]}):e.jsxs("button",{className:"control-button add",onClick:()=>g(!0),children:[e.jsx(D,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Column"]})})]})]})});export{se as TableHeaderEditor};
