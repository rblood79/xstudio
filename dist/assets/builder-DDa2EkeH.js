const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BvISBzjo.js","assets/supabase-B0cjvv2_.js","assets/react-vendor-B_C40l-y.js","assets/index-DYQkOlQN.css"])))=>i.map(i=>d[i]);
import{j as e,s as p}from"./index-BvISBzjo.js";import{r as Z,h as ca,R as ge,i as ze,c as ja}from"./react-vendor-B_C40l-y.js";import{$ as ga,a as fa,b as Le,c as Re,d as ba,e as ya,f as Na}from"./ui-vendor-DGkkUPmE.js";import{u as ne,T as we,a as ae,B as X,S as H,b as k,C as F,c as va,I as wa,d as ka,R as Ca,e as Be,f as Sa,g as Ia,h as Ae,i as Me,D as za,j as Ta,k as Pa}from"./DateRangePicker-C9lTWYy6.js";import{C as he,A as Ea,a as Da,b as _a,c as Wa,d as Ua,e as qa,E as be,S as _e,f as $a,g as La,h as Rs,G as Ra,L as Ba,i as Aa,F as Ma,j as Oa,k as Ga,l as Fa,m as ue,T as je,P as Te,n as ke,o as ce,H as Va,p as Bs,q as os,B as Oe,r as Ka,s as Ie,t as Pe,u as Ha,v as Ja,w as Za,x as Ya,R as As,M as Xa,y as Qa,z as Ge,D as er,I as sr,J as ar,K as rr,N as tr,O as lr,Q as nr,U as or,V as ir,W as cr,X as Ms,Y as dr,Z as da,_ as pr,$ as pa,a0 as hr,a1 as mr,a2 as ur,a3 as xr,a4 as jr,a5 as gr,a6 as Ee,a7 as xe,a8 as fr,a9 as br,aa as yr,ab as Nr,ac as vr,ad as wr,ae as kr,af as Cr,ag as Sr,ah as Ir,ai as zr}from"./icons-yGY0_Mxo.js";import{_ as Tr}from"./supabase-B0cjvv2_.js";import{c as Pr}from"./utils-CFqvDIMX.js";const l={color:"var(--color-gray-400)",stroke:1,size:16};function Er(){const a=ne(N=>N.selectedElementId),s=ne(N=>N.elements),[i,n]=Z.useState(null),[g,u]=Z.useState(""),[w,f]=Z.useState(""),v=Z.useRef(null);Z.useEffect(()=>{if(a&&s&&s.length>0){const N=s.find(q=>q.id===a);N&&N.tag?f(N.tag):f("")}else f("")},[a,s]);const m=Z.useCallback(()=>{var $;const N=v.current;if(!N||!N.contentWindow||!a)return;const q=($=N.contentDocument)==null?void 0:$.querySelector(`[data-element-id="${a}"]`);if(q){const M=q.getBoundingClientRect(),B={top:Math.floor(M.top),left:Math.floor(M.left),width:Math.floor(M.width),height:Math.floor(M.height)};n({...B}),u(q.tagName.toLowerCase())}else n(null),u("")},[a]);return Z.useEffect(()=>{var M;v.current=document.getElementById("previewFrame");const N=v.current;if(!(N!=null&&N.contentDocument)){n(null),u("");return}const q=B=>{var c,h;if(B.origin===window.location.origin)if(B.data.type==="ELEMENT_SELECTED"&&((c=B.data.payload)!=null&&c.rect)){const{top:x,left:V,width:I,height:W}=B.data.payload.rect;n({top:x,left:V,width:I,height:W}),u(B.data.payload.tag||"Unknown"),setTimeout(m,0)}else B.data.type==="UPDATE_ELEMENT_PROPS"&&((h=B.data.payload)!=null&&h.rect)?n({...B.data.payload.rect}):B.data.type==="CLEAR_OVERLAY"&&(n(null),u(""))};window.addEventListener("message",q);const $=()=>m();return a&&(m(),(M=N.contentWindow)==null||M.addEventListener("scroll",$),window.addEventListener("resize",$),window.addEventListener("scroll",$)),()=>{window.removeEventListener("message",q),N!=null&&N.contentWindow&&N.contentWindow.removeEventListener("scroll",$),window.removeEventListener("resize",$),window.removeEventListener("scroll",$)}},[a,m]),i?e.jsx("div",{className:"overlay",children:e.jsxs("div",{className:"overlay-element",style:{top:i.top,left:i.left,width:i.width,height:i.height},children:[e.jsxs("div",{className:"overlay-info",children:[e.jsx("div",{className:"overlay-tag-parent",children:e.jsx(he,{size:16})}),e.jsx("div",{className:"overlay-tag",children:w||g})]}),e.jsx("div",{title:"Drag to resize",className:"resize-handle"}),e.jsx("div",{className:"overlay-background"}),e.jsx("div",{className:"overlay-pattern",children:e.jsx("div",{className:"overlay-pattern-inner"})})]})}):null}function Dr(){var n,g,u,w,f,v,m,N,q,$,M,B;const{selectedElementId:a,selectedElementProps:s,updateElementProps:i}=ne();return a?e.jsxs("div",{className:"design-container",children:[e.jsxs("div",{className:"inspect_page",children:[e.jsx("div",{className:"tag",children:s.tag||"No tag"}),e.jsxs("div",{className:"testID",children:["testID: ",a]}),e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Transform"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsxs("div",{className:"panel-content",children:[e.jsxs("fieldset",{className:"transform-alignment",children:[e.jsx("legend",{className:"fieldset-legend",children:"Alignment"}),e.jsx("div",{className:"alignment-controls-horizontal",children:e.jsxs(we,{children:[e.jsx(ae,{children:e.jsx(Ea,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{children:e.jsx(Da,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{children:e.jsx(_a,{color:l.color,size:l.size,strokeWidth:l.stroke})})]})}),e.jsx("div",{className:"alignment-controls-vertical",children:e.jsxs(we,{children:[e.jsx(ae,{children:e.jsx(Wa,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{children:e.jsx(Ua,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{children:e.jsx(qa,{color:l.color,size:l.size,strokeWidth:l.stroke})})]})}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})})]}),e.jsxs("fieldset",{className:"transform-size",children:[e.jsx("legend",{className:"fieldset-legend",children:"Size"}),e.jsxs("div",{className:"size-control-width react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"W"}),e.jsx("input",{className:"control-input",type:"text",value:(()=>{var x;const c=((x=s.style)==null?void 0:x.width)||"";if(c==="auto"||!c)return"";const h=String(c).match(/^(\d*\.?\d*)/);return h?h[1]:""})(),onChange:async c=>{var V;const h=c.target.value;if(!a){console.error("No selected element ID");return}let x;if(!h)x={...s,style:{...s.style,width:"auto"}};else{const I=((V=s.style)==null?void 0:V.width)||"";let W="px";if(I&&I!=="auto"){const L=String(I).match(/[a-z%]+$/i);L&&(W=L[0])}x={...s,style:{...s.style,width:`${h}${W}`}}}console.log("Updating element:",a),console.log("Current props:",s),console.log("Updated props:",x),i(a,x);try{const{data:I,error:W}=await p.from("elements").update({props:x}).eq("id",a);W?(console.error("Supabase update error:",W),console.error("Error details:",W.details),console.error("Error hint:",W.hint)):console.log("Supabase update successful:",I)}catch(I){console.error("Unexpected error during Supabase update:",I)}},placeholder:"auto"}),e.jsx(H,{items:[{id:"auto",label:"auto"},{id:"px",label:"px"},{id:"%",label:"%"},{id:"vw",label:"vw"}],selectedKey:(()=>{var x;const c=((x=s.style)==null?void 0:x.width)||"";if(!c||c==="auto")return"auto";const h=String(c).match(/[a-z%]+$/i);return h?h[0]:"px"})(),onSelectionChange:async c=>{var V;const h=c;if(!a){console.error("No selected element ID");return}let x;if(h==="auto")x={...s,style:{...s.style,width:"auto"}};else{const I=((V=s.style)==null?void 0:V.width)||"";let W="100";if(I&&I!=="auto"){const L=String(I).match(/^(\d*\.?\d*)/);L&&L[1]&&(W=L[1])}x={...s,style:{...s.style,width:`${W}${h}`}}}console.log("Updating element:",a),console.log("Current props:",s),console.log("Updated props:",x),i(a,x);try{const{data:I,error:W}=await p.from("elements").update({props:x}).eq("id",a);W?(console.error("Supabase update error:",W),console.error("Error details:",W.details),console.error("Error hint:",W.hint)):console.log("Supabase update successful:",I)}catch(I){console.error("Unexpected error during Supabase update:",I)}},children:c=>e.jsx(k,{children:c.label})})]}),e.jsxs("div",{className:"size-control-height react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"H"}),e.jsx("input",{className:"control-input",type:"text",value:(()=>{var x;const c=((x=s.style)==null?void 0:x.height)||"";if(c==="auto"||!c)return"";const h=String(c).match(/^(\d*\.?\d*)/);return h?h[1]:""})(),onChange:async c=>{var W;const h=c.target.value;if(!h){const L={...s,style:{...s.style,height:"auto"}};i(a,L),p.from("elements").update({props:L}).eq("id",a);return}const x=((W=s.style)==null?void 0:W.height)||"";let V="px";if(x&&x!=="auto"){const L=String(x).match(/[a-z%]+$/i);L&&(V=L[0])}const I={...s,style:{...s.style,height:`${h}${V}`}};i(a,I),p.from("elements").update({props:I}).eq("id",a)},placeholder:"auto"}),e.jsx(H,{items:[{id:"auto",label:"auto"},{id:"px",label:"px"},{id:"%",label:"%"},{id:"vh",label:"vh"}],selectedKey:(()=>{var x;const c=((x=s.style)==null?void 0:x.height)||"";if(!c||c==="auto")return"auto";const h=String(c).match(/[a-z%]+$/i);return h?h[0]:"px"})(),onSelectionChange:async c=>{var V;const h=c;if(!a){console.error("No selected element ID");return}let x;if(h==="auto")x={...s,style:{...s.style,height:"auto"}};else{const I=((V=s.style)==null?void 0:V.height)||"";let W="100";if(I&&I!=="auto"){const L=String(I).match(/^(\d*\.?\d*)/);L&&L[1]&&(W=L[1])}x={...s,style:{...s.style,height:`${W}${h}`}}}console.log("Updating element:",a),console.log("Current props:",s),console.log("Updated props:",x),i(a,x);try{const{data:I,error:W}=await p.from("elements").update({props:x}).eq("id",a);W?(console.error("Supabase update error:",W),console.error("Error details:",W.details),console.error("Error hint:",W.hint)):console.log("Supabase update successful:",I)}catch(I){console.error("Unexpected error during Supabase update:",I)}},children:c=>e.jsx(k,{children:c.label})})]}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})})]}),e.jsxs("fieldset",{className:"transform-position",children:[e.jsx("legend",{className:"fieldset-legend",children:"Position"}),e.jsxs("div",{className:"position-control-x react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"X"}),e.jsx("input",{className:"control-input"})]}),e.jsxs("div",{className:"position-control-y react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"Y"}),e.jsx("input",{className:"control-input"})]}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})})]})]})]}),e.jsxs("div",{className:"inspect_page",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Layout"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsxs("div",{className:"panel-content",children:[e.jsxs("fieldset",{className:"layout-direction",children:[e.jsx("legend",{className:"fieldset-legend",children:"Direction"}),e.jsx("div",{className:"direction-controls",children:e.jsxs(we,{"aria-label":"Flex direction",onSelectionChange:c=>{if(!a)return;const h=Array.from(c)[0],x={...s,style:{...s.style,...h==="reset"?{display:void 0,flexDirection:void 0}:{display:"flex",flexDirection:h}}};i(a,x),p.from("elements").update({props:x}).eq("id",a).then(({error:V})=>{V&&console.error("Supabase update error:",V)})},selectedKeys:new Set([((n=s.style)==null?void 0:n.display)==="flex"?((g=s.style)==null?void 0:g.flexDirection)||"row":"reset"]),children:[e.jsx(ae,{id:"reset",children:e.jsx(_e,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{id:"row",children:e.jsx($a,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{id:"column",children:e.jsx(La,{color:l.color,size:l.size,strokeWidth:l.stroke})})]})}),e.jsx("div",{className:"direction-alignment-grid",children:e.jsxs(we,{"aria-label":"Flex alignment",onSelectionChange:c=>{var L;if(!a)return;const h=Array.from(c)[0],x=((L=s.style)==null?void 0:L.flexDirection)==="column",I={leftTop:{alignItems:"flex-start",justifyContent:"flex-start"},centerTop:{alignItems:x?"center":"flex-start",justifyContent:x?"flex-start":"center"},rightTop:{alignItems:x?"flex-end":"flex-start",justifyContent:x?"flex-start":"flex-end"},leftCenter:{alignItems:x?"flex-start":"center",justifyContent:x?"center":"flex-start"},centerCenter:{alignItems:"center",justifyContent:"center"},rightCenter:{alignItems:x?"flex-end":"center",justifyContent:x?"center":"flex-end"},leftBottom:{alignItems:x?"flex-start":"flex-end",justifyContent:x?"flex-end":"flex-start"},centerBottom:{alignItems:x?"center":"flex-end",justifyContent:x?"flex-end":"center"},rightBottom:{alignItems:"flex-end",justifyContent:"flex-end"}}[h];if(!I)return;const W={...s,style:{...s.style,display:"flex",alignItems:I.alignItems,justifyContent:I.justifyContent}};i(a,W),p.from("elements").update({props:W}).eq("id",a).then(({error:ee})=>{ee&&console.error("Supabase update error:",ee)})},selectedKeys:(()=>{var I,W,L,ee;if(((I=s.style)==null?void 0:I.display)!=="flex")return new Set(["centerCenter"]);const c=((W=s.style)==null?void 0:W.flexDirection)==="column",h=((L=s.style)==null?void 0:L.alignItems)||"center",x=((ee=s.style)==null?void 0:ee.justifyContent)||"center",V=(re,le)=>{if(c){const pe=re==="flex-start"?"left":re==="flex-end"?"right":"center",C=le==="flex-start"?"top":le==="flex-end"?"bottom":"center";return`${pe}${C.charAt(0).toUpperCase()+C.slice(1)}`}else{const pe=le==="flex-start"?"left":le==="flex-end"?"right":"center",C=re==="flex-start"?"top":re==="flex-end"?"bottom":"center";return`${pe}${C.charAt(0).toUpperCase()+C.slice(1)}`}};return new Set([V(h,x)])})(),children:[e.jsx(ae,{id:"leftTop",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"centerTop",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"rightTop",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"leftCenter",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"centerCenter",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"rightCenter",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"leftBottom",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"centerBottom",children:e.jsx("span",{className:"alignment-dot"})}),e.jsx(ae,{id:"rightBottom",children:e.jsx("span",{className:"alignment-dot"})})]})}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})}),e.jsx("div",{className:"justify-control",children:e.jsxs(we,{"aria-label":"Justify content alignment",onSelectionChange:c=>{if(!a)return;const h=Array.from(c)[0],x={...s,style:{...s.style,display:"flex",...h==="class"?{justifyContent:void 0}:{justifyContent:h}}};i(a,x),p.from("elements").update({props:x}).eq("id",a)},selectedKeys:new Set([((u=s.style)==null?void 0:u.display)==="flex"&&((w=s.style)==null?void 0:w.justifyContent)||"class"]),children:[e.jsx(ae,{id:"space-around",children:e.jsx(Rs,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{id:"space-between",children:e.jsx(Ra,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(ae,{id:"space-evenly",children:e.jsx(Rs,{color:l.color,size:l.size,strokeWidth:l.stroke})})]})}),e.jsxs("div",{className:"gap-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Ba,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input"}),e.jsx(H,{items:[{id:"class",label:"class"},{id:"0",label:"0"},{id:"2",label:"2"},{id:"4",label:"4"}],selectedKey:(()=>{var h;return(((h=s.style)==null?void 0:h.gap)||"0px").replace("px","")})(),"aria-label":"Gap value selector",onSelectionChange:c=>{if(!a)return;const h={...s,style:{...s.style,...c==="class"?{gap:void 0}:{gap:`${c}px`}}};i(a,h),p.from("elements").update({props:h}).eq("id",a)},children:c=>e.jsx(k,{children:c.label})})]})]}),e.jsxs("div",{className:"spacing-controls-container",children:[e.jsxs("fieldset",{className:"spacing-padding",children:[e.jsx("legend",{className:"fieldset-legend",children:"Padding"}),e.jsxs("div",{className:"spacing-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Aa,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:(()=>{var h;return(((h=s.style)==null?void 0:h.padding)||"0px").replace("px","")})(),onChange:c=>{const h=c.target.value,x={...s,style:{...s.style,...h==="class"?{padding:void 0}:{padding:`${h}px`}}};i(a,x),p.from("elements").update({props:x}).eq("id",a)}}),e.jsx(H,{items:[{id:"class",label:"class"},{id:"0",label:"0"},{id:"2",label:"2"},{id:"4",label:"4"},{id:"8",label:"8"},{id:"16",label:"16"},{id:"32",label:"32"},{id:"64",label:"64"}],selectedKey:(()=>{var x;const h=(((x=s.style)==null?void 0:x.padding)||"0px").replace("px","");return isNaN(Number(h))?"class":h})(),"aria-label":"Padding value selector",onSelectionChange:c=>{if(!a)return;const h={...s,style:{...s.style,...c==="class"?{padding:void 0}:{padding:`${c}px`}}};i(a,h),p.from("elements").update({props:h}).eq("id",a)},children:c=>e.jsx(k,{children:c.label})})]})]}),e.jsxs("fieldset",{className:"spacing-margin",children:[e.jsx("legend",{className:"fieldset-legend",children:"Margin"}),e.jsxs("div",{className:"spacing-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Ma,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:(()=>{var h;return(((h=s.style)==null?void 0:h.margin)||"0px").replace("px","")})(),onChange:c=>{const h=c.target.value,x={...s,style:{...s.style,...h==="class"?{margin:void 0}:{margin:`${h}px`}}};i(a,x),p.from("elements").update({props:x}).eq("id",a)}}),e.jsx(H,{items:[{id:"class",label:"class"},{id:"0",label:"0"},{id:"2",label:"2"},{id:"4",label:"4"},{id:"8",label:"8"},{id:"16",label:"16"},{id:"32",label:"32"},{id:"64",label:"64"}],selectedKey:(()=>{var x;const h=(((x=s.style)==null?void 0:x.margin)||"0px").replace("px","");return isNaN(Number(h))?"class":h})(),"aria-label":"Margin value selector",onSelectionChange:c=>{if(!a)return;const h={...s,style:{...s.style,...c==="class"?{margin:void 0}:{margin:`${c}px`}}};i(a,h),p.from("elements").update({props:h}).eq("id",a)},children:c=>e.jsx(k,{children:c.label})})]})]}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})})]})]})]}),e.jsxs("div",{className:"inspect_page",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Style"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsxs("div",{className:"panel-content",children:[e.jsxs("fieldset",{className:"style-background",children:[e.jsx("legend",{className:"fieldset-legend",children:"Background"}),e.jsxs("div",{className:"color-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(_e,{fill:((f=s.style)==null?void 0:f.backgroundColor)||"#ffffff",size:18,strokeWidth:0})}),e.jsx("input",{className:"control-input",value:((v=s.style)==null?void 0:v.backgroundColor)||"#ffffff",onChange:c=>{const h={...s,style:{...s.style,backgroundColor:c.target.value}};i(a,h),p.from("elements").update({props:h}).eq("id",a)}})]}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})})]}),e.jsxs("div",{className:"border-controls-container",children:[e.jsxs("fieldset",{className:"style-border",children:[e.jsx("legend",{className:"fieldset-legend",children:"Border Color"}),e.jsxs("div",{className:"color-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(_e,{fill:((m=s.style)==null?void 0:m.borderColor)||"#cccccc",size:18,strokeWidth:0})}),e.jsx("input",{className:"control-input",value:((N=s.style)==null?void 0:N.borderColor)||"#cccccc",onChange:c=>{const h={...s,style:{...s.style,borderColor:c.target.value}};i(a,h),p.from("elements").update({props:h}).eq("id",a)}})]})]}),e.jsxs("fieldset",{className:"style-border-width",children:[e.jsx("legend",{className:"fieldset-legend",children:"Border Width"}),e.jsxs("div",{className:"border-width-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Oa,{color:l.color,strokeWidth:l.stroke,size:l.size})}),e.jsx("input",{className:"control-input",value:(()=>{var h;return(((h=s.style)==null?void 0:h.borderWidth)||"0px").replace("px","")})(),onChange:c=>{const h=c.target.value,x={...s,style:{...s.style,...h==="class"?{borderWidth:void 0}:{borderWidth:`${h}px`}}};i(a,x),p.from("elements").update({props:x}).eq("id",a)}}),e.jsx(H,{items:[{id:"class",label:"class"},{id:"0",label:"0"},{id:"1",label:"1"},{id:"2",label:"2"},{id:"4",label:"4"},{id:"8",label:"8"},{id:"16",label:"16"}],selectedKey:(()=>{var x;const h=(((x=s.style)==null?void 0:x.borderWidth)||"0px").replace("px","");return isNaN(Number(h))?"class":h})(),"aria-label":"Border width selector",onSelectionChange:c=>{if(c){const h={...s,style:{...s.style,...c==="class"?{borderWidth:void 0}:{borderWidth:`${c}px`}}};i(a,h),p.from("elements").update({props:h}).eq("id",a)}},children:c=>e.jsx(k,{children:c.label})})]})]}),e.jsxs("fieldset",{className:"style-border-radius",children:[e.jsx("legend",{className:"fieldset-legend",children:"Border Radius"}),e.jsxs("div",{className:"border-radius-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Ga,{color:l.color,strokeWidth:l.stroke,size:l.size})}),e.jsx("input",{className:"control-input",value:((q=s.style)==null?void 0:q.borderRadius)||"0px",onChange:c=>{const h={...s,style:{...s.style,borderRadius:c.target.value}};i(a,h),p.from("elements").update({props:h}).eq("id",a)}}),e.jsx(H,{items:[{id:"class",label:"class"},{id:"0",label:"0"},{id:"2",label:"2"},{id:"4",label:"4"},{id:"8",label:"8"},{id:"16",label:"16"}],selectedKey:(()=>{var x;const h=(((x=s.style)==null?void 0:x.borderRadius)||"0px").replace("px","");return isNaN(Number(h))?"class":h})(),"aria-label":"Border radius selector",onSelectionChange:async c=>{if(!a)return;const h={...s,style:{...s.style,...c==="class"?{borderRadius:void 0}:{borderRadius:`${c}px`}}};i(a,h);try{const{error:x}=await p.from("elements").update({props:h}).eq("id",a);x&&console.error("Supabase update error:",x)}catch(x){console.error("Unexpected error during Supabase update:",x)}},children:c=>e.jsx(k,{children:c.label})})]})]}),e.jsxs("fieldset",{className:"style-border-style",children:[e.jsx("legend",{className:"fieldset-legend",children:"Border Style"}),e.jsxs("div",{className:"border-style-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Fa,{color:l.color,strokeWidth:l.stroke,size:l.size})}),e.jsx("input",{className:"control-input",value:(($=s.style)==null?void 0:$.borderStyle)||"solid",onChange:c=>{const h={...s,style:{...s.style,borderStyle:c.target.value}};i(a,h),p.from("elements").update({props:h}).eq("id",a)}}),e.jsx(H,{items:[{id:"class",label:"class"},{id:"solid",label:"solid"},{id:"dashed",label:"dashed"},{id:"dotted",label:"dotted"},{id:"double",label:"double"}],selectedKey:((M=s.style)==null?void 0:M.borderStyle)||"class","aria-label":"Border style selector",onSelectionChange:async c=>{if(!a)return;const h={...s,style:{...s.style,...c==="class"?{borderStyle:void 0}:{borderStyle:c}}};i(a,h);try{const{error:x}=await p.from("elements").update({props:h}).eq("id",a);x&&console.error("Supabase update error:",x)}catch(x){console.error("Unexpected error during Supabase update:",x)}},children:c=>e.jsx(k,{children:c.label})})]})]}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})})]})]})]}),e.jsxs("div",{className:"inspect_page",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Text"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsx("div",{className:"panel-content",children:e.jsxs("fieldset",{className:"typography-font",children:[e.jsx("legend",{className:"fieldset-legend",children:"Font"}),e.jsx("div",{className:"font-select-control react-aria-Group",children:e.jsx(H,{items:[{id:"Arial",label:"Arial"},{id:"Helvetica",label:"Helvetica"},{id:"Times New Roman",label:"Times New Roman"},{id:"Georgia",label:"Georgia"},{id:"Courier New",label:"Courier New"},{id:"Verdana",label:"Verdana"}],selectedKey:((B=s.style)==null?void 0:B.fontFamily)||"Arial",onSelectionChange:c=>{const h={...s,style:{...s.style,fontFamily:c}};i(a,h),p.from("elements").update({props:h}).eq("id",a)},children:c=>e.jsx(k,{children:c.label})})}),e.jsx("div",{className:"fieldset-actions",children:e.jsx(X,{children:e.jsx(be,{color:l.color,size:l.size,strokeWidth:l.stroke})})})]})})]})]}):e.jsx("div",{children:"요소를 선택해주세요"})}function _r(){const{selectedElementId:a,selectedElementProps:s,selectedTab:i,updateElementProps:n,addElement:g,currentPageId:u}=ne(),[w,f]=Z.useState(""),[v,m]=Z.useState(null),N=Z.useRef(null);if(Z.useEffect(()=>{if(s!=null&&s.items)try{f(JSON.stringify(s.items,null,2)),m(null)}catch{f(""),m("Failed to stringify items")}else f(""),m(null)},[s==null?void 0:s.items]),Z.useEffect(()=>()=>{N.current&&clearTimeout(N.current)},[]),!a)return e.jsx("div",{children:"요소를 선택해주세요"});const q=()=>{var $,M,B,c,h,x,V,I,W,L,ee,re,le,pe,C;switch(s.tag){case"Button":return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Text"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.children||"",onChange:async t=>{const r={...s,children:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Disabled"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Te,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{type:"checkbox",checked:s.isDisabled||!1,onChange:async t=>{const r={...s,isDisabled:t.target.checked};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]})]});case"ToggleButton":return e.jsxs("div",{className:"component-props",children:[e.jsxs("div",{className:"prop-group",children:[e.jsx("label",{className:"prop-label",children:"Text"}),e.jsx("input",{className:"prop-input",value:s.children||"",onChange:async t=>{const r={...s,children:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]}),e.jsxs("div",{className:"prop-group",children:[e.jsx("label",{className:"prop-label",children:"Selected"}),e.jsx("input",{type:"checkbox",checked:s.isSelected||!1,onChange:async t=>{const r={...s,isSelected:t.target.checked};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]});case"ToggleButtonGroup":if(i&&i.parentId===a){const t=($=s.children)==null?void 0:$[i.tabIndex];return t?e.jsx("div",{className:"component-props",children:e.jsxs("fieldset",{className:"properties-aria",children:[e.jsxs("legend",{className:"fieldset-legend",children:["Selected Button: ",t.title||`Button ${i.tabIndex+1}`]}),e.jsxs("div",{className:"tab-content-editor",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{className:"control-label",children:"Title"}),e.jsx("input",{className:"control-input",placeholder:"Button Title",value:t.title||"",onChange:async r=>{const o=[...s.children||[]];o[i.tabIndex]={...o[i.tabIndex],title:r.target.value};const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}})]}),e.jsx("div",{className:"control-group",children:e.jsxs("label",{className:"control-label",children:[e.jsx("input",{type:"checkbox",checked:t.isSelected||!1,onChange:async r=>{const o=[...s.children||[]];o[i.tabIndex]={...o[i.tabIndex],isSelected:r.target.checked};const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}}),"Selected"]})})]}),e.jsx("div",{className:"tab-actions-section",children:e.jsxs("button",{className:"control-button delete",onClick:async()=>{var d;const r=((d=s.children)==null?void 0:d.filter((j,y)=>y!==i.tabIndex))||[],o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(j){console.error("Update error:",j)}},children:[e.jsx(je,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Delete This Button"]})})]})}):null}return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Selection Mode"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Pe,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"single",label:"Single"},{id:"multiple",label:"Multiple"}],selectedKey:s.selectionMode||"single",onSelectionChange:async t=>{const r={...s,selectionMode:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Orientation"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ke,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"horizontal",label:"Horizontal"},{id:"vertical",label:"Vertical"}],selectedKey:s.orientation||"horizontal",onSelectionChange:async t=>{const r={...s,orientation:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Button Management"}),e.jsxs("div",{className:"tab-overview",children:[e.jsxs("p",{className:"tab-overview-text",children:["Total buttons: ",((M=s.children)==null?void 0:M.length)||0]}),e.jsx("p",{className:"tab-overview-help",children:"💡 Select individual"})]}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("button",{className:"control-button add",onClick:async()=>{var d,j;const t=`button${Date.now()}`,r={id:t,title:`Button ${(((d=s.children)==null?void 0:d.length)||0)+1}`,isSelected:!1},o={...s,children:[...s.children||[],r],defaultSelectedKey:((j=s.children)==null?void 0:j.length)===0?t:s.defaultSelectedKey};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:[e.jsx(ue,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Button"]})})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"State"}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("label",{className:"control-label",children:[e.jsx("input",{type:"checkbox",checked:s.isDisabled||!1,onChange:async t=>{const r={...s,isDisabled:t.target.checked};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}}),"Disabled"]})})]})]});case"TextField":return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",placeholder:"Text Field Label",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Description"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",placeholder:"Help text (optional)",value:s.description||"",onChange:async t=>{const r={...s,description:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Validation"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",placeholder:"Error message (optional)",value:s.errorMessage||"",onChange:async t=>{const r={...s,errorMessage:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"State"}),e.jsx("div",{className:"control-group",children:e.jsx(F,{isSelected:s.isDisabled||!1,onChange:async t=>{const r={...s,isDisabled:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:"Disabled"})})]})]});case"Input":return e.jsxs("div",{className:"component-props",children:[e.jsxs("div",{className:"prop-group",children:[e.jsx("label",{className:"prop-label",children:"Value"}),e.jsx("input",{className:"prop-input",value:s.value||"",onChange:async t=>{const r={...s,value:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]}),e.jsxs("div",{className:"prop-group",children:[e.jsx("label",{className:"prop-label",children:"Placeholder"}),e.jsx("input",{className:"prop-input",value:s.placeholder||"",onChange:async t=>{const r={...s,placeholder:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]}),e.jsxs("div",{className:"prop-group",children:[e.jsx("label",{className:"prop-label",children:"Type"}),e.jsx(H,{items:[{id:"text",name:"text"},{id:"password",name:"password"},{id:"email",name:"email"},{id:"number",name:"number"}],selectedKey:s.type||"text",onSelectionChange:async t=>{const r={...s,type:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.name})})]})]});case"Checkbox":return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Text"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.children||"",onChange:async t=>{const r={...s,children:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"State"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Pe,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{type:"checkbox",checked:s.isSelected||!1,onChange:async t=>{const r={...s,isSelected:t.target.checked};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Disabled"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Te,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{type:"checkbox",checked:s.isDisabled||!1,onChange:async t=>{const r={...s,isDisabled:t.target.checked};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]})]});case"CheckboxGroup":return e.jsx("div",{className:"component-props",children:(i==null?void 0:i.parentId)===a?e.jsx(e.Fragment,{children:e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Checkbox Properties"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",placeholder:"Checkbox Label",value:((c=(B=s.children)==null?void 0:B[i.tabIndex])==null?void 0:c.label)||"",onChange:async t=>{const r=[...s.children||[]];if(r[i.tabIndex]){r[i.tabIndex]={...r[i.tabIndex],label:t.target.value};const o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}}}})]}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Bs,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{type:"checkbox",className:"control-checkbox",checked:((x=(h=s.children)==null?void 0:h[i.tabIndex])==null?void 0:x.isSelected)||!1,onChange:async t=>{const r=[...s.children||[]];if(r[i.tabIndex]){r[i.tabIndex]={...r[i.tabIndex],isSelected:t.target.checked};const o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}}}})]}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("button",{className:"control-button",onClick:async()=>{const t=[...s.children||[]];t.splice(i.tabIndex,1);const r={...s,children:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:[e.jsx(je,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Delete Checkbox"]})})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Orientation"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ke,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"horizontal",label:"Horizontal"},{id:"vertical",label:"Vertical"}],selectedKey:s.orientation||"vertical",onSelectionChange:async t=>{const r={...s,orientation:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Checkbox Management"}),e.jsxs("div",{className:"tab-overview",children:[e.jsxs("p",{className:"tab-overview-text",children:["Total checkboxes: ",((V=s.children)==null?void 0:V.length)||0]}),e.jsx("p",{className:"tab-overview-help",children:"💡 Select individual checkboxes from tree to edit"})]}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("button",{className:"control-button add",onClick:async()=>{var d;const r={id:`checkbox${Date.now()}`,label:`Option ${(((d=s.children)==null?void 0:d.length)||0)+1}`,isSelected:!1},o={...s,children:[...s.children||[],r]};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(j){console.error("Update error:",j)}},children:[e.jsx(ue,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Checkbox"]})})]})]})});case"ListBox":const R=s.children||[];return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Selection"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Pe,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"none",label:"None"},{id:"single",label:"Single"},{id:"multiple",label:"Multiple"}],selectedKey:s.selectionMode||"none",onSelectionChange:async t=>{const r={...s,selectionMode:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Items Management"}),e.jsxs("div",{className:"tabs-management",children:[e.jsxs("div",{className:"tabs-header",children:[e.jsxs("span",{className:"tabs-count",children:["Total Items: ",R.length]}),e.jsxs(X,{className:"add-tab-btn",onPress:async()=>{const t={id:crypto.randomUUID(),type:"ListBoxItem",label:`Item ${R.length+1}`,value:`item${R.length+1}`,isDisabled:!1},r=[...R,t],o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}},children:[e.jsx(ue,{size:16}),"Add Item"]})]}),e.jsx("div",{className:"tabs-list",children:R.map((t,r)=>e.jsxs("div",{className:"tab-item",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("span",{className:"tab-number",children:["#",r+1]}),e.jsxs("div",{className:"tab-controls",children:[e.jsx(X,{className:"icon-btn",isDisabled:r===0,onPress:async()=>{if(r>0){const o=[...R];[o[r-1],o[r]]=[o[r],o[r-1]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(he,{size:16})}),e.jsx(X,{className:"icon-btn",isDisabled:r===R.length-1,onPress:async()=>{if(r<R.length-1){const o=[...R];[o[r],o[r+1]]=[o[r+1],o[r]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(Ie,{size:16})}),e.jsx(X,{className:"icon-btn delete-btn",onPress:async()=>{const o=R.filter((j,y)=>y!==r),d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}},children:e.jsx(je,{size:16})})]})]}),e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Label"}),e.jsx("input",{type:"text",value:t.label||"",onChange:async o=>{const d=R.map((y,G)=>G===r?{...y,label:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Value"}),e.jsx("input",{type:"text",value:t.value||"",onChange:async o=>{const d=R.map((y,G)=>G===r?{...y,value:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsx("div",{className:"form-group",children:e.jsx("label",{children:e.jsx(F,{isSelected:t.isDisabled||!1,onChange:async o=>{const d=R.map((y,G)=>G===r?{...y,isDisabled:o}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:"Disabled"})})})]})]},t.id))})]})]})]});case"GridList":const z=s.children||[];return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Selection"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Pe,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"none",label:"None"},{id:"single",label:"Single"},{id:"multiple",label:"Multiple"}],selectedKey:s.selectionMode||"none",onSelectionChange:async t=>{const r={...s,selectionMode:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Items Management"}),e.jsxs("div",{className:"tabs-management",children:[e.jsxs("div",{className:"tabs-header",children:[e.jsxs("span",{className:"tabs-count",children:["Total Items: ",z.length]}),e.jsxs(X,{className:"add-tab-btn",onPress:async()=>{const t={id:crypto.randomUUID(),type:"GridListItem",label:`Item ${z.length+1}`,value:`item${z.length+1}`,isDisabled:!1},r=[...z,t],o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}},children:[e.jsx(ue,{size:16}),"Add Item"]})]}),e.jsx("div",{className:"tabs-list",children:z.map((t,r)=>e.jsxs("div",{className:"tab-item",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("span",{className:"tab-number",children:["#",r+1]}),e.jsxs("div",{className:"tab-controls",children:[e.jsx(X,{className:"icon-btn",isDisabled:r===0,onPress:async()=>{if(r>0){const o=[...z];[o[r-1],o[r]]=[o[r],o[r-1]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(he,{size:16})}),e.jsx(X,{className:"icon-btn",isDisabled:r===z.length-1,onPress:async()=>{if(r<z.length-1){const o=[...z];[o[r],o[r+1]]=[o[r+1],o[r]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(Ie,{size:16})}),e.jsx(X,{className:"icon-btn delete-btn",onPress:async()=>{const o=z.filter((j,y)=>y!==r),d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}},children:e.jsx(je,{size:16})})]})]}),e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Label"}),e.jsx("input",{type:"text",value:t.label||"",onChange:async o=>{const d=z.map((y,G)=>G===r?{...y,label:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Value"}),e.jsx("input",{type:"text",value:t.value||"",onChange:async o=>{const d=z.map((y,G)=>G===r?{...y,value:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsx("div",{className:"form-group",children:e.jsx("label",{children:e.jsx(F,{isSelected:t.isDisabled||!1,onChange:async o=>{const d=z.map((y,G)=>G===r?{...y,isDisabled:o}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:"Disabled"})})})]})]},t.id))})]})]})]});case"Select":const D=s.children||[];return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Options Management"}),e.jsxs("div",{className:"tabs-management",children:[e.jsxs("div",{className:"tabs-header",children:[e.jsxs("span",{className:"tabs-count",children:["Total Options: ",D.length]}),e.jsxs(X,{className:"add-tab-btn",onPress:async()=>{const t={id:crypto.randomUUID(),type:"SelectItem",label:`Option ${D.length+1}`,value:`option${D.length+1}`,isDisabled:!1},r=[...D,t],o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}},children:[e.jsx(ue,{size:16}),"Add Option"]})]}),e.jsx("div",{className:"tabs-list",children:D.map((t,r)=>e.jsxs("div",{className:"tab-item",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("span",{className:"tab-number",children:["#",r+1]}),e.jsxs("div",{className:"tab-controls",children:[e.jsx(X,{className:"icon-btn",isDisabled:r===0,onPress:async()=>{if(r>0){const o=[...D];[o[r-1],o[r]]=[o[r],o[r-1]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(he,{size:16})}),e.jsx(X,{className:"icon-btn",isDisabled:r===D.length-1,onPress:async()=>{if(r<D.length-1){const o=[...D];[o[r],o[r+1]]=[o[r+1],o[r]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(Ie,{size:16})}),e.jsx(X,{className:"icon-btn delete-btn",onPress:async()=>{const o=D.filter((j,y)=>y!==r),d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}},children:e.jsx(je,{size:16})})]})]}),e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Label"}),e.jsx("input",{type:"text",value:t.label||"",onChange:async o=>{const d=D.map((y,G)=>G===r?{...y,label:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Value"}),e.jsx("input",{type:"text",value:t.value||"",onChange:async o=>{const d=D.map((y,G)=>G===r?{...y,value:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsx("div",{className:"form-group",children:e.jsx("label",{children:e.jsx(F,{isSelected:t.isDisabled||!1,onChange:async o=>{const d=D.map((y,G)=>G===r?{...y,isDisabled:o}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:"Disabled"})})})]})]},t.id))})]})]})]});case"ComboBox":const O=s.children||[];return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Options Management"}),e.jsxs("div",{className:"tabs-management",children:[e.jsxs("div",{className:"tabs-header",children:[e.jsxs("span",{className:"tabs-count",children:["Total Options: ",O.length]}),e.jsxs(X,{className:"add-tab-btn",onPress:async()=>{const t={id:crypto.randomUUID(),type:"ComboBoxItem",label:`Option ${O.length+1}`,value:`option${O.length+1}`,isDisabled:!1},r=[...O,t],o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}},children:[e.jsx(ue,{size:16}),"Add Option"]})]}),e.jsx("div",{className:"tabs-list",children:O.map((t,r)=>e.jsxs("div",{className:"tab-item",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("span",{className:"tab-number",children:["#",r+1]}),e.jsxs("div",{className:"tab-controls",children:[e.jsx(X,{className:"icon-btn",isDisabled:r===0,onPress:async()=>{if(r>0){const o=[...O];[o[r-1],o[r]]=[o[r],o[r-1]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(he,{size:16})}),e.jsx(X,{className:"icon-btn",isDisabled:r===O.length-1,onPress:async()=>{if(r<O.length-1){const o=[...O];[o[r],o[r+1]]=[o[r+1],o[r]];const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}},children:e.jsx(Ie,{size:16})}),e.jsx(X,{className:"icon-btn delete-btn",onPress:async()=>{const o=O.filter((j,y)=>y!==r),d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}},children:e.jsx(je,{size:16})})]})]}),e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Label"}),e.jsx("input",{type:"text",value:t.label||"",onChange:async o=>{const d=O.map((y,G)=>G===r?{...y,label:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Value"}),e.jsx("input",{type:"text",value:t.value||"",onChange:async o=>{const d=O.map((y,G)=>G===r?{...y,value:o.target.value}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsx("div",{className:"form-group",children:e.jsx("label",{children:e.jsx(F,{isSelected:t.isDisabled||!1,onChange:async o=>{const d=O.map((y,G)=>G===r?{...y,isDisabled:o}:y),j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:"Disabled"})})})]})]},t.id))})]})]})]});case"Text":return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Text"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.children||"",onChange:async t=>{const r={...s,children:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Tag"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"Tag"}),e.jsx(H,{items:[{id:"p",label:"본문(p)"},{id:"h1",label:"제목1(h1)"},{id:"h2",label:"제목2(h2)"},{id:"h3",label:"제목3(h3)"},{id:"h4",label:"제목4(h4)"},{id:"h5",label:"제목5(h5)"},{id:"h6",label:"제목6(h6)"}],selectedKey:s.as||"p",onSelectionChange:async t=>{const r={...s,as:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]})]});case"Slider":return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Default Value"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Oe,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.value||"",onChange:async t=>{const r={...s,value:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Min Value"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Oe,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.minValue||"",onChange:async t=>{const r={...s,minValue:Number(t.target.value)||0};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Max Value"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Oe,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.maxValue||"",onChange:async t=>{const r={...s,maxValue:Number(t.target.value)||100};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Step"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Ka,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.step||"",onChange:async t=>{const r={...s,step:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Orientation"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ke,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"horizontal",label:"Horizontal"},{id:"vertical",label:"Vertical"}],selectedKey:s.orientation||"horizontal",onSelectionChange:async t=>{const r={...s,orientation:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Disabled"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Te,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{type:"checkbox",checked:s.isDisabled||!1,onChange:async t=>{const r={...s,isDisabled:t.target.checked};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Form"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"Name"}),e.jsx("input",{className:"control-input",value:s.name||"",onChange:async t=>{const r={...s,name:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]})]});case"Tabs":if(i&&i.parentId===a){const t=(I=s.children)==null?void 0:I[i.tabIndex];return t?e.jsx("div",{className:"component-props",children:e.jsxs("fieldset",{className:"properties-aria",children:[e.jsxs("legend",{className:"fieldset-legend",children:["Selected Tab: ",t.title||`Tab ${i.tabIndex+1}`]}),e.jsxs("div",{className:"tab-content-editor",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{className:"control-label",children:"Title"}),e.jsx("input",{className:"control-input",placeholder:"Tab Title",value:t.title||"",onChange:async r=>{const o=[...s.children||[]];o[i.tabIndex]={...o[i.tabIndex],title:r.target.value};const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{className:"control-label",children:"Content"}),e.jsx("textarea",{className:"control-input",placeholder:"Tab Content",value:t.content||"",rows:5,onChange:async r=>{const o=[...s.children||[]];o[i.tabIndex]={...o[i.tabIndex],content:r.target.value};const d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(j){console.error("Update error:",j)}}})]})]}),e.jsx("div",{className:"tab-actions-section",children:e.jsxs("button",{className:"control-button delete",onClick:async()=>{var j;const r=((j=s.children)==null?void 0:j.filter((y,G)=>G!==i.tabIndex))||[];let o=s.defaultSelectedKey;o===t.id&&r.length>0&&(o=r[0].id);const d={...s,children:r,defaultSelectedKey:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:[e.jsx(je,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Delete This Tab"]})})]})}):null}return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Default Selected Tab"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(os,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:((W=s.children)==null?void 0:W.map(t=>({id:t.id,label:t.title})))||[],selectedKey:s.defaultSelectedKey,onSelectionChange:async t=>{const r={...s,defaultSelectedKey:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Orientation"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(os,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"horizontal",label:"Horizontal"},{id:"vertical",label:"Vertical"}],selectedKey:s.orientation||"horizontal",onSelectionChange:async t=>{const r={...s,orientation:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Tab Management"}),e.jsxs("div",{className:"tab-overview",children:[e.jsxs("p",{className:"tab-overview-text",children:["Total tabs: ",((L=s.children)==null?void 0:L.length)||0]}),e.jsx("p",{className:"tab-overview-help",children:"💡 Select individual tabs from the tree to edit them"})]}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("button",{className:"control-button add",onClick:async()=>{var y,G;const t=`tab${Date.now()}`,r=((y=s.children)==null?void 0:y.length)||0,o={id:t,title:`Tab ${r+1}`,content:"New tab content"},d={...s,children:[...s.children||[],o],defaultSelectedKey:((G=s.children)==null?void 0:G.length)===0?t:s.defaultSelectedKey},j={id:crypto.randomUUID(),page_id:u,tag:"Panel",props:{variant:"tab",title:o.title,tabIndex:r,style:{},className:""},parent_id:a,order_num:r+1};try{await p.from("elements").update({props:d}).eq("id",a);const{data:b,error:T}=await p.from("elements").insert([j]).select().single();if(T){console.error("Panel creation error:",T);return}n(a,d),b&&g(b)}catch(b){console.error("Update error:",b)}},children:[e.jsx(ue,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Tab"]})})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"State"}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("label",{className:"control-label",children:[e.jsx("input",{type:"checkbox",checked:s.isDisabled||!1,onChange:async t=>{const r={...s,isDisabled:t.target.checked};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}}),"Disabled"]})})]})]});case"Div":return e.jsx("div",{className:"component-props",children:e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Content"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"Content"}),e.jsx("textarea",{className:"control-input",value:s.children||"",onChange:async t=>{const r={...s,children:t.target.value};await n(a,r)},placeholder:"Enter div content",rows:3})]})]})});case"Card":return e.jsx("div",{className:"component-props",children:e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Content"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:"Content"}),e.jsx("textarea",{className:"control-input",value:s.children||"",onChange:async t=>{const r={...s,children:t.target.value};await n(a,r)},placeholder:"Enter card content",rows:3})]})]})});case"RadioGroup":return e.jsx("div",{className:"component-props",children:(i==null?void 0:i.parentId)===a?e.jsx(e.Fragment,{children:e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Radio Properties"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",placeholder:"Radio Label",value:((re=(ee=s.children)==null?void 0:ee[i.tabIndex])==null?void 0:re.label)||"",onChange:async t=>{const r=[...s.children||[]];if(r[i.tabIndex]){r[i.tabIndex]={...r[i.tabIndex],label:t.target.value};const o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}}}})]}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Va,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",placeholder:"Radio Value",value:((pe=(le=s.children)==null?void 0:le[i.tabIndex])==null?void 0:pe.value)||"",onChange:async t=>{const r=[...s.children||[]];if(r[i.tabIndex]){r[i.tabIndex]={...r[i.tabIndex],value:t.target.value};const o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}}}})]}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("button",{className:"control-button",onClick:async()=>{const t=[...s.children||[]];t.splice(i.tabIndex,1);const r={...s,children:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:[e.jsx(je,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Delete Radio"]})})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Label"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ce,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.label||"",onChange:async t=>{const r={...s,label:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Selected Value"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Bs,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx("input",{className:"control-input",value:s.value||"",onChange:async t=>{const r={...s,value:t.target.value};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}}})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Orientation"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ke,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"horizontal",label:"Horizontal"},{id:"vertical",label:"Vertical"}],selectedKey:s.orientation||"vertical",onSelectionChange:async t=>{const r={...s,orientation:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Radio Management"}),e.jsxs("div",{className:"tab-overview",children:[e.jsxs("p",{className:"tab-overview-text",children:["Total radios: ",((C=s.children)==null?void 0:C.length)||0]}),e.jsx("p",{className:"tab-overview-help",children:"💡 Select individual radios from tree to edit"})]}),e.jsx("div",{className:"react-aria-control react-aria-Group",children:e.jsxs("button",{className:"control-button add",onClick:async()=>{var d,j;const r={id:`radio${Date.now()}`,label:`Option ${(((d=s.children)==null?void 0:d.length)||0)+1}`,value:`option${(((j=s.children)==null?void 0:j.length)||0)+1}`},o={...s,children:[...s.children||[],r]};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:[e.jsx(ue,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Radio"]})})]})]})});case"Tree":if(i&&i.parentId===a){const t=s.children||[],r=t.find((o,d)=>d===i.tabIndex);return r?e.jsx("div",{className:"component-props",children:e.jsxs("fieldset",{className:"properties-aria",children:[e.jsxs("legend",{className:"fieldset-legend",children:["Selected Item: ",r.title||`Item ${i.tabIndex+1}`]}),e.jsxs("div",{className:"tab-content-editor",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{className:"control-label",children:"Title"}),e.jsx("input",{className:"control-input",placeholder:"Item Title",value:r.title||"",onChange:async o=>{const d=[...t];d[i.tabIndex]={...r,title:o.target.value};const j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}}})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{className:"control-label",children:"Type"}),e.jsx(H,{items:[{id:"folder",label:"Folder"},{id:"file",label:"File"}],selectedKey:r.type||"file",onSelectionChange:async o=>{const d=[...t];d[i.tabIndex]={...r,type:o};const j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:o=>e.jsx(k,{children:o.label})})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{className:"control-label",children:"Parent"}),e.jsx(H,{items:[{id:"root",label:"Root (No Parent)"},...t.filter(o=>o.type==="folder"&&o.id!==r.id).map(o=>({id:o.id,label:o.title}))],selectedKey:r.parent_id||"root",onSelectionChange:async o=>{const d=o==="root"?null:o,j=[...t];j[i.tabIndex]={...r,parent_id:d};const y={...s,children:j};n(a,y);try{await p.from("elements").update({props:y}).eq("id",a)}catch(G){console.error("Update error:",G)}},children:o=>e.jsx(k,{children:o.label})})]})]}),r.type==="folder"&&e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Add Child Item"}),e.jsx("div",{className:"tab-management-controls",children:e.jsxs("button",{className:"add-tab-button",onClick:async()=>{const o={id:crypto.randomUUID(),title:`New Item ${t.length+1}`,type:"file",parent_id:r.id},d=[...t,o],j={...s,children:d};n(a,j);try{await p.from("elements").update({props:j}).eq("id",a)}catch(y){console.error("Update error:",y)}},children:[e.jsx(ue,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Child"]})})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Item Actions"}),e.jsx("div",{className:"tab-management-controls",children:e.jsxs("button",{className:"delete-tab-button",onClick:async()=>{if(window.confirm(`Are you sure you want to delete "${r.title}"?`)){const o=t.filter(j=>j.id!==r.id&&j.parent_id!==r.id),d={...s,children:o};n(a,d);try{await p.from("elements").update({props:d}).eq("id",a),setSelectedElement(a,s)}catch(j){console.error("Update error:",j)}}},children:[e.jsx(je,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Delete Item"]})})]})]})}):null}const _=s.children||[];return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Selection"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(Te,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"none",label:"None"},{id:"single",label:"Single"},{id:"multiple",label:"Multiple"}],selectedKey:s.selectionMode||"single",onSelectionChange:async t=>{const r={...s,selectionMode:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Behavior"}),e.jsxs("div",{className:"react-aria-control react-aria-Group",children:[e.jsx("label",{className:"control-label",children:e.jsx(ke,{color:l.color,size:l.size,strokeWidth:l.stroke})}),e.jsx(H,{items:[{id:"replace",label:"Replace"},{id:"toggle",label:"Toggle"}],selectedKey:s.selectionBehavior||"replace",onSelectionChange:async t=>{const r={...s,selectionBehavior:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:t=>e.jsx(k,{children:t.label})})]})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Features"}),e.jsx("div",{className:"control-group",children:e.jsx(F,{isSelected:s.allowsDragging||!1,onChange:async t=>{const r={...s,allowsDragging:t};n(a,r);try{await p.from("elements").update({props:r}).eq("id",a)}catch(o){console.error("Update error:",o)}},children:"Allow Dragging"})})]}),e.jsxs("fieldset",{className:"properties-aria",children:[e.jsx("legend",{className:"fieldset-legend",children:"Tree Items Management"}),e.jsxs("div",{className:"tab-overview",children:[e.jsxs("p",{className:"tab-overview-text",children:["Total items: ",_.length]}),e.jsx("p",{className:"tab-overview-help",children:"💡 Select individual items from tree to edit"})]}),e.jsx("div",{className:"tab-management-controls",children:e.jsxs("button",{className:"add-tab-button",onClick:async()=>{const t={id:crypto.randomUUID(),title:`New Item ${_.length+1}`,type:"file",parent_id:null},r=[..._,t],o={...s,children:r};n(a,o);try{await p.from("elements").update({props:o}).eq("id",a)}catch(d){console.error("Update error:",d)}},children:[e.jsx(ue,{color:l.color,strokeWidth:l.stroke,size:l.size}),"Add Root Item"]})})]})]});case"DatePicker":return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"DatePicker Settings"}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Label"}),e.jsx("input",{type:"text",value:s.label||"",onChange:t=>n(a,{...s,label:t.target.value}),className:"property-input",placeholder:"Date Picker"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Description"}),e.jsx("input",{type:"text",value:s.description||"",onChange:t=>n(a,{...s,description:t.target.value}),className:"property-input",placeholder:"Helper text"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Error Message"}),e.jsx("input",{type:"text",value:s.errorMessage||"",onChange:t=>n(a,{...s,errorMessage:t.target.value}),className:"property-input",placeholder:"Error text"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Placeholder"}),e.jsx("input",{type:"text",value:s.placeholder||"",onChange:t=>n(a,{...s,placeholder:t.target.value}),className:"property-input",placeholder:"Select date..."})]})]}),e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"State & Behavior"}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isDisabled||!1,onChange:t=>n(a,{...s,isDisabled:t}),children:"Disabled"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isRequired||!1,onChange:t=>n(a,{...s,isRequired:t}),children:"Required"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isReadOnly||!1,onChange:t=>n(a,{...s,isReadOnly:t}),children:"Read Only"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isInvalid||!1,onChange:t=>n(a,{...s,isInvalid:t}),children:"Invalid"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.autoFocus||!1,onChange:t=>n(a,{...s,autoFocus:t}),children:"Auto Focus"})})]}),e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"UI Options"}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.showCalendarIcon!==!1,onChange:t=>n(a,{...s,showCalendarIcon:t}),children:"Show Calendar Icon"})}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Icon Position"}),e.jsxs(H,{selectedKey:s.calendarIconPosition||"right",onSelectionChange:t=>n(a,{...s,calendarIconPosition:t}),children:[e.jsx(k,{id:"left",children:"Left"}),e.jsx(k,{id:"right",children:"Right"})]})]}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.allowClear!==!1,onChange:t=>n(a,{...s,allowClear:t}),children:"Allow Clear"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.highlightToday!==!1,onChange:t=>n(a,{...s,highlightToday:t}),children:"Highlight Today"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.showWeekNumbers||!1,onChange:t=>n(a,{...s,showWeekNumbers:t}),children:"Show Week Numbers"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.includeTime||!1,onChange:t=>n(a,{...s,includeTime:t}),children:"Include Time Selection"})}),s.includeTime&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Time Format"}),e.jsxs(H,{selectedKey:s.timeFormat||"24h",onSelectionChange:t=>n(a,{...s,timeFormat:t}),children:[e.jsx(k,{id:"12h",children:"12 Hour (AM/PM)"}),e.jsx(k,{id:"24h",children:"24 Hour"})]})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Time Label"}),e.jsx("input",{type:"text",value:s.timeLabel||"시간",onChange:t=>n(a,{...s,timeLabel:t.target.value}),className:"property-input",placeholder:"시간"})]})]})]}),e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"Format & Behavior"}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Granularity"}),e.jsxs(H,{selectedKey:["day","hour","minute","second"].includes(s.granularity)?s.granularity:"day",onSelectionChange:t=>{["day","hour","minute","second"].includes(t)&&n(a,{...s,granularity:t})},children:[e.jsx(k,{id:"day",children:"Day"}),e.jsx(k,{id:"hour",children:"Hour"}),e.jsx(k,{id:"minute",children:"Minute"}),e.jsx(k,{id:"second",children:"Second"})]})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"First Day of Week"}),e.jsxs(H,{selectedKey:String(typeof s.firstDayOfWeek=="number"&&s.firstDayOfWeek>=0&&s.firstDayOfWeek<=6?s.firstDayOfWeek:0),onSelectionChange:t=>{const r=Number(t);r>=0&&r<=6&&n(a,{...s,firstDayOfWeek:r})},children:[e.jsx(k,{id:"0",children:"Sunday"}),e.jsx(k,{id:"1",children:"Monday"}),e.jsx(k,{id:"2",children:"Tuesday"}),e.jsx(k,{id:"3",children:"Wednesday"}),e.jsx(k,{id:"4",children:"Thursday"}),e.jsx(k,{id:"5",children:"Friday"}),e.jsx(k,{id:"6",children:"Saturday"})]})]}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.shouldForceLeadingZeros!==!1,onChange:t=>n(a,{...s,shouldForceLeadingZeros:t}),children:"Force Leading Zeros"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.shouldCloseOnSelect!==!1,onChange:t=>n(a,{...s,shouldCloseOnSelect:t}),children:"Close on Select"})})]})]});case"DateRangePicker":return e.jsxs("div",{className:"component-props",children:[e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"DateRangePicker Settings"}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Label"}),e.jsx("input",{type:"text",value:s.label||"",onChange:t=>n(a,{...s,label:t.target.value}),className:"property-input",placeholder:"Date Range Picker"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Description"}),e.jsx("input",{type:"text",value:s.description||"",onChange:t=>n(a,{...s,description:t.target.value}),className:"property-input",placeholder:"Helper text"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Error Message"}),e.jsx("input",{type:"text",value:s.errorMessage||"",onChange:t=>n(a,{...s,errorMessage:t.target.value}),className:"property-input",placeholder:"Error text"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Placeholder"}),e.jsx("input",{type:"text",value:s.placeholder||"",onChange:t=>n(a,{...s,placeholder:t.target.value}),className:"property-input",placeholder:"Select date range..."})]})]}),e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"State & Behavior"}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isDisabled||!1,onChange:t=>n(a,{...s,isDisabled:t}),children:"Disabled"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isRequired||!1,onChange:t=>n(a,{...s,isRequired:t}),children:"Required"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isReadOnly||!1,onChange:t=>n(a,{...s,isReadOnly:t}),children:"Read Only"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isInvalid||!1,onChange:t=>n(a,{...s,isInvalid:t}),children:"Invalid"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.autoFocus||!1,onChange:t=>n(a,{...s,autoFocus:t}),children:"Auto Focus"})})]}),e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"UI Options"}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.showCalendarIcon!==!1,onChange:t=>n(a,{...s,showCalendarIcon:t}),children:"Show Calendar Icon"})}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Icon Position"}),e.jsxs(H,{selectedKey:s.calendarIconPosition||"right",onSelectionChange:t=>n(a,{...s,calendarIconPosition:t}),children:[e.jsx(k,{id:"left",children:"Left"}),e.jsx(k,{id:"right",children:"Right"})]})]}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.allowClear!==!1,onChange:t=>n(a,{...s,allowClear:t}),children:"Allow Clear"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.highlightToday!==!1,onChange:t=>n(a,{...s,highlightToday:t}),children:"Highlight Today"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.showWeekNumbers||!1,onChange:t=>n(a,{...s,showWeekNumbers:t}),children:"Show Week Numbers"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.includeTime||!1,onChange:t=>n(a,{...s,includeTime:t}),children:"Include Time Selection"})}),s.includeTime&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Time Format"}),e.jsxs(H,{selectedKey:s.timeFormat||"24h",onSelectionChange:t=>n(a,{...s,timeFormat:t}),children:[e.jsx(k,{id:"12h",children:"12 Hour (AM/PM)"}),e.jsx(k,{id:"24h",children:"24 Hour"})]})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Start Time Label"}),e.jsx("input",{type:"text",value:s.startTimeLabel||"시작 시간",onChange:t=>n(a,{...s,startTimeLabel:t.target.value}),className:"property-input",placeholder:"시작 시간"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"End Time Label"}),e.jsx("input",{type:"text",value:s.endTimeLabel||"종료 시간",onChange:t=>n(a,{...s,endTimeLabel:t.target.value}),className:"property-input",placeholder:"종료 시간"})]})]})]}),e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"Format & Behavior"}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Granularity"}),e.jsxs(H,{selectedKey:s.granularity||"day",onSelectionChange:t=>n(a,{...s,granularity:t}),children:[e.jsx(k,{id:"day",children:"Day"}),e.jsx(k,{id:"hour",children:"Hour"}),e.jsx(k,{id:"minute",children:"Minute"}),e.jsx(k,{id:"second",children:"Second"})]})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"First Day of Week"}),e.jsxs(H,{selectedKey:String(s.firstDayOfWeek||0),onSelectionChange:t=>n(a,{...s,firstDayOfWeek:Number(t)}),children:[e.jsx(k,{id:"0",children:"Sunday"}),e.jsx(k,{id:"1",children:"Monday"}),e.jsx(k,{id:"2",children:"Tuesday"}),e.jsx(k,{id:"3",children:"Wednesday"}),e.jsx(k,{id:"4",children:"Thursday"}),e.jsx(k,{id:"5",children:"Friday"}),e.jsx(k,{id:"6",children:"Saturday"})]})]}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.shouldForceLeadingZeros!==!1,onChange:t=>n(a,{...s,shouldForceLeadingZeros:t}),children:"Force Leading Zeros"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.shouldCloseOnSelect!==!1,onChange:t=>n(a,{...s,shouldCloseOnSelect:t}),children:"Close on Select"})}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.allowsNonContiguousRanges||!1,onChange:t=>n(a,{...s,allowsNonContiguousRanges:t}),children:"Allow Non-Contiguous Ranges"})})]})]});case"Calendar":return e.jsx("div",{className:"component-props",children:e.jsxs("fieldset",{className:"property-fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:"Calendar Settings"}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"ARIA Label"}),e.jsx("input",{type:"text",value:s["aria-label"]||"",onChange:t=>n(a,{...s,"aria-label":t.target.value}),className:"property-input",placeholder:"Calendar"})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Error Message"}),e.jsx("input",{type:"text",value:s.errorMessage||"",onChange:t=>n(a,{...s,errorMessage:t.target.value}),className:"property-input",placeholder:"Error text"})]}),e.jsx("div",{className:"property-row",children:e.jsx(F,{isSelected:s.isDisabled||!1,onChange:t=>n(a,{...s,isDisabled:t}),children:"Disabled"})}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Visible Months"}),e.jsxs(H,{selectedKey:String(typeof s.visibleDuration=="object"&&s.visibleDuration!==null&&"months"in s.visibleDuration?s.visibleDuration.months:1),onSelectionChange:t=>{const r=Number(t);r>=1&&r<=12&&n(a,{...s,visibleDuration:{months:r}})},children:[e.jsx(k,{id:"1",children:"1 Month"}),e.jsx(k,{id:"2",children:"2 Months"}),e.jsx(k,{id:"3",children:"3 Months"})]})]}),e.jsxs("div",{className:"property-group",children:[e.jsx("label",{className:"property-label",children:"Page Behavior"}),e.jsxs(H,{selectedKey:s.pageBehavior||"visible",onSelectionChange:t=>{(t==="visible"||t==="single")&&n(a,{...s,pageBehavior:t})},children:[e.jsx(k,{id:"visible",children:"Visible"}),e.jsx(k,{id:"single",children:"Single"})]})]})]})});default:return e.jsx("div",{children:"지원하지 않는 컴포넌트입니다."})}};return e.jsx("div",{className:"properties-container",children:e.jsxs("div",{className:"properties-page",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Properties"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsx("div",{className:"panel-content",children:q()})]})})}function Wr(){return e.jsx("div",{className:"inspector-container",children:e.jsxs(ga,{children:[e.jsxs(fa,{children:[e.jsx(Le,{id:"design",children:"Design"}),e.jsx(Le,{id:"props",children:"Props"}),e.jsx(Le,{id:"events",children:"Events"})]}),e.jsx(Re,{id:"design",children:e.jsx(Dr,{})}),e.jsx(Re,{id:"props",children:e.jsx(_r,{})}),e.jsxs(Re,{id:"events",children:[e.jsx("h3",{className:"panel-title",children:"Events"}),"Content for Events"]})]})})}function Ur({pages:a,setPages:s,handleAddPage:i,renderTree:n,fetchElements:g}){return e.jsxs("div",{className:"sidebar_pages",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Pages"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Page",onClick:i,children:e.jsx(Ha,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsx("div",{className:"elements",children:a.length===0?e.jsx("p",{className:"no_element",children:"No pages available"}):n(a,u=>u.title,u=>g(u.id),async u=>{const{error:w}=await p.from("pages").delete().eq("id",u.id);w?console.error("페이지 삭제 에러:",w):s(f=>f.filter(v=>v.id!==u.id))})})]})}function qr({elements:a,setElements:s,selectedElementId:i,setSelectedElement:n,renderTree:g,sendElementSelectedMessage:u,collapseAllTreeItems:w}){return e.jsxs("div",{className:"sidebar_elements",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Layer"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"collapseAll",onClick:()=>{w&&w()},children:e.jsx(Ja,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsx("div",{className:"elements",children:a.length===0?e.jsx("p",{className:"no_element",children:"No element available"}):g(a,f=>f.tag,f=>{n(f.id,{...f.props,tag:f.tag}),requestAnimationFrame(()=>u(f.id,f.props))},async f=>{const{error:v}=await p.from("elements").delete().eq("id",f.id);v?console.error("요소 삭제 에러:",v):(f.id===i&&(n(null),window.postMessage({type:"CLEAR_OVERLAY"},window.location.origin)),s(a.filter(m=>m.id!==f.id)))})})]})}function $r({pages:a,setPages:s,handleAddPage:i,renderTree:n,fetchElements:g,elements:u,setElements:w,selectedElementId:f,setSelectedElement:v,sendElementSelectedMessage:m,collapseAllTreeItems:N}){return e.jsxs("div",{className:"sidebar-content nodes",children:[e.jsx(Ur,{pages:a,setPages:s,handleAddPage:i,renderTree:n,fetchElements:g}),e.jsx(qr,{elements:u,setElements:w,selectedElementId:f,setSelectedElement:v,renderTree:n,sendElementSelectedMessage:m,collapseAllTreeItems:N})]})}function Lr({handleAddElement:a}){const s=[{tag:"Text",label:"text",icon:Za},{tag:"Label",label:"label",icon:Ya},{tag:"TextField",label:"text field",icon:As},{tag:"Input",label:"input",icon:As},{tag:"Button",label:"button",icon:Xa},{tag:"Checkbox",label:"checkbox",icon:Qa},{tag:"CheckboxGroup",label:"check GP",icon:Ge},{tag:"RadioGroup",label:"radio GP",icon:Ge},{tag:"ToggleButton",label:"toggle",icon:er},{tag:"ToggleButtonGroup",label:"toggle GP",icon:Ge},{tag:"Slider",label:"slider",icon:sr}],i=[{tag:"Tabs",label:"tabs",icon:os},{tag:"Tree",label:"tree",icon:ar},{tag:"Table",label:"table",icon:rr},{tag:"Calendar",label:"calendar",icon:tr},{tag:"DatePicker",label:"date picker",icon:lr},{tag:"DateRangePicker",label:"date range",icon:nr},{tag:"ListBox",label:"list box",icon:or},{tag:"GridList",label:"grid List",icon:ir},{tag:"Select",label:"select",icon:Ie},{tag:"ComboBox",label:"combo box",icon:cr}],n=[{tag:"section",label:"section",icon:_e},{tag:"Card",label:"card",icon:Ms},{tag:"Panel",label:"panel",icon:Ms},{tag:"Div",label:"division",icon:dr},{tag:"Nav",label:"nav",icon:da},{tag:"Sprit",label:"sprit",icon:pr}];return e.jsxs("div",{className:"sidebar-content components",children:[e.jsxs("div",{className:"component_element",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Element"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsx("div",{className:"component-list",children:s.map(g=>e.jsxs("div",{className:"component-list-item",children:[e.jsx("button",{onClick:()=>a(g.tag,g.label),title:`Add ${g.label} element`,children:e.jsx(g.icon,{strokeWidth:1,size:16})}),e.jsx("label",{children:g.label})]},g.tag))})]}),e.jsxs("div",{className:"component_element",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Widget"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsx("div",{className:"component-list",children:i.map(g=>e.jsxs("div",{className:"component-list-item",children:[e.jsx("button",{onClick:()=>a(g.tag,g.label),title:`Add ${g.label} element`,children:e.jsx(g.icon,{strokeWidth:1,size:16})}),e.jsx("label",{children:g.label})]},g.tag))})]}),e.jsxs("div",{className:"component_element",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Page"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"iconButton","aria-label":"Add Element",children:e.jsx(he,{color:l.color,strokeWidth:l.stroke,size:l.size})})})]}),e.jsx("div",{className:"component-list",children:n.map(g=>e.jsxs("div",{className:"component-list-item",children:[e.jsx("button",{onClick:()=>a(g.tag,g.label),title:`Add ${g.label} element`,children:e.jsx(g.icon,{strokeWidth:1,size:16})}),e.jsx("label",{children:g.label})]},g.tag))})]})]})}function Rr({handleAddElement:a}){return e.jsx(Lr,{handleAddElement:a})}function Br(){return e.jsxs("div",{className:"sidebar-content",children:[e.jsx("h3",{children:"Library"}),"library"]})}function Ar(){return e.jsxs("div",{className:"sidebar-content",children:[e.jsx("h3",{children:"Dataset"}),"dataset"]})}async function Mr(a){const{data:s,error:i}=await p.from("design_themes").select("*").eq("project_id",a).eq("status","active").order("created_at",{ascending:!0}).limit(1).maybeSingle();if(i)throw i;return s||await Or(a)}async function Or(a){const{data:s,error:i}=await p.from("design_themes").insert({project_id:a,name:"default",status:"active"}).select("*").single();if(i)throw i;return s}async function Gr(a){const{data:s,error:i}=await p.from("design_tokens").select("*").eq("theme_id",a);if(i)throw i;return s||[]}async function Fr(a){if(!a.length)return[];const s=a.map(({css_variable:g,...u})=>u),{data:i,error:n}=await p.from("design_tokens").upsert(s,{onConflict:"project_id, theme_id, name, scope"}).select("*");if(n)throw n;return i}async function Vr(a){const{projectId:s,themeId:i,name:n,scope:g}=a,{error:u}=await p.from("design_tokens").delete().eq("project_id",s).eq("theme_id",i).eq("name",n).eq("scope",g);if(u)throw u}const ha="previewFrame";let We=null,Os="";function Fe(a,s){const i=a.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9._-]/g,"-").toLowerCase();return`--${s}-${i}`}function Gs(a){if(a==null)return"";if(typeof a=="string"||typeof a=="number")return String(a);if(typeof a=="object"&&"r"in a&&"g"in a&&"b"in a){const s=a;return s.a==null||s.a===1?`rgb(${s.r} ${s.g} ${s.b})`:`rgba(${s.r}, ${s.g}, ${s.b}, ${s.a})`}return JSON.stringify(a)}function Ce(a){const s=a.filter(g=>g.scope==="raw"),i=new Map(s.map(g=>[g.name,g])),n=[];for(const g of s)n.push({name:g.name,cssVar:Fe(g.name,g.type),value:Gs(g.value)});for(const g of a.filter(u=>u.scope==="semantic")){const u=g.alias_of&&i.get(g.alias_of),w=u?`var(${Fe(u.name,u.type)})`:Gs(g.value);n.push({name:g.name,cssVar:Fe(g.name,g.type),value:w})}return n}function Kr(a){return a.map(s=>s.cssVar+":"+s.value).join("|")}function Hr(a,s){let i=s.getElementById("design-theme-vars");i||(i=s.createElement("style"),i.id="design-theme-vars",s.head.appendChild(i)),i.textContent=`:root {
`+a.map(n=>`  ${n.cssVar}: ${n.value};`).join(`
`)+`
}`}function Se(a){Hr(a,document);const s=Kr(a);if(s===Os)return;Os=s;const i=document.getElementById(ha);i!=null&&i.contentWindow?i.contentWindow.postMessage({type:"THEME_VARS",vars:a},window.location.origin):We=a}typeof window<"u"&&window.addEventListener("message",a=>{const s=a.data;if(!(!s||typeof s!="object"||s.type!=="PREVIEW_READY")&&We){const i=document.getElementById(ha);i!=null&&i.contentWindow&&(i.contentWindow.postMessage({type:"THEME_VARS",vars:We},window.location.origin),We=null)}});let De;const Jr=new Uint8Array(16);function Zr(){if(!De&&(De=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!De))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return De(Jr)}const te=[];for(let a=0;a<256;++a)te.push((a+256).toString(16).slice(1));function Yr(a,s=0){return te[a[s+0]]+te[a[s+1]]+te[a[s+2]]+te[a[s+3]]+"-"+te[a[s+4]]+te[a[s+5]]+"-"+te[a[s+6]]+te[a[s+7]]+"-"+te[a[s+8]]+te[a[s+9]]+"-"+te[a[s+10]]+te[a[s+11]]+te[a[s+12]]+te[a[s+13]]+te[a[s+14]]+te[a[s+15]]}const Xr=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fs={randomUUID:Xr};function Qr(a,s,i){if(Fs.randomUUID&&!a)return Fs.randomUUID();a=a||{};const n=a.random||(a.rng||Zr)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Yr(n)}const Ue=Pr((a,s)=>({activeTheme:null,rawTokens:[],semanticTokens:[],loading:!1,dirty:!1,lastError:null,loadTheme:async i=>{a({loading:!0,lastError:null});try{const n=await Mr(i),g=await Gr(n.id),u=g.filter(f=>f.scope==="raw"),w=g.filter(f=>f.scope==="semantic");Se(Ce(g)),a({activeTheme:n,rawTokens:u,semanticTokens:w,loading:!1,dirty:!1})}catch(n){console.error("[theme] load failed",n),a({loading:!1,lastError:n instanceof Error?n.message:"테마 로드 실패"})}},updateTokenValue:(i,n,g)=>{console.log("[theme] Updating token:",{name:i,scope:n,value:g});const{rawTokens:u,semanticTokens:w}=s(),f=n==="raw"?u:w,v=f.findIndex($=>$.name===i&&$.scope===n);if(v===-1){console.warn("[theme] Token not found:",{name:i,scope:n});return}const m={...f[v],value:g},N=[...f];N[v]=m;const q=n==="raw"?[...N,...w]:[...u,...N];Se(Ce(q)),a(n==="raw"?{rawTokens:N,dirty:!0}:{semanticTokens:N,dirty:!0}),console.log("[theme] Token updated, scheduling save"),Vs()},addToken:i=>{console.log("[theme] Adding token:",i);const{rawTokens:n,semanticTokens:g,activeTheme:u}=s();if(!u){console.warn("[theme] No active theme");return}if((i.scope==="raw"?n:g).some($=>$.name===i.name)){console.warn("[theme] Duplicate token:",i.name);return}const v={id:Qr(),project_id:u.project_id,theme_id:u.id,name:i.name,type:i.type,value:i.value,scope:i.scope,alias_of:i.alias_of||null},m=i.scope==="raw"?[...n,v]:n,N=i.scope==="semantic"?[...g,v]:g,q=[...m,...N];Se(Ce(q)),a({rawTokens:m,semanticTokens:N,dirty:!0}),console.log("[theme] Token added, scheduling save"),Vs()},deleteToken:async(i,n)=>{const{rawTokens:g,semanticTokens:u,activeTheme:w}=s();if(!w)return!1;if(n==="raw"){const N=u.filter(q=>q.alias_of===i);if(N.length)return a({lastError:`삭제 불가: semantic 토큰 ${N.map(q=>q.name).join(", ")} 가 alias_of 로 참조`}),!1}if(!(n==="raw"?g:u).some(N=>N.name===i))return!1;const v=n==="raw"?g.filter(N=>N.name!==i):g,m=n==="semantic"?u.filter(N=>N.name!==i):u;Se(Ce([...v,...m])),a({rawTokens:v,semanticTokens:m,dirty:!0,lastError:null});try{return await Vr({projectId:w.project_id,themeId:w.id,name:i,scope:n}),!0}catch(N){return console.error("[theme] delete failed",N),a({rawTokens:g,semanticTokens:u,lastError:"삭제 실패: 서버 오류"}),Se(Ce([...g,...u])),!1}},saveAll:async()=>{const{activeTheme:i,rawTokens:n,semanticTokens:g,dirty:u}=s();if(console.log("[theme] saveAll called:",{hasActiveTheme:!!i,dirty:u,tokenCount:n.length+g.length}),!i||!u){console.log("[theme] Save skipped - no active theme or not dirty");return}try{const w=[...n,...g];console.log("[theme] Saving tokens:",w),await Fr(w),a({dirty:!1}),console.log("[theme] Save successful")}catch(w){console.error("[theme] save failed",w),a({lastError:"저장 실패: 서버 오류"})}},snapshotVersion:async()=>{const{activeTheme:i}=s();if(i)try{const{supabase:n}=await Tr(async()=>{const{supabase:u}=await import("./index-BvISBzjo.js").then(w=>w.a);return{supabase:u}},__vite__mapDeps([0,1,2,3])),{error:g}=await n.rpc("increment_design_theme_version",{p_theme_id:i.id});if(g)throw g;a({activeTheme:{...i,version:i.version+1,updated_at:new Date().toISOString()}})}catch(n){console.error("[theme] snapshot failed",n),a({lastError:"버전 스냅샷 생성 실패"})}},clearError:()=>a({lastError:null})}));let Ve=null;function Vs(){console.log("[theme] Scheduling save..."),Ve&&(console.log("[theme] Clearing existing save timer"),window.clearTimeout(Ve)),Ve=window.setTimeout(()=>{console.log("[theme] Executing scheduled save"),Ue.getState().saveAll()},800)}function et(){const{activeTheme:a,rawTokens:s,semanticTokens:i,loading:n,dirty:g,lastError:u,loadTheme:w,updateTokenValue:f,addToken:v,deleteToken:m,saveAll:N,snapshotVersion:q,clearError:$}=Ue(),M=Z.useCallback((h,x,V)=>{f(h,x,V)},[f]),B=Z.useCallback(h=>{v(h)},[v]),c=Z.useCallback((h,x)=>{m(h,x)},[m]);return{activeTheme:a,rawTokens:s,semanticTokens:i,loading:n,dirty:g,lastError:u,loadTheme:w,updateToken:M,addToken:B,deleteToken:c,saveAll:N,snapshotVersion:q,clearError:$}}function Ks({tokens:a,scope:s,onUpdate:i,onDelete:n}){const g=u=>{window.confirm(`토큰 삭제: ${u}?`)&&n(u,s)};return e.jsxs("ul",{className:"flex flex-col gap-2",children:[a.map(u=>e.jsxs("li",{className:"flex items-center gap-2 group",children:[e.jsx("span",{className:"w-48 text-[11px] truncate",children:u.name}),s==="semantic"&&u.alias_of&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-neutral-100 border border-neutral-200",children:["alias:"," ",e.jsx("code",{className:"text-[10px]",children:u.alias_of})]}),e.jsx("input",{className:"flex-1 border px-2 py-1 rounded text-xs","aria-label":`${u.name} 토큰 값`,defaultValue:s==="semantic"&&u.alias_of?u.alias_of:typeof u.value=="string"?u.value:JSON.stringify(u.value),onBlur:w=>{if(s==="semantic"&&u.alias_of)i(u.name,s,u.value);else{let f=w.target.value;if(!(u.type==="color"&&/^#|rgb/i.test(f)))try{f=JSON.parse(f)}catch{}i(u.name,s,f)}}}),e.jsx("button",{onClick:()=>g(u.name),className:"opacity-0 group-hover:opacity-100 text-[10px] px-2 py-1 border rounded border-red-300 text-red-600 hover:bg-red-50 transition",title:"삭제",children:"X"})]},u.name)),a.length===0&&e.jsx("li",{className:"text-[11px] text-neutral-400",children:"(없음)"})]})}const st=/^[a-z0-9._-]+(?:\.[a-z0-9._-]+)*$/,at=[{value:"color",label:"Color"},{value:"spacing",label:"Spacing"},{value:"border",label:"Border"},{value:"radius",label:"Radius"},{value:"shadow",label:"Shadow"},{value:"font",label:"Font"},{value:"size",label:"Size"},{value:"other",label:"Other"}];function rt({rawTokens:a,onAdd:s}){const[i,n]=Z.useState({scope:"raw",name:"",type:"color",value:"",alias_of:"",error:null}),g=()=>{if(!i.name.trim()||!st.test(i.name)){n(v=>({...v,error:"이름 형식 오류"}));return}if(a.some(v=>v.name===i.name)){n(v=>({...v,error:"이미 존재하는 이름"}));return}let w=i.value;if(!(i.type==="color"&&/^#|rgb/i.test(w)))try{w=JSON.parse(w)}catch{}const f={name:i.name,type:i.type,value:w,scope:i.scope,alias_of:i.scope==="semantic"&&i.alias_of?i.alias_of:void 0};s(f),n({scope:i.scope,name:"",type:i.type,value:"",alias_of:"",error:null})};return e.jsxs("section",{className:"flex flex-col gap-2 border-t pt-4",children:[e.jsx("h4",{className:"text-xs font-semibold text-neutral-600",children:"새 토큰 추가"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px]",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-neutral-500",children:"Scope"}),e.jsxs("select",{value:i.scope,onChange:u=>n(w=>({...w,scope:u.target.value})),className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"raw",children:"raw"}),e.jsx("option",{value:"semantic",children:"semantic"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-neutral-500",children:"Type"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:at.map(u=>e.jsx("button",{type:"button",onClick:()=>n(w=>({...w,type:u.value})),className:`px-2 py-1 text-[10px] rounded border transition-colors ${i.type===u.value?"bg-blue-500 text-white border-blue-500":"bg-white text-neutral-600 border-neutral-300 hover:border-blue-300"}`,children:u.label},u.value))})]}),e.jsxs("label",{className:"flex flex-col gap-1 col-span-2",children:[e.jsx("span",{className:"text-neutral-500",children:"Name (dot 구분)"}),e.jsx("input",{value:i.name,onChange:u=>n(w=>({...w,name:u.target.value,error:null})),placeholder:"button.primary.bg",className:"border px-2 py-1 rounded"})]}),i.scope==="semantic"&&e.jsxs("label",{className:"flex flex-col gap-1 col-span-2",children:[e.jsx("span",{className:"text-neutral-500",children:"alias_of (raw 토큰명)"}),e.jsx("input",{value:i.alias_of,onChange:u=>n(w=>({...w,alias_of:u.target.value})),list:"raw-token-list",placeholder:"color.brand.primary",className:"border px-2 py-1 rounded"}),e.jsx("datalist",{id:"raw-token-list",children:a.map(u=>e.jsx("option",{value:u.name},u.name))})]}),e.jsxs("label",{className:"flex flex-col gap-1 col-span-2",children:[e.jsx("span",{className:"text-neutral-500",children:"Value"}),e.jsx("input",{value:i.value,onChange:u=>n(w=>({...w,value:u.target.value})),placeholder:i.scope==="semantic"&&i.alias_of?"(alias 사용 시 무시)":"#3B82F6 또는 JSON",className:"border px-2 py-1 rounded"})]})]}),i.error&&e.jsx("p",{className:"text-[11px] text-red-500",children:i.error}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:g,className:"text-xs px-3 py-1.5 rounded bg-blue-600 text-white hover:bg-blue-500 disabled:opacity-50",disabled:!i.name.trim(),children:"추가"})})]})}function tt({theme:a,dirty:s,onSnapshot:i}){return e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold",children:["Theme: ",a==null?void 0:a.name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",disabled:s,onClick:i,className:`text-[11px] px-2 py-1 rounded border
                             border-neutral-300 hover:bg-neutral-100
                             disabled:opacity-40`,title:"버전 스냅샷 생성",children:["Snapshot v",a==null?void 0:a.version]}),s&&e.jsx("span",{className:"text-[10px] text-orange-500",children:"Saving…"})]})]})}const lt=[{id:"1",name:"Option 1"},{id:"2",name:"Option 2"},{id:"3",name:"Option 3"}];function nt(){return e.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Buttons"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(X,{children:"Primary Button"}),e.jsx(X,{children:e.jsx("span",{style:{color:"var(--color-primary, #3B82F6)"},children:"Styled Button"})}),e.jsx(X,{isDisabled:!0,children:"Disabled Button"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Form Elements"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(va,{label:"Text Input",description:"Helper text for input field",children:e.jsx(wa,{placeholder:"Enter text..."})}),e.jsx(H,{label:"Select Dropdown",placeholder:"Choose option...",items:lt,children:a=>e.jsx(k,{id:a.id,children:a.name})}),e.jsx(ka,{label:"Slider Control",defaultValue:50,minValue:0,maxValue:100})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Checkboxes"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(F,{defaultSelected:!0,children:"Checked Option"}),e.jsx(F,{children:"Unchecked Option"}),e.jsx(F,{isIndeterminate:!0,children:"Indeterminate Option"}),e.jsx(F,{isDisabled:!0,children:"Disabled Option"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Radio Groups"}),e.jsxs(Ca,{label:"Choose Option",defaultValue:"option1",description:"Select one option from the list",children:[e.jsx(Be,{value:"option1",children:"Option 1"}),e.jsx(Be,{value:"option2",children:"Option 2"}),e.jsx(Be,{value:"option3",children:"Option 3"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Tabs"}),e.jsxs(Sa,{defaultSelectedKey:"tab1",children:[e.jsxs(Ia,{children:[e.jsx(Ae,{id:"tab1",children:"First Tab"}),e.jsx(Ae,{id:"tab2",children:"Second Tab"}),e.jsx(Ae,{id:"tab3",children:"Third Tab"})]}),e.jsx(Me,{id:"tab1",children:e.jsx("div",{className:"p-3 text-sm",children:"Content for the first tab goes here."})}),e.jsx(Me,{id:"tab2",children:e.jsx("div",{className:"p-3 text-sm",children:"Content for the second tab goes here."})}),e.jsx(Me,{id:"tab3",children:e.jsx("div",{className:"p-3 text-sm",children:"Content for the third tab goes here."})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Typography"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl font-bold",style:{color:"var(--color-text-heading, #111827)",fontFamily:"var(--font-heading, inherit)"},children:"Heading 1"}),e.jsx("h2",{className:"text-xl font-semibold",style:{color:"var(--color-text-heading, #111827)",fontFamily:"var(--font-heading, inherit)"},children:"Heading 2"}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-body, #374151)",fontFamily:"var(--font-body, inherit)"},children:"Body text example with normal font weight and readable color."}),e.jsx("a",{href:"#",className:"text-sm underline",style:{color:"var(--color-link, #3B82F6)",fontFamily:"var(--font-body, inherit)"},onClick:a=>a.preventDefault(),children:"Link example"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Status & Badges"}),e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full",style:{backgroundColor:"var(--color-primary, #3B82F6)",color:"white"},children:"Primary"}),e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full",style:{backgroundColor:"var(--color-success, #10B981)",color:"white"},children:"Success"}),e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full",style:{backgroundColor:"var(--color-warning, #F59E0B)",color:"white"},children:"Warning"}),e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full",style:{backgroundColor:"var(--color-danger, #EF4444)",color:"white"},children:"Danger"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Cards & Surfaces"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-3 rounded-lg border",style:{backgroundColor:"var(--color-surface, white)",borderColor:"var(--color-border, #E5E7EB)",borderRadius:"var(--radius-card, 0.5rem)"},children:[e.jsx("h6",{className:"font-medium text-sm mb-1",style:{color:"var(--color-text-heading, #111827)"},children:"Card Title"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-body, #374151)"},children:"Card content here."})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{backgroundColor:"var(--color-primary, #3B82F6)",borderRadius:"var(--radius-card, 0.5rem)"},children:[e.jsx("h6",{className:"font-medium text-sm mb-1 text-white",children:"Featured Card"}),e.jsx("p",{className:"text-xs text-white/80",children:"Primary colored card."})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Progress"}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs",style:{color:"var(--color-text-muted, #6B7280)"},children:"Progress: 65%"}),e.jsx("div",{className:"w-full rounded-full h-2",style:{backgroundColor:"var(--color-neutral-200, #E5E7EB)"},children:e.jsx("div",{className:"h-2 rounded-full transition-all duration-300",style:{backgroundColor:"var(--color-primary, #3B82F6)",width:"65%"}})})]})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Spacing"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"bg-blue-200 rounded",style:{width:"var(--spacing-sm, 0.5rem)",height:"var(--spacing-sm, 0.5rem)"}}),e.jsx("span",{className:"text-xs text-gray-500",children:"Small"}),e.jsx("div",{className:"bg-blue-300 rounded ml-2",style:{width:"var(--spacing-md, 1rem)",height:"var(--spacing-md, 1rem)"}}),e.jsx("span",{className:"text-xs text-gray-500",children:"Medium"}),e.jsx("div",{className:"bg-blue-400 rounded ml-2",style:{width:"var(--spacing-lg, 1.5rem)",height:"var(--spacing-lg, 1.5rem)"}}),e.jsx("span",{className:"text-xs text-gray-500",children:"Large"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Date Picker"}),e.jsx(za,{label:"Select Date",description:"Choose a date from the picker",placeholder:"Pick a date...",showCalendarIcon:!0,allowClear:!0})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Date Range Picker"}),e.jsx(Ta,{label:"Select Date Range",description:"Choose start and end dates",placeholder:"Pick date range...",showCalendarIcon:!0,allowClear:!0})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-600",children:"Calendar"}),e.jsx(Pa,{"aria-label":"Date Selection",visibleDuration:{months:1}})]})]})}function ot({projectId:a}){const[s,i]=Z.useState("tokens"),{activeTheme:n,rawTokens:g,semanticTokens:u,loading:w,dirty:f,lastError:v,updateToken:m,addToken:N,deleteToken:q,saveAll:$,snapshotVersion:M,clearError:B}=et();return w?e.jsx("div",{className:"p-3 text-xs",children:"Loading theme..."}):e.jsxs("div",{className:"flex flex-col gap-4 p-3",children:[e.jsx(tt,{theme:n,dirty:f,onSnapshot:M}),v&&e.jsxs("div",{className:"text-[11px] text-red-600 flex items-center justify-between",children:[e.jsx("span",{children:v}),e.jsx("button",{onClick:B,className:"text-red-400 hover:text-red-600",children:"×"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsxs("span",{children:["Status: ",f?"Dirty":"Clean"]}),e.jsx("button",{onClick:()=>{console.log("[theme] Manual save triggered"),$()},className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Manual Save"})]}),e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsx("button",{onClick:()=>i("tokens"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${s==="tokens"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"🎨 Tokens"}),e.jsx("button",{onClick:()=>i("preview"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${s==="preview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"👁️ Preview"})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[s==="tokens"&&e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("section",{className:"flex flex-col gap-2",children:[e.jsxs("h4",{className:"text-xs font-semibold text-neutral-600",children:["Raw Tokens (",g.length,")"]}),e.jsx(Ks,{tokens:g,scope:"raw",onUpdate:m,onDelete:q})]}),e.jsxs("section",{className:"flex flex-col gap-2",children:[e.jsxs("h4",{className:"text-xs font-semibold text-neutral-600",children:["Semantic Tokens (",u.length,")"]}),e.jsx(Ks,{tokens:u,scope:"semantic",onUpdate:m,onDelete:q})]}),e.jsx(rt,{rawTokens:g,onAdd:N})]}),s==="preview"&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-neutral-600",children:"Theme Preview"}),e.jsx(nt,{})]})]}),e.jsx("footer",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-[10px] text-neutral-500",children:["Project: ",a," | Version: v",n==null?void 0:n.version]})})]})}function it({projectId:a}){const s=Ue(i=>i.loadTheme);return Z.useEffect(()=>{a&&s(a)},[a]),null}function ct(){const{projectId:a}=ca();return e.jsx("div",{className:"sidebar-content",children:a?e.jsxs(e.Fragment,{children:[e.jsx(it,{projectId:a}),e.jsx(ot,{projectId:a})]}):e.jsx("p",{className:"text-red-500",children:"Project ID is required"})})}function dt(){const[a,s]=Z.useState(""),[i,n]=Z.useState(""),[g,u]=Z.useState(!1),w=async()=>{try{u(!0),n("생성 중...");const v=await(await fetch("http://121.146.229.198:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"phi3:mini",prompt:a,stream:!1})})).json();n(v.response)}catch(f){console.error("Error:",f),n("오류가 발생했습니다. 다시 시도해주세요.")}finally{u(!1)}};return e.jsxs("div",{className:"sidebar-content",children:[e.jsx("h3",{children:"AI Assistant"}),e.jsx("input",{type:"text",placeholder:"프롬프트를 입력하세요",value:a,onChange:f=>s(f.target.value)}),e.jsx("button",{onClick:w,disabled:g||!a.trim(),children:g?"생성 중...":"생성하기"}),e.jsx("div",{className:"ai-output",children:e.jsx("pre",{children:i})})]})}function pt(){return e.jsxs("div",{className:"sidebar-content",children:[e.jsx("h3",{children:"User"}),"user"]})}function ht(){return e.jsxs("div",{className:"sidebar-content",children:[e.jsx("h3",{children:"Setting"}),"setting"]})}const mt=({activeTabs:a,onTabChange:s})=>{const i=[{id:"nodes",label:"노드",icon:e.jsx(pa,{color:l.color,strokeWidth:l.stroke,size:l.size})},{id:"components",label:"컴포넌트",icon:e.jsx(ue,{color:l.color,strokeWidth:l.stroke,size:l.size})},{id:"library",label:"라이브러리",icon:e.jsx(hr,{color:l.color,strokeWidth:l.stroke,size:l.size})},{id:"dataset",label:"데이터셋",icon:e.jsx(mr,{color:l.color,strokeWidth:l.stroke,size:l.size})},{id:"theme",label:"테마",icon:e.jsx(ur,{color:l.color,strokeWidth:l.stroke,size:l.size})},{id:"ai",label:"AI",icon:e.jsx(xr,{color:l.color,strokeWidth:l.stroke,size:l.size})},{id:"user",label:"사용자",icon:e.jsx(jr,{color:l.color,strokeWidth:l.stroke,size:l.size})},{id:"settings",label:"설정",icon:e.jsx(gr,{color:l.color,strokeWidth:l.stroke,size:l.size})}];return e.jsx("nav",{className:"sidebar-nav",children:e.jsx("ul",{className:"nav-list",children:i.map(n=>e.jsx("li",{children:e.jsx("button",{className:`nav-button ${a.has(n.id)?"active":""}`,onClick:()=>s(n.id),"aria-pressed":a.has(n.id),children:n.icon})},n.id))})})};function ut({pages:a,setPages:s,handleAddPage:i,handleAddElement:n,fetchElements:g,selectedPageId:u,children:w}){const f=ne(C=>C.elements),v=ne(C=>C.selectedElementId),m=ne(C=>C.selectedTab),{setElements:N,setSelectedElement:q,selectTabElement:$}=ne(),[M,B]=ge.useState(new Set(["nodes"])),[c]=ge.useState({color:"#171717",stroke:1,size:16}),[h,x]=ge.useState(new Set);ge.useEffect(()=>{if(v&&f.length>0){const C=new Set;let R=f.find(z=>z.id===v);for(;R!=null&&R.parent_id;)C.add(R.parent_id),R=f.find(z=>z.id===(R==null?void 0:R.parent_id));x(z=>{const D=new Set(z);return C.forEach(O=>D.add(O)),D})}},[v,f]);const V=C=>{N(typeof C=="function"?C(f):C)},I=C=>{B(R=>{const z=new Set(R);return z.has(C)?z.delete(C):z.add(C),z})},W=(C,R)=>C.some(z=>z.parent_id===R),L=C=>{x(R=>{const z=new Set(R);return z.has(C)?z.delete(C):z.add(C),z})},ee=(C,R,z,D,O=null,_=0)=>{const t=C.filter(r=>{if(!(r.parent_id===O||O===null&&r.parent_id===void 0))return!1;if(O){const d=C.find(j=>j.id===O);if(d&&"tag"in d&&d.tag==="Tabs"&&"tag"in r&&r.tag==="Panel")return!1}return!0}).sort((r,o)=>(r.order_num||0)-(o.order_num||0));return t.length===0?null:e.jsx(e.Fragment,{children:t.map(r=>{var se,J,oe,de,me,qe,is,cs,ds,ps,hs,ms,us,xs,js,gs,fs,bs,ys,Ns,vs,ws,ks,Cs,Ss,Is,zs,Ts,Ps,Es,Ds,_s,Ws,Us;const o=W(C,r.id),d=h.has(r.id),j="tag"in r&&r.tag==="Tabs"&&"props"in r&&((J=(se=r.props)==null?void 0:se.children)==null?void 0:J.length)>0,y="tag"in r&&r.tag==="ToggleButtonGroup"&&"props"in r&&((de=(oe=r.props)==null?void 0:oe.children)==null?void 0:de.length)>0,G="tag"in r&&r.tag==="CheckboxGroup"&&"props"in r&&((qe=(me=r.props)==null?void 0:me.children)==null?void 0:qe.length)>0,b="tag"in r&&r.tag==="RadioGroup"&&"props"in r&&((cs=(is=r.props)==null?void 0:is.children)==null?void 0:cs.length)>0,T="tag"in r&&r.tag==="ListBox"&&"props"in r&&((ps=(ds=r.props)==null?void 0:ds.children)==null?void 0:ps.length)>0,A="tag"in r&&r.tag==="GridList"&&"props"in r&&((ms=(hs=r.props)==null?void 0:hs.children)==null?void 0:ms.length)>0,P="tag"in r&&r.tag==="Select"&&"props"in r&&((xs=(us=r.props)==null?void 0:us.children)==null?void 0:xs.length)>0,K="tag"in r&&r.tag==="ComboBox"&&"props"in r&&((gs=(js=r.props)==null?void 0:js.children)==null?void 0:gs.length)>0,U="tag"in r&&r.tag==="Tree"&&"props"in r&&((bs=(fs=r.props)==null?void 0:fs.children)==null?void 0:bs.length)>0,E=o||j||y||G||b||T||A||P||K||U;return e.jsxs("div",{"data-depth":_,"data-has-children":E,onClick:Y=>{Y.stopPropagation(),z(r)},className:"element",children:[e.jsxs("div",{className:`elementItem ${"title"in r&&u===r.id||"tag"in r&&v===r.id?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:_>0?`${_*8+0}px`:"0px"}}),e.jsx("div",{className:"elementItemIcon",onClick:Y=>{Y.stopPropagation(),E&&L(r.id)},children:E?e.jsx(Ee,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{transform:d?"rotate(90deg)":"rotate(0deg)"}}):e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:R(r)}),e.jsxs("div",{className:"elementItemActions",children:[e.jsx("button",{className:"iconButton","aria-label":"Settings",children:e.jsx(fr,{color:c.color,strokeWidth:c.stroke,size:c.size})}),e.jsx("button",{className:"iconButton","aria-label":`Delete ${R(r)}`,onClick:async Y=>{Y.stopPropagation(),await D(r)},children:e.jsx(je,{color:c.color,strokeWidth:c.stroke,size:c.size})})]})]}),d&&e.jsxs(e.Fragment,{children:[o&&ee(C,R,z,D,r.id,_+1),j&&"props"in r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{"data-depth":_+1,"data-has-children":!0,onClick:Y=>{Y.stopPropagation(),L(`${r.id}-tablist`)},className:"element",children:e.jsxs("div",{className:"elementItem",children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(Ee,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{transform:h.has(`${r.id}-tablist`)?"rotate(90deg)":"rotate(0deg)"}})}),e.jsx("div",{className:"elementItemLabel",children:"TabList"}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-tablist`),h.has(`${r.id}-tablist`)&&((Ns=(ys=r.props)==null?void 0:ys.children)==null?void 0:Ns.map((Y,S)=>e.jsx("div",{"data-depth":_+2,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+2)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.title||`Tab ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-tab-${S}`))),e.jsx("div",{"data-depth":_+1,"data-has-children":!0,onClick:Y=>{Y.stopPropagation(),L(`${r.id}-tabpanels`)},className:"element",children:e.jsxs("div",{className:"elementItem",children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(Ee,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{transform:h.has(`${r.id}-tabpanels`)?"rotate(90deg)":"rotate(0deg)"}})}),e.jsx("div",{className:"elementItemLabel",children:"TabPanels"}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-tabpanels`),h.has(`${r.id}-tabpanels`)&&C.filter(S=>S.parent_id===r.id&&"tag"in S&&S.tag==="Panel").map(S=>{const Q=C.some(fe=>fe.parent_id===S.id),$e=h.has(S.id);return e.jsxs(ge.Fragment,{children:[e.jsx("div",{"data-depth":_+2,"data-has-children":Q,onClick:fe=>{fe.stopPropagation(),Q&&L(S.id),z(S)},className:"element",children:e.jsxs("div",{className:`elementItem ${v===S.id?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+2)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:Q?e.jsx(Ee,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{transform:$e?"rotate(90deg)":"rotate(0deg)"}}):e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:R(S)}),e.jsx("div",{className:"elementItemActions",children:e.jsx("button",{onClick:async fe=>{fe.stopPropagation(),await D(S)},className:"iconButton",children:e.jsx(br,{color:c.color,strokeWidth:c.stroke,size:c.size})})})]})}),$e&&Q&&ee(C,R,z,D,S.id,_+3)]},S.id)})]}),y&&"props"in r&&e.jsx(e.Fragment,{children:(ws=(vs=r.props)==null?void 0:vs.children)==null?void 0:ws.map((Y,S)=>e.jsx("div",{"data-depth":_+1,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.title||`Button ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-toggle-${S}`))}),G&&"props"in r&&e.jsx(e.Fragment,{children:(Cs=(ks=r.props)==null?void 0:ks.children)==null?void 0:Cs.map((Y,S)=>e.jsx("div",{"data-depth":_+1,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.label||`Option ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-checkbox-${S}`))}),b&&"props"in r&&e.jsx(e.Fragment,{children:(Is=(Ss=r.props)==null?void 0:Ss.children)==null?void 0:Is.map((Y,S)=>e.jsx("div",{"data-depth":_+1,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.label||`Option ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-radio-${S}`))}),T&&"props"in r&&e.jsx(e.Fragment,{children:(Ts=(zs=r.props)==null?void 0:zs.children)==null?void 0:Ts.map((Y,S)=>e.jsx("div",{"data-depth":_+1,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.label||`Item ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-listitem-${S}`))}),A&&"props"in r&&e.jsx(e.Fragment,{children:(Es=(Ps=r.props)==null?void 0:Ps.children)==null?void 0:Es.map((Y,S)=>e.jsx("div",{"data-depth":_+1,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.label||`Item ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-griditem-${S}`))}),P&&"props"in r&&e.jsx(e.Fragment,{children:(_s=(Ds=r.props)==null?void 0:Ds.children)==null?void 0:_s.map((Y,S)=>e.jsx("div",{"data-depth":_+1,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.label||`Option ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-selectitem-${S}`))}),K&&"props"in r&&e.jsx(e.Fragment,{children:(Us=(Ws=r.props)==null?void 0:Ws.children)==null?void 0:Us.map((Y,S)=>e.jsx("div",{"data-depth":_+1,"data-has-children":!1,onClick:Q=>{Q.stopPropagation(),$(r.id,r.props,S)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===S?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${(_+1)*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:e.jsx(xe,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:Y.label||`Option ${S+1}`}),e.jsx("div",{className:"elementItemActions"})]})},`${r.id}-comboitem-${S}`))}),U&&"props"in r&&e.jsx(e.Fragment,{children:(()=>{var fe;const Y=((fe=r.props)==null?void 0:fe.children)||[],S=ie=>{const ye=new Map,ve=[];return ie.forEach((Ne,qs)=>{ye.set(Ne.id,{...Ne,children:[],originalIndex:qs})}),ie.forEach((Ne,qs)=>{const $s=ye.get(Ne.id);if(Ne.parent_id===null||Ne.parent_id===void 0)ve.push($s);else{const Ls=ye.get(Ne.parent_id);Ls&&Ls.children.push($s)}}),ve},Q=(ie,ye)=>e.jsxs(ge.Fragment,{children:[e.jsx("div",{"data-depth":ye,"data-has-children":ie.children&&ie.children.length>0,onClick:ve=>{ve.stopPropagation(),$(r.id,r.props,ie.originalIndex)},className:"element",children:e.jsxs("div",{className:`elementItem ${(m==null?void 0:m.parentId)===r.id&&(m==null?void 0:m.tabIndex)===ie.originalIndex?"active":""}`,children:[e.jsx("div",{className:"elementItemIndent",style:{width:`${ye*8+0}px`}}),e.jsx("div",{className:"elementItemIcon",children:ie.type==="folder"?e.jsx(yr,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}}):e.jsx(pa,{color:c.color,strokeWidth:c.stroke,size:c.size,style:{padding:"2px"}})}),e.jsx("div",{className:"elementItemLabel",children:ie.title||`Item ${ie.originalIndex+1}`}),e.jsx("div",{className:"elementItemActions"})]})}),ie.children&&ie.children.map(ve=>Q(ve,ye+1))]},`${r.id}-treeitem-${ie.id}`);return S(Y).map(ie=>Q(ie,_+1))})()})]})]},r.id)})})},re=(C,R)=>{const z=document.getElementById("previewFrame");if(z!=null&&z.contentDocument){const D=z.contentDocument.querySelector(`[data-element-id="${C}"]`);if(D){const O=f.find(d=>d.id===C),_=D.getBoundingClientRect(),t=window.getComputedStyle(D),r={top:_.top+window.scrollY,left:_.left+window.scrollX,width:parseFloat(t.width)||_.width,height:parseFloat(t.height)||_.height},o={type:"ELEMENT_SELECTED",elementId:C,payload:{rect:r,tag:(O==null?void 0:O.tag)||"Unknown",props:R},source:"builder"};window.postMessage(o,window.location.origin),z.contentWindow&&z.contentWindow.postMessage(o,window.location.origin)}}},le=()=>{x(new Set)},pe=()=>{const C=[];return M.has("nodes")&&C.push(e.jsx("div",{className:"sidebar-section nodes",children:e.jsx($r,{pages:a,setPages:s,handleAddPage:i,renderTree:ee,fetchElements:g,elements:f,setElements:V,selectedElementId:v,setSelectedElement:q,sendElementSelectedMessage:re,collapseAllTreeItems:le})},"nodes")),M.has("components")&&C.push(e.jsx("div",{className:"sidebar-section components",children:e.jsx(Rr,{handleAddElement:n})},"components")),M.has("library")&&C.push(e.jsx("div",{className:"sidebar-section library",children:e.jsx(Br,{})},"library")),M.has("dataset")&&C.push(e.jsx("div",{className:"sidebar-section dataset",children:e.jsx(Ar,{})},"dataset")),M.has("theme")&&C.push(e.jsx("div",{className:"sidebar-section theme",children:e.jsx(ct,{})},"theme")),M.has("ai")&&C.push(e.jsx("div",{className:"sidebar-section ai",children:e.jsx(dt,{})},"ai")),M.has("user")&&C.push(e.jsx("div",{className:"sidebar-section user",children:e.jsx(pt,{})},"user")),M.has("settings")&&C.push(e.jsx("div",{className:"sidebar-section settings settings",children:e.jsx(ht,{})},"settings")),C.length>0?C:e.jsx("div",{className:"sidebar-empty-state"})};return e.jsxs("aside",{className:"sidebar",children:[e.jsx(mt,{activeTabs:M,onTabChange:I}),e.jsx("div",{className:"sidebar-container",children:pe()}),w]})}var Ke,Hs;function ma(){if(Hs)return Ke;Hs=1;function a(s){var i=typeof s;return s!=null&&(i=="object"||i=="function")}return Ke=a,Ke}var He,Js;function xt(){if(Js)return He;Js=1;var a=typeof ze=="object"&&ze&&ze.Object===Object&&ze;return He=a,He}var Je,Zs;function ua(){if(Zs)return Je;Zs=1;var a=xt(),s=typeof self=="object"&&self&&self.Object===Object&&self,i=a||s||Function("return this")();return Je=i,Je}var Ze,Ys;function jt(){if(Ys)return Ze;Ys=1;var a=ua(),s=function(){return a.Date.now()};return Ze=s,Ze}var Ye,Xs;function gt(){if(Xs)return Ye;Xs=1;var a=/\s/;function s(i){for(var n=i.length;n--&&a.test(i.charAt(n)););return n}return Ye=s,Ye}var Xe,Qs;function ft(){if(Qs)return Xe;Qs=1;var a=gt(),s=/^\s+/;function i(n){return n&&n.slice(0,a(n)+1).replace(s,"")}return Xe=i,Xe}var Qe,ea;function xa(){if(ea)return Qe;ea=1;var a=ua(),s=a.Symbol;return Qe=s,Qe}var es,sa;function bt(){if(sa)return es;sa=1;var a=xa(),s=Object.prototype,i=s.hasOwnProperty,n=s.toString,g=a?a.toStringTag:void 0;function u(w){var f=i.call(w,g),v=w[g];try{w[g]=void 0;var m=!0}catch{}var N=n.call(w);return m&&(f?w[g]=v:delete w[g]),N}return es=u,es}var ss,aa;function yt(){if(aa)return ss;aa=1;var a=Object.prototype,s=a.toString;function i(n){return s.call(n)}return ss=i,ss}var as,ra;function Nt(){if(ra)return as;ra=1;var a=xa(),s=bt(),i=yt(),n="[object Null]",g="[object Undefined]",u=a?a.toStringTag:void 0;function w(f){return f==null?f===void 0?g:n:u&&u in Object(f)?s(f):i(f)}return as=w,as}var rs,ta;function vt(){if(ta)return rs;ta=1;function a(s){return s!=null&&typeof s=="object"}return rs=a,rs}var ts,la;function wt(){if(la)return ts;la=1;var a=Nt(),s=vt(),i="[object Symbol]";function n(g){return typeof g=="symbol"||s(g)&&a(g)==i}return ts=n,ts}var ls,na;function kt(){if(na)return ls;na=1;var a=ft(),s=ma(),i=wt(),n=NaN,g=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,w=/^0o[0-7]+$/i,f=parseInt;function v(m){if(typeof m=="number")return m;if(i(m))return n;if(s(m)){var N=typeof m.valueOf=="function"?m.valueOf():m;m=s(N)?N+"":N}if(typeof m!="string")return m===0?m:+m;m=a(m);var q=u.test(m);return q||w.test(m)?f(m.slice(2),q?2:8):g.test(m)?n:+m}return ls=v,ls}var ns,oa;function Ct(){if(oa)return ns;oa=1;var a=ma(),s=jt(),i=kt(),n="Expected a function",g=Math.max,u=Math.min;function w(f,v,m){var N,q,$,M,B,c,h=0,x=!1,V=!1,I=!0;if(typeof f!="function")throw new TypeError(n);v=i(v)||0,a(m)&&(x=!!m.leading,V="maxWait"in m,$=V?g(i(m.maxWait)||0,v):$,I="trailing"in m?!!m.trailing:I);function W(D){var O=N,_=q;return N=q=void 0,h=D,M=f.apply(_,O),M}function L(D){return h=D,B=setTimeout(le,v),x?W(D):M}function ee(D){var O=D-c,_=D-h,t=v-O;return V?u(t,$-_):t}function re(D){var O=D-c,_=D-h;return c===void 0||O>=v||O<0||V&&_>=$}function le(){var D=s();if(re(D))return pe(D);B=setTimeout(le,ee(D))}function pe(D){return B=void 0,I&&N?W(D):(N=q=void 0,M)}function C(){B!==void 0&&clearTimeout(B),h=0,N=c=q=B=void 0}function R(){return B===void 0?M:pe(s())}function z(){var D=s(),O=re(D);if(N=arguments,q=this,c=D,O){if(B===void 0)return L(c);if(V)return clearTimeout(B),B=setTimeout(le,v),W(c)}return B===void 0&&(B=setTimeout(le,v)),M}return z.cancel=C,z.flush=R,z}return ns=w,ns}var St=Ct();const ia=ja(St);function Wt(){var O,_,t,r,o,d,j,y,G;const{projectId:a}=ca(),s=Z.useRef(null),{rawTokens:i,semanticTokens:n,loadTheme:g}=Ue(),u=ne(b=>b.elements),w=ne(b=>b.selectedElementId),f=ne(b=>b.currentPageId),v=ne(b=>b.pageHistories),{addElement:m,setSelectedElement:N,updateElementProps:q,undo:$,redo:M,loadPageElements:B}=ne(),[c,h]=ge.useState([]),[x,V]=ge.useState(null),[I,W]=ge.useState(new Set(["screen"])),[L]=ge.useState([{id:"screen",label:"Screen",max_width:"100%",max_height:"100%"},{id:"desktop",label:"Desktop",max_width:1280,max_height:1080},{id:"tablet",label:"Tablet",max_width:1024,max_height:800},{id:"mobile",label:"Mobile",max_width:390,max_height:844}]);let ee=!1;Z.useEffect(()=>{a&&(async()=>{const{data:T,error:A}=await p.from("pages").select("*").eq("project_id",a).order("order_num",{ascending:!0});A?console.error("프로젝트 조회 에러:",A):h(T)})()},[a]);const re=Z.useCallback(async b=>{window.postMessage({type:"CLEAR_OVERLAY"},window.location.origin),V(b),N(null);const{data:T,error:A}=await p.from("elements").select("*").eq("page_id",b).order("order_num",{ascending:!0});if(A)console.error("요소 조회 에러:",A);else{B(T,b);const P=s.current;P!=null&&P.contentWindow&&P.contentWindow.postMessage({type:"UPDATE_ELEMENTS",elements:T||[]},window.location.origin)}},[V,N,B]);Z.useEffect(()=>{!x&&c.length>0&&re(c[0].id)},[c,x,re]);const le=async(...b)=>{if(!x){alert("먼저 페이지를 선택하세요.");return}const T=u.reduce((K,U)=>Math.max(K,U.order_num||0),0),A=(K,U)=>{const E={style:{},className:""};switch(K){case"Button":return{...E,isDisabled:!1,children:U||"Button"};case"ToggleButton":return{...E,isSelected:!1,defaultSelected:!1,"aria-pressed":!1,children:U||"Toggle"};case"ToggleButtonGroup":return{...E,value:[],defaultValue:[],selectionMode:"single",orientation:"horizontal",isDisabled:!1,children:[{id:"toggle1",title:"Option 1",isSelected:!1},{id:"toggle2",title:"Option 2",isSelected:!1}]};case"CheckboxGroup":return{...E,label:U||"Checkbox Group",orientation:"vertical",isDisabled:!1,children:[{id:"checkbox1",label:"Option 1",isSelected:!1},{id:"checkbox2",label:"Option 2",isSelected:!1}]};case"TextField":return{...E,label:U||"Text Field",description:"",errorMessage:"",isDisabled:!1,isRequired:!1,isReadOnly:!1};case"Label":return{...E,children:U||"Label"};case"Description":return{...E,children:U||"Description"};case"Input":return{...E,type:"text",value:"",placeholder:U||"Input","aria-label":U||"Input"};case"ListBox":return{...E,label:U||"List Box",orientation:"vertical",selectionMode:"none",itemLayout:"default",selectedKeys:[],children:[{id:crypto.randomUUID(),type:"ListBoxItem",label:"Item 1",value:"item1",isDisabled:!1},{id:crypto.randomUUID(),type:"ListBoxItem",label:"Item 2",value:"item2",isDisabled:!1}]};case"GridList":return{...E,label:U||"Grid List",orientation:"vertical",selectionMode:"none",selectedKeys:[],children:[{id:crypto.randomUUID(),type:"GridListItem",label:"Item 1",value:"item1",isDisabled:!1},{id:crypto.randomUUID(),type:"GridListItem",label:"Item 2",value:"item2",isDisabled:!1}]};case"Select":return{...E,label:U||"Select",selectedKey:null,children:[{id:crypto.randomUUID(),type:"SelectItem",label:"Option 1",value:"option1",isDisabled:!1},{id:crypto.randomUUID(),type:"SelectItem",label:"Option 2",value:"option2",isDisabled:!1}]};case"ComboBox":return{...E,label:U||"ComboBox",selectedKey:null,children:[{id:crypto.randomUUID(),type:"ComboBoxItem",label:"Option 1",value:"option1",isDisabled:!1},{id:crypto.randomUUID(),type:"ComboBoxItem",label:"Option 2",value:"option2",isDisabled:!1}]};case"Text":return{...E,children:U||"Text",as:"p"};case"Slider":return{...E,label:U||"Slider",value:[50],minValue:0,maxValue:100,step:1,orientation:"horizontal"};case"Tabs":return{...E,defaultSelectedKey:"tab1",orientation:"horizontal",isDisabled:!1,children:[{id:"tab1",title:"Tab 1",content:"Tab 1 content"},{id:"tab2",title:"Tab 2",content:"Tab 2 content"}]};case"Tree":return{...E,label:U||"Tree",selectionMode:"single",selectionBehavior:"replace",expandedKeys:["folder1"],selectedKeys:[],allowsDragging:!1,children:[{id:"folder1",title:"Folder 1",type:"folder",parent_id:null},{id:"file1",title:"File 1.txt",type:"file",parent_id:"folder1"},{id:"file2",title:"File 2.txt",type:"file",parent_id:"folder1"},{id:"folder2",title:"Folder 2",type:"folder",parent_id:null},{id:"file3",title:"File 3.txt",type:"file",parent_id:"folder2"}]};case"Card":return{...E,children:U||"Card Content"};case"RadioGroup":return{...E,label:U||"Radio Group",orientation:"vertical",isDisabled:!1,children:[{id:"radio1",label:"Option 1",value:"option1"},{id:"radio2",label:"Option 2",value:"option2"}]};case"Panel":return{...E,variant:"tab",title:U||"Panel"};case"Calendar":return{...E,"aria-label":U||"Calendar",isDisabled:!1,visibleDuration:{months:1},pageBehavior:"visible"};case"DatePicker":return{...E,label:U||"Date Picker",description:"",errorMessage:"",placeholder:"Select date...",isDisabled:!1,isRequired:!1,isReadOnly:!1,isInvalid:!1,value:null,defaultValue:null,minValue:null,maxValue:null,placeholderValue:null,granularity:"day",firstDayOfWeek:0,showCalendarIcon:!0,calendarIconPosition:"right",showWeekNumbers:!1,highlightToday:!0,allowClear:!0,dateFormat:"yyyy-MM-dd",autoFocus:!1,shouldForceLeadingZeros:!0,shouldCloseOnSelect:!0};case"DateRangePicker":return{...E,label:U||"Date Range Picker",description:"",errorMessage:"",placeholder:"Select date range...",isDisabled:!1,isRequired:!1,isReadOnly:!1,isInvalid:!1,value:null,defaultValue:null,minValue:null,maxValue:null,placeholderValue:null,granularity:"day",firstDayOfWeek:0,showCalendarIcon:!0,calendarIconPosition:"right",showWeekNumbers:!1,highlightToday:!0,allowClear:!0,autoFocus:!1,shouldForceLeadingZeros:!0,shouldCloseOnSelect:!0,allowsNonContiguousRanges:!1};default:return E}},P={id:crypto.randomUUID(),page_id:x,tag:b[0],props:A(b[0],b[1]),parent_id:w||null,order_num:T+1};if(b[0]==="TextField"){const K=P.id,U=[{id:crypto.randomUUID(),page_id:x,tag:"Label",props:{children:"Text Field",style:{},className:""},parent_id:K,order_num:1},{id:crypto.randomUUID(),page_id:x,tag:"Input",props:{style:{},className:""},parent_id:K,order_num:2},{id:crypto.randomUUID(),page_id:x,tag:"Description",props:{text:"",style:{},className:""},parent_id:K,order_num:3},{id:crypto.randomUUID(),page_id:x,tag:"FieldError",props:{text:"",style:{},className:""},parent_id:K,order_num:4}],{data:E,error:se}=await p.from("elements").insert([P,...U]).select();se?console.error("요소 추가 에러:",se):E&&(E.forEach(J=>{m(J)}),requestAnimationFrame(()=>{N(K,P.props)}))}else if(b[0]==="ToggleButtonGroup"){const{data:K,error:U}=await p.from("elements").insert([P]).select();U?console.error("요소 추가 에러:",U):K&&(K.forEach(E=>{m(E)}),requestAnimationFrame(()=>{N(P.id,P.props)}))}else if(b[0]==="Tabs"){const K=P.id,se=(P.props.children||[]).map((de,me)=>({id:crypto.randomUUID(),page_id:x,tag:"Panel",props:{variant:"tab",title:de.title,tabIndex:me,style:{},className:""},parent_id:K,order_num:me+1})),{data:J,error:oe}=await p.from("elements").insert([P,...se]).select();oe?console.error("Tabs 및 Panel 추가 에러:",oe):J&&(J.forEach(de=>{m(de)}),requestAnimationFrame(()=>{N(K,P.props)}))}else{const{data:K,error:U}=await p.from("elements").insert([P]).select();U?console.error("요소 추가 에러:",U):K&&(m(K[0]),requestAnimationFrame(()=>{N(K[0].id,K[0].props)}))}},pe=ia(async()=>{if(!ee){ee=!0;try{$(),await new Promise(P=>setTimeout(P,0));const b=ne.getState().elements,{error:T}=await p.from("elements").upsert(b,{onConflict:"id"});if(T)throw T;const A=s.current;A!=null&&A.contentWindow&&A.contentWindow.postMessage({type:"UPDATE_ELEMENTS",elements:b},window.location.origin)}catch(b){console.error("Undo error:",b)}finally{ee=!1}}},300),C=ia(async()=>{if(!ee){ee=!0;try{M(),await new Promise(P=>setTimeout(P,0));const b=ne.getState().elements,{error:T}=await p.from("elements").upsert(b,{onConflict:"id"});if(T)throw T;const A=s.current;A!=null&&A.contentWindow&&A.contentWindow.postMessage({type:"UPDATE_ELEMENTS",elements:b},window.location.origin)}catch(b){console.error("Redo error:",b)}finally{ee=!1}}},300);Z.useEffect(()=>{var A;const b=s.current,T=()=>{if(!b){console.warn("iframe not found");return}if(!b.contentWindow){console.warn("iframe contentWindow not accessible");return}u.length>0&&b.contentWindow.postMessage({type:"UPDATE_ELEMENTS",elements:u},window.location.origin)};if(((A=b==null?void 0:b.contentDocument)==null?void 0:A.readyState)==="complete")T();else return b==null||b.addEventListener("load",T),()=>b==null?void 0:b.removeEventListener("load",T)},[u]),Z.useEffect(()=>{const b=T=>{var A;if(T.origin!==window.location.origin){console.warn("Received message from untrusted origin:",T.origin);return}if(T.data.type==="UPDATE_THEME_TOKENS"){const P=s.current;if(!(P!=null&&P.contentDocument))return;let K=document.getElementById("theme-tokens");K||(K=document.createElement("style"),K.id="theme-tokens",document.head.appendChild(K));const U=`:root {
${Object.entries(T.data.styles).map(([se,J])=>`  ${se}: ${J};`).join(`
`)}
}`;K.textContent=U;let E=P.contentDocument.getElementById("theme-tokens");E||(E=P.contentDocument.createElement("style"),E.id="theme-tokens",P.contentDocument.head.appendChild(E)),E.textContent=U}if(T.data.type==="ELEMENT_SELECTED"&&T.data.source!=="builder"&&N(T.data.elementId,(A=T.data.payload)==null?void 0:A.props),T.data.type==="UPDATE_ELEMENT_PROPS"&&T.data.elementId&&q(T.data.elementId,T.data.payload.props),T.data.type==="element-props-update"&&T.data.elementId){q(T.data.elementId,T.data.props);const P=s.current;if(P!=null&&P.contentWindow){const K=ne.getState().elements;P.contentWindow.postMessage({type:"UPDATE_ELEMENTS",elements:K},window.location.origin)}}T.data.type==="element-click"&&T.data.elementId};return window.addEventListener("message",b),()=>window.removeEventListener("message",b)},[N,q]);const R=async()=>{const b=prompt("Enter page title:"),T=prompt("Enter page slug:");if(!b||!T){alert("Title and slug are required.");return}const A=[...c].sort((se,J)=>(se.order_num||0)-(J.order_num||0)),P=A.length===0?1e3:(A[A.length-1].order_num||0)+1e3,K={title:b,project_id:a,slug:T,order_num:P},{data:U,error:E}=await p.from("pages").insert([K]).select();if(E){console.error("페이지 생성 에러:",E);return}if(U){const se=U[0],J={id:crypto.randomUUID(),page_id:se.id,parent_id:null,tag:"body",props:{style:{margin:0}},order_num:0},{data:oe,error:de}=await p.from("elements").insert([J]).select();if(de){console.error("Body 요소 생성 에러:",de);return}h(me=>[...me,se]),oe&&(m(oe[0]),re(se.id))}};Z.useEffect(()=>{const b=T=>{const A=s.current,P=T.target;if(P.closest(".selection-overlay")||P.closest(".sidebar")||P.closest(".inspector")||P.closest(".header")||P.closest(".footer")||A!=null&&A.contains(P))return;(P.classList.contains("workspace")||P.classList.contains("bg"))&&(N(null),window.postMessage({type:"CLEAR_OVERLAY"},window.location.origin))};return document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[N]);const z=Z.useCallback(()=>{const b=s.current;if(!(b!=null&&b.contentDocument))return;const T=[...i,...n],A=new Map(i.map(J=>[J.name,J])),P=J=>{if(typeof J.value=="object"&&J.value!==null)if("h"in J.value){const oe=J.value;return`hsla(${oe.h}, ${oe.s}%, ${oe.l}%, ${oe.a})`}else return JSON.stringify(J.value);else return String(J.value)},U=`:root {
  ${T.map(J=>{const oe=J.css_variable||`--${J.type}-${J.name.toLowerCase().replace(/\./g,"-")}`;let de;if(J.scope==="semantic"&&J.alias_of){const me=A.get(J.alias_of);me?de=`var(${me.css_variable||`--${me.type}-${me.name.toLowerCase().replace(/\./g,"-")}`})`:de=P(J)}else de=P(J);return`${oe}: ${de};`}).join(`
  `)}
}`;let E=document.getElementById("theme-tokens");E||(E=document.createElement("style"),E.id="theme-tokens",document.head.appendChild(E)),E.textContent=U;let se=b.contentDocument.getElementById("theme-tokens");se||(se=b.contentDocument.createElement("style"),se.id="theme-tokens",b.contentDocument.head.appendChild(se)),se.textContent=U},[i,n]);Z.useEffect(()=>{a&&g(a)},[a,g]);const D=()=>{const b=s.current;if(!(b!=null&&b.contentWindow)){console.warn("iframe contentWindow not available on load");return}const T=()=>{var A;((A=b.contentWindow)==null?void 0:A.document.readyState)==="complete"?(u.length>0&&b.contentWindow.postMessage({type:"UPDATE_ELEMENTS",elements:u},window.location.origin),z()):setTimeout(T,100)};T()};return Z.useEffect(()=>{z()},[z]),e.jsx("div",{className:"app",children:e.jsxs("div",{className:"contents",children:[e.jsx("main",{children:e.jsx("div",{className:"bg",style:{backgroundSize:Math.round(Number((O=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:O.max_width)||0)+"px "+Math.round(Number((_=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:_.max_height)||0)+"px"},children:e.jsxs("div",{className:"workspace","max-width":(t=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:t.max_width,style:{width:((r=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:r.max_width)||"100%",height:((o=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:o.max_height)||"100%",borderWidth:((d=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:d.id)==="screen"?"0px":"1px"},children:[e.jsx("iframe",{ref:s,id:"previewFrame",src:a?`/preview/${a}?isIframe=true`:"/preview?isIframe=true",style:{width:"100%",height:"100%",border:"none"},sandbox:"allow-scripts allow-same-origin allow-forms",onLoad:D}),e.jsx(Er,{})]})})}),e.jsx(ut,{pages:c,setPages:h,handleAddPage:R,handleAddElement:le,fetchElements:re,selectedPageId:x}),e.jsx("aside",{className:"inspector",children:e.jsx(Wr,{})}),e.jsxs("nav",{className:"header",children:[e.jsxs("div",{className:"header_contents header_left",children:[e.jsx("button",{"aria-label":"Menu",children:e.jsx(da,{color:"#fff",strokeWidth:l.stroke,size:l.size})}),a?`Project ID: ${a}`:"No project ID provided"]}),e.jsxs("div",{className:"header_contents screen",children:[e.jsxs("code",{className:"code sizeInfo",children:[(j=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:j.max_width,"x",(y=L.find(b=>b.id===Array.from(I)[0]))==null?void 0:y.max_height]}),e.jsx(ba,{orientation:"horizontal",value:(G=Array.from(I)[0])==null?void 0:G.toString(),onChange:b=>W(new Set([b])),children:L.map(b=>e.jsxs(ya,{value:b.id,className:"aria-Radio",children:[b.id==="screen"&&e.jsx(Nr,{color:l.color,strokeWidth:l.stroke,size:l.size}),b.id==="desktop"&&e.jsx(vr,{color:l.color,strokeWidth:l.stroke,size:l.size}),b.id==="tablet"&&e.jsx(wr,{color:l.color,strokeWidth:l.stroke,size:l.size}),b.id==="mobile"&&e.jsx(kr,{color:l.color,strokeWidth:l.stroke,size:l.size}),e.jsx(Na,{children:b.label})]},b.id))})]}),e.jsxs("div",{className:"header_contents header_right",children:[e.jsx("span",{children:f&&v[f]?`${v[f].historyIndex+1}/${v[f].history.length}`:"0/0"}),e.jsx("button",{"aria-label":"Undo",onClick:pe,disabled:!f||!v[f]||v[f].historyIndex<0,className:!f||!v[f]||v[f].historyIndex<0?"disabled":"",children:e.jsx(Cr,{color:!f||!v[f]||v[f].historyIndex<0?"#999":l.color,strokeWidth:l.stroke,size:l.size})}),e.jsx("button",{"aria-label":"Redo",onClick:C,disabled:!f||!v[f]||v[f].historyIndex>=v[f].history.length-1,className:!f||!v[f]||v[f].historyIndex>=v[f].history.length-1?"disabled":"",children:e.jsx(Sr,{color:!f||!v[f]||v[f].historyIndex>=v[f].history.length-1?"#999":l.color,strokeWidth:l.stroke,size:l.size})}),e.jsx("button",{"aria-label":"Preview",children:e.jsx(Ir,{color:l.color,strokeWidth:l.stroke,size:l.size})}),e.jsx("button",{"aria-label":"Play",children:e.jsx(zr,{color:l.color,strokeWidth:l.stroke,size:l.size})}),e.jsx("button",{"aria-label":"Publish",className:"publish",children:"Publish"})]})]}),e.jsx("footer",{className:"footer",children:"footer"})]})})}export{Wt as default};
