---
description: XStudio í”„ë¡œì íŠ¸ì˜ í†µí•© ê°œë°œ ê·œì¹™ ë° ê°€ì´ë“œë¼ì¸
globs: **/*.{ts,tsx,js,jsx,css,md,mdx}
alwaysApply: true
---

# XStudio í†µí•© ê°œë°œ ê·œì¹™

## í”„ë¡œì íŠ¸ ê°œìš”

**XStudio**ëŠ” React 19, TypeScript, Vite, Supabaseë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ì›¹ ê¸°ë°˜ UI ë¹Œë”/ë””ìì¸ ìŠ¤íŠœë””ì˜¤ì…ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ
- **Frontend**: React 19 + TypeScript + React Aria Components
- **Build Tool**: Vite (React SWC í”ŒëŸ¬ê·¸ì¸)
- **ìƒíƒœ ê´€ë¦¬**: Zustand
- **ìŠ¤íƒ€ì¼ë§**: Tailwind CSS 4 + PostCSS
- **Backend**: Supabase (PostgreSQL + Auth + Storage)
- **ë¼ìš°íŒ…**: React Router 7
- **ê°œë°œ ë„êµ¬**: Storybook 8, Vitest, Playwright

## AI ê°œë°œ ê°€ì´ë“œë¼ì¸

### ì‘ë‹µ ì–¸ì–´
- **í•­ìƒ í•œêµ­ì–´ë¡œ ì‘ë‹µí•  ê²ƒ**
- ì½”ë“œ ì£¼ì„ê³¼ ë¬¸ì„œí™”ë„ í•œêµ­ì–´ ìš°ì„ 

### ê°œë°œ í”„ë¡œì„¸ìŠ¤
1. **ê³„íš ìˆ˜ë¦½**: ìš”êµ¬ì‚¬í•­ì„ ë‹¨ê³„ë³„ë¡œ ë¶„ì„í•˜ê³  ì˜ì‚¬ì½”ë“œë¡œ ìƒì„¸ ê³„íš ì‘ì„±
2. **í™•ì¸**: ê³„íšì„ ì‚¬ìš©ìì™€ í™•ì¸ í›„ ì½”ë“œ ì‘ì„± ì‹œì‘
3. **êµ¬í˜„**: ì™„ì „í•˜ê³  ë²„ê·¸ ì—†ëŠ” ê¸°ëŠ¥ì  ì½”ë“œ ì‘ì„±
4. **ê²€ì¦**: ëª¨ë“  ê¸°ëŠ¥ì´ ì™„ì „íˆ êµ¬í˜„ë˜ì—ˆëŠ”ì§€ ì² ì €íˆ í™•ì¸

### ì½”ë“œ í’ˆì§ˆ ì›ì¹™
- **ê°€ë…ì„± ìš°ì„ **: ì„±ëŠ¥ë³´ë‹¤ ì½”ë“œ ê°€ë…ì„±ì„ ìš°ì„ ì‹œ
- **ì™„ì „ì„±**: TODO, í”Œë ˆì´ìŠ¤í™€ë”, ë¯¸ì™„ì„± ë¶€ë¶„ ê¸ˆì§€
- **ë³´ì•ˆ**: ì‚¬ìš©ì ì…ë ¥ ê²€ì¦, SQL ì¸ì ì…˜ ë°©ì§€, XSS ë°©ì§€
- **í…ŒìŠ¤íŠ¸**: ëª¨ë“  ìƒˆë¡œìš´ ê¸°ëŠ¥ì— ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ)

## í”„ë¡œì íŠ¸ êµ¬ì¡° ë° ì•„í‚¤í…ì²˜

### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
src/
â”œâ”€â”€ App.tsx / App.css        # ë£¨íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì…¸
â”œâ”€â”€ assets/                  # ì •ì  ìì‚°
â”œâ”€â”€ auth/                    # ì¸ì¦ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ builder/                 # í•µì‹¬ ë¹Œë” ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ ai/                  # AI ì–´ì‹œìŠ¤í„´íŠ¸ UI
â”‚   â”œâ”€â”€ components/          # React Aria ê¸°ë°˜ ìœ„ì ¯ ë˜í¼
â”‚   â”œâ”€â”€ dataset/             # ìƒ˜í”Œ ë°ì´í„°
â”‚   â”œâ”€â”€ factories/           # ì»´í¬ë„ŒíŠ¸ íŒ©í† ë¦¬
â”‚   â”œâ”€â”€ hooks/               # ë¹Œë” ì „ìš© í›…
â”‚   â”œâ”€â”€ inspector/           # ì†ì„± í¸ì§‘ê¸°
â”‚   â”‚   â”œâ”€â”€ design/          # ë””ìì¸ ì†ì„± í¸ì§‘
â”‚   â”‚   â”œâ”€â”€ events/          # ì´ë²¤íŠ¸ ì†ì„± í¸ì§‘
â”‚   â”‚   â””â”€â”€ properties/      # ì»´í¬ë„ŒíŠ¸ë³„ ì†ì„± ì—ë””í„°
â”‚   â”œâ”€â”€ library/             # ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”œâ”€â”€ main/                # ë©”ì¸ ë¹Œë” ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ monitor/             # ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
â”‚   â”œâ”€â”€ nodes/               # ë…¸ë“œ íŠ¸ë¦¬ ê´€ë¦¬
â”‚   â”œâ”€â”€ overlay/             # ì„ íƒ ì˜¤ë²„ë ˆì´
â”‚   â”œâ”€â”€ preview/             # iframe í”„ë¦¬ë·°
â”‚   â”œâ”€â”€ setting/             # ë¹Œë” ì„¤ì •
â”‚   â”œâ”€â”€ sidebar/             # ì‚¬ì´ë“œë°” ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ stores/              # Zustand ìƒíƒœ ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ theme/               # í…Œë§ˆ í¸ì§‘ê¸°
â”‚   â”œâ”€â”€ user/                # ì‚¬ìš©ì ê´€ë ¨
â”‚   â””â”€â”€ utils/               # ë¹Œë” ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ dashboard/               # í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œ
â”œâ”€â”€ demo/                    # ë°ëª¨ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ env/                     # í™˜ê²½ ì„¤ì •
â”œâ”€â”€ hooks/                   # ì „ì—­ í›…
â”œâ”€â”€ services/api/            # API ì„œë¹„ìŠ¤ ë ˆì´ì–´
â”œâ”€â”€ stories/                 # Storybook ìŠ¤í† ë¦¬
â”œâ”€â”€ types/                   # TypeScript íƒ€ì… ì •ì˜
â”œâ”€â”€ utils/                   # ì „ì—­ ìœ í‹¸ë¦¬í‹°
â””â”€â”€ main.tsx                 # ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
```

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜

#### 1. ë¹Œë” í•µì‹¬ ì»´í¬ë„ŒíŠ¸
- **BuilderCore**: ë©”ì¸ ë¹Œë” ì»´í¬ë„ŒíŠ¸ (`src/builder/main/BuilderCore.tsx`)
- **BuilderHeader**: ìƒë‹¨ íˆ´ë°” (`src/builder/main/BuilderHeader.tsx`)
- **BuilderWorkspace**: ì‘ì—… ì˜ì—­ (`src/builder/main/BuilderWorkspace.tsx`)
- **BuilderViewport**: ë ˆì´ì•„ì›ƒ ì»¨í…Œì´ë„ˆ (`src/builder/main/BuilderViewport.tsx`)

#### 2. ë°ì´í„° íë¦„
```typescript
// UI ì•¡ì…˜ â†’ Zustand ìƒíƒœ ì—…ë°ì´íŠ¸ â†’ Supabase API í˜¸ì¶œ
const handleAddElement = async (tag: string) => {
  const newElement = { 
    id: crypto.randomUUID(),
    tag,
    props: getDefaultProps(tag),
    parent_id: parentId,
    page_id: currentPageId,
    order_num: calculateNextOrderNum()
  };
  
  // 1. Supabaseì— ì €ì¥
  const { data, error } = await supabase
    .from("elements")
    .insert([newElement])
    .select()
    .single();
    
  if (!error && data) {
    // 2. Zustand ìƒíƒœ ì—…ë°ì´íŠ¸
    addElement(data);
    
    // 3. iframe í”„ë¦¬ë·° ë™ê¸°í™”
    sendElementsToIframe();
  }
};
```

## ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (Supabase)

### ì£¼ìš” í…Œì´ë¸” êµ¬ì¡°

#### 1. users í…Œì´ë¸”
```sql
CREATE TABLE public.users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL,
  display_name TEXT,
  avatar_url TEXT,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now()
);
```

#### 2. projects í…Œì´ë¸”
```sql
CREATE TABLE public.projects (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  created_by UUID NOT NULL,
  domain TEXT UNIQUE,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now(),
  CONSTRAINT fk_projects_user FOREIGN KEY (created_by)
    REFERENCES public.users(id) ON DELETE CASCADE
);
```

#### 3. pages í…Œì´ë¸”
```sql
CREATE TABLE public.pages (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  project_id UUID NOT NULL,
  title TEXT NOT NULL,
  slug TEXT NOT NULL,
  order_num INT,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now(),
  CONSTRAINT fk_pages_project FOREIGN KEY (project_id)
    REFERENCES public.projects(id) ON DELETE CASCADE
);
```

#### 4. elements í…Œì´ë¸” (í•µì‹¬)
```sql
CREATE TABLE public.elements (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  page_id UUID NOT NULL,
  parent_id UUID,  -- íŠ¸ë¦¬ êµ¬ì¡°ìš© (NULL = ë£¨íŠ¸)
  tag TEXT NOT NULL,  -- 'div', 'button', 'text' ë“±
  props JSONB DEFAULT '{}',  -- ì»´í¬ë„ŒíŠ¸ ì†ì„±
  order_num INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now(),
  CONSTRAINT fk_elements_page FOREIGN KEY (page_id)
    REFERENCES public.pages(id) ON DELETE CASCADE,
  CONSTRAINT fk_elements_parent FOREIGN KEY (parent_id)
    REFERENCES public.elements(id) ON DELETE CASCADE
);
```

#### 5. design_tokens í…Œì´ë¸”
```sql
CREATE TABLE public.design_tokens (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  project_id UUID NOT NULL,
  theme_id UUID NOT NULL,
  name TEXT NOT NULL,
  type TEXT NOT NULL,  -- 'color', 'font', 'spacing'
  value JSONB NOT NULL,
  scope TEXT NOT NULL DEFAULT 'raw' CHECK (scope IN ('raw', 'semantic')),
  alias_of TEXT,
  css_variable TEXT,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  CONSTRAINT fk_tokens_project FOREIGN KEY (project_id)
    REFERENCES public.projects(id) ON DELETE CASCADE,
  CONSTRAINT fk_tokens_theme FOREIGN KEY (theme_id)
    REFERENCES public.design_themes(id) ON DELETE CASCADE
);
```

## ì½”ë”© ê·œì¹™ ë° ìŠ¤íƒ€ì¼

### ëª…ëª… ê·œì¹™

#### íŒŒì¼ëª…
- **React ì»´í¬ë„ŒíŠ¸**: PascalCase (`BuilderHeader.tsx`, `PropertyPanel.tsx`)
- **í›…**: camelCase + `use` ì ‘ë‘ì‚¬ (`useElementCreator.ts`, `useTheme.ts`)
- **ìœ í‹¸ë¦¬í‹°**: camelCase (`elementUtils.ts`, `themeUtils.ts`)
- **íƒ€ì… ì •ì˜**: camelCase (`store.ts`, `componentProps.ts`)
- **CSS**: ì»´í¬ë„ŒíŠ¸ëª… ë§¤ì¹­ (`ComponentList.css`, `index.css`)

#### ì½”ë“œ ë‚´ ëª…ëª…
```typescript
// âœ… DO: ëª…í™•í•œ í•¨ìˆ˜ëª…
export function createElementWithDefaults(tag: string, parentId?: string) { }

// âœ… DO: ì˜ë¯¸ìˆëŠ” ë³€ìˆ˜ëª…
const selectedElementId = useStore(state => state.selectedElementId);
const isElementBeingDragged = dragState.isDragging;

// âŒ DON'T: ëª¨í˜¸í•œ ëª…ëª…
const el = getEl();
const data = fetchData();
```

### ì½”ë“œ ìŠ¤íƒ€ì¼
- **ë“¤ì—¬ì“°ê¸°**: ê³µë°± 4ì¹¸ ì¼ê´€ ì‚¬ìš©
- **ë”°ì˜´í‘œ**: TypeScriptì—ì„œ ë‹¨ì¼ ë”°ì˜´í‘œ, JSX ì†ì„±ì—ì„œ ì´ì¤‘ ë”°ì˜´í‘œ
- **ì„¸ë¯¸ì½œë¡ **: ëª¨ë“  êµ¬ë¬¸ ëì— ëª…ì‹œì  ì„¸ë¯¸ì½œë¡ 
- **ì¤„ ê¸¸ì´**: ìµœëŒ€ 80ì ê¶Œì¥

```typescript
// âœ… DO: ì¼ê´€ëœ ìŠ¤íƒ€ì¼
import { useState, useCallback } from 'react';
import { Button } from '../components/Button';

export function ExampleComponent({ title }: { title: string }) {
    const [isVisible, setIsVisible] = useState(false);
    
    const handleToggle = useCallback(() => {
        setIsVisible(prev => !prev);
    }, []);
    
    return (
        <div className="p-4 bg-white rounded-lg">
            <h2 className="text-lg font-semibold">{title}</h2>
            <Button onPress={handleToggle}>
                {isVisible ? "ìˆ¨ê¸°ê¸°" : "ë³´ì´ê¸°"}
            </Button>
        </div>
    );
}
```

### Import/Export íŒ¨í„´
```typescript
// âœ… DO: ì˜¬ë°”ë¥¸ import ìˆœì„œ
// 1. ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬
import React from 'react';
import { Button } from 'react-aria-components';
import { create } from 'zustand';

// 2. ë¹ˆ ì¤„ í›„ ë‚´ë¶€ ëª¨ë“ˆ
import { ElementProps } from '../../types/store';
import { useStore } from '../stores';
import './ComponentName.css';

// âœ… DO: íƒ€ì…ë§Œ ì‚¬ìš©ì‹œ type import
import type { ComponentElementProps } from '../types/componentProps';
```

## ì»´í¬ë„ŒíŠ¸ ê°œë°œ íŒ¨í„´

### React Aria Components ë˜í•‘
```typescript
// âœ… DO: React Aria ì»´í¬ë„ŒíŠ¸ ë˜í•‘ íŒ¨í„´
import { Button as AriaButton, ButtonProps } from 'react-aria-components';
import { tv } from 'tailwind-variants';
import { forwardRef } from 'react';

const buttonVariants = tv({
    base: 'px-4 py-2 rounded-md font-medium transition-colors',
    variants: {
        variant: {
            primary: 'bg-blue-500 text-white hover:bg-blue-600',
            secondary: 'bg-gray-200 text-gray-900 hover:bg-gray-300',
        },
        size: {
            sm: 'px-3 py-1 text-sm',
            md: 'px-4 py-2',
            lg: 'px-6 py-3 text-lg',
        },
    },
    defaultVariants: {
        variant: 'primary',
        size: 'md',
    },
});

interface CustomButtonProps extends ButtonProps {
    variant?: 'primary' | 'secondary';
    size?: 'sm' | 'md' | 'lg';
}

export const Button = forwardRef<HTMLButtonElement, CustomButtonProps>(
    ({ className, variant, size, ...props }, ref) => {
        return (
            <AriaButton
                ref={ref}
                className={buttonVariants({ variant, size, className })}
                {...props}
            />
        );
    }
);

Button.displayName = 'Button';
```

### Zustand ìƒíƒœ ê´€ë¦¬ íŒ¨í„´
```typescript
// âœ… DO: Zustand ìŠ¤í† ì–´ ìŠ¬ë¼ì´ìŠ¤ íŒ¨í„´
import { create } from 'zustand';
import { immer } from 'zustand/middleware/immer';

interface ElementState {
    elements: Element[];
    selectedElementId: string | null;
    
    // Actions
    addElement: (element: Element) => void;
    updateElement: (id: string, props: Partial<Element>) => void;
    selectElement: (id: string | null) => void;
    deleteElement: (id: string) => void;
}

export const useElementStore = create<ElementState>()(
    immer((set, get) => ({
        elements: [],
        selectedElementId: null,
        
        addElement: (element) => set((state) => {
            state.elements.push(element);
        }),
        
        updateElement: (id, props) => set((state) => {
            const element = state.elements.find(el => el.id === id);
            if (element) {
                Object.assign(element, props);
            }
        }),
        
        selectElement: (id) => set((state) => {
            state.selectedElementId = id;
        }),
        
        deleteElement: (id) => set((state) => {
            state.elements = state.elements.filter(el => el.id !== id);
            if (state.selectedElementId === id) {
                state.selectedElementId = null;
            }
        }),
    }))
);
```

### ì»¤ìŠ¤í…€ í›… íŒ¨í„´
```typescript
// âœ… DO: ë³µì¡í•œ ë¡œì§ì„ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë¶„ë¦¬
export function useElementCreator() {
    const { addElement } = useElementStore();
    const { currentPageId } = usePageStore();
    const { showError } = useErrorHandler();
    
    const createElement = useCallback(async (
        tag: string, 
        parentId?: string,
        initialProps?: Record<string, any>
    ) => {
        try {
            const newElement = {
                id: crypto.randomUUID(),
                tag,
                props: { ...getDefaultProps(tag), ...initialProps },
                parent_id: parentId || null,
                page_id: currentPageId,
                order_num: await calculateNextOrderNum(parentId),
            };
            
            // Supabaseì— ì €ì¥
            const { data, error } = await supabase
                .from('elements')
                .insert([newElement])
                .select()
                .single();
                
            if (error) throw error;
            
            // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
            addElement(data);
            
            return data;
        } catch (error) {
            showError('ìš”ì†Œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', error);
            return null;
        }
    }, [addElement, currentPageId, showError]);
    
    return { createElement };
}
```

## API ì„œë¹„ìŠ¤ íŒ¨í„´

### ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ êµ¬ì¡°
```typescript
// âœ… DO: API ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ íŒ¨í„´
import { supabase } from '../../env/supabase.client';
import { handleApiError } from './ErrorHandler';
import type { Element, ElementInsert, ElementUpdate } from '../../types/store';

export class ElementsApiService {
    static async getPageElements(pageId: string): Promise<Element[]> {
        try {
            const { data, error } = await supabase
                .from('elements')
                .select('*')
                .eq('page_id', pageId)
                .order('order_num');
                
            if (error) throw error;
            return data;
        } catch (error) {
            throw handleApiError(error, 'í˜ì´ì§€ ìš”ì†Œ ì¡°íšŒ ì‹¤íŒ¨');
        }
    }
    
    static async createElement(element: ElementInsert): Promise<Element> {
        try {
            const { data, error } = await supabase
                .from('elements')
                .insert([element])
                .select()
                .single();
                
            if (error) throw error;
            return data;
        } catch (error) {
            throw handleApiError(error, 'ìš”ì†Œ ìƒì„± ì‹¤íŒ¨');
        }
    }
    
    static async updateElement(id: string, updates: ElementUpdate): Promise<Element> {
        try {
            const { data, error } = await supabase
                .from('elements')
                .update(updates)
                .eq('id', id)
                .select()
                .single();
                
            if (error) throw error;
            return data;
        } catch (error) {
            throw handleApiError(error, 'ìš”ì†Œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨');
        }
    }
    
    static async deleteElement(id: string): Promise<void> {
        try {
            const { error } = await supabase
                .from('elements')
                .delete()
                .eq('id', id);
                
            if (error) throw error;
        } catch (error) {
            throw handleApiError(error, 'ìš”ì†Œ ì‚­ì œ ì‹¤íŒ¨');
        }
    }
}
```

## ì„±ëŠ¥ ìµœì í™” ê·œì¹™

### React ìµœì í™”
```typescript
// âœ… DO: ë©”ëª¨ì´ì œì´ì…˜ê³¼ ì„ íƒì  êµ¬ë…
import { memo, useMemo, useCallback } from 'react';
import { shallow } from 'zustand/shallow';

const ElementRenderer = memo(({ elementId }: { elementId: string }) => {
    // í•„ìš”í•œ ë°ì´í„°ë§Œ ì„ íƒì  êµ¬ë…
    const element = useElementStore(
        state => state.elements.find(el => el.id === elementId),
        shallow
    );
    
    // ë³µì¡í•œ ê³„ì‚° ë©”ëª¨ì´ì œì´ì…˜
    const computedStyles = useMemo(() => {
        if (!element) return {};
        return calculateElementStyles(element.props);
    }, [element?.props]);
    
    // ì½œë°± ë©”ëª¨ì´ì œì´ì…˜
    const handleClick = useCallback((e: React.MouseEvent) => {
        e.stopPropagation();
        selectElement(elementId);
    }, [elementId]);
    
    if (!element) return null;
    
    return (
        <div
            style={computedStyles}
            onClick={handleClick}
            className="element-wrapper"
        >
            {/* ìš”ì†Œ ë Œë”ë§ */}
        </div>
    );
});

ElementRenderer.displayName = 'ElementRenderer';
```

### ë””ë°”ìš´ì‹±ê³¼ ë°°ì¹˜ ì²˜ë¦¬
```typescript
// âœ… DO: ë””ë°”ìš´ìŠ¤ëœ Supabase ì—…ë°ì´íŠ¸
import { debounce } from 'lodash';

export function useDebounceSupabaseUpdate() {
    const debouncedUpdate = useMemo(
        () => debounce(async (elementId: string, updates: ElementUpdate) => {
            try {
                await ElementsApiService.updateElement(elementId, updates);
            } catch (error) {
                console.error('Supabase ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
            }
        }, 500),
        []
    );
    
    return debouncedUpdate;
}
```

## iframe í†µì‹  íŒ¨í„´

### ì•ˆì „í•œ ë©”ì‹œì§€ íŒ¨ì‹±
```typescript
// âœ… DO: íƒ€ì… ì•ˆì „í•œ iframe í†µì‹ 
interface IframeMessage {
    type: 'UPDATE_ELEMENTS' | 'SELECT_ELEMENT' | 'HOVER_ELEMENT';
    data: any;
}

export class IframeMessenger {
    private iframe: HTMLIFrameElement | null = null;
    private origin: string;
    
    constructor(origin: string = window.location.origin) {
        this.origin = origin;
    }
    
    setIframe(iframe: HTMLIFrameElement) {
        this.iframe = iframe;
    }
    
    send(message: IframeMessage) {
        if (!this.iframe?.contentWindow) return;
        
        this.iframe.contentWindow.postMessage(message, this.origin);
    }
    
    listen(handler: (message: IframeMessage) => void) {
        const messageHandler = (event: MessageEvent) => {
            // ë³´ì•ˆ ê²€ì¦
            if (event.origin !== this.origin) return;
            
            try {
                const message: IframeMessage = event.data;
                handler(message);
            } catch (error) {
                console.error('iframe ë©”ì‹œì§€ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
            }
        };
        
        window.addEventListener('message', messageHandler);
        
        return () => window.removeEventListener('message', messageHandler);
    }
}
```

## í…ŒìŠ¤íŠ¸ ë° ë¬¸ì„œí™”

### í…ŒìŠ¤íŠ¸ íŒ¨í„´
```typescript
// âœ… DO: ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
import { describe, it, expect, vi } from 'vitest';
import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from './Button';

describe('Button ì»´í¬ë„ŒíŠ¸', () => {
    it('ë²„íŠ¼ í…ìŠ¤íŠ¸ê°€ ì˜¬ë°”ë¥´ê²Œ ë Œë”ë§ëœë‹¤', () => {
        render(<Button>í´ë¦­í•˜ì„¸ìš”</Button>);
        expect(screen.getByRole('button')).toHaveTextContent('í´ë¦­í•˜ì„¸ìš”');
    });
    
    it('í´ë¦­ ì´ë²¤íŠ¸ê°€ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬ëœë‹¤', () => {
        const handleClick = vi.fn();
        render(<Button onPress={handleClick}>í´ë¦­</Button>);
        
        fireEvent.click(screen.getByRole('button'));
        expect(handleClick).toHaveBeenCalledTimes(1);
    });
    
    it('variant propì— ë”°ë¼ ì˜¬ë°”ë¥¸ ìŠ¤íƒ€ì¼ì´ ì ìš©ëœë‹¤', () => {
        const { rerender } = render(<Button variant="primary">ë²„íŠ¼</Button>);
        expect(screen.getByRole('button')).toHaveClass('bg-blue-500');
        
        rerender(<Button variant="secondary">ë²„íŠ¼</Button>);
        expect(screen.getByRole('button')).toHaveClass('bg-gray-200');
    });
});
```

### Storybook ë¬¸ì„œí™”
```typescript
// âœ… DO: í¬ê´„ì ì¸ Storybook ìŠ¤í† ë¦¬
import type { Meta, StoryObj } from '@storybook/react';
import { Button } from './Button';

const meta: Meta<typeof Button> = {
    title: 'Builder/Components/Button',
    component: Button,
    parameters: {
        layout: 'centered',
        docs: {
            description: {
                component: 'React Aria ê¸°ë°˜ì˜ ì ‘ê·¼ ê°€ëŠ¥í•œ ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.',
            },
        },
    },
    argTypes: {
        variant: {
            control: 'radio',
            options: ['primary', 'secondary'],
            description: 'ë²„íŠ¼ì˜ ì‹œê°ì  ìŠ¤íƒ€ì¼ ë³€í˜•',
        },
        size: {
            control: 'radio',
            options: ['sm', 'md', 'lg'],
            description: 'ë²„íŠ¼ì˜ í¬ê¸°',
        },
        isDisabled: {
            control: 'boolean',
            description: 'ë²„íŠ¼ ë¹„í™œì„±í™” ìƒíƒœ',
        },
    },
};

export default meta;
type Story = StoryObj<typeof Button>;

export const Primary: Story = {
    args: {
        children: 'ê¸°ë³¸ ë²„íŠ¼',
        variant: 'primary',
    },
};

export const Secondary: Story = {
    args: {
        children: 'ë³´ì¡° ë²„íŠ¼',
        variant: 'secondary',
    },
};

export const AllSizes: Story = {
    render: () => (
        <div className="flex gap-4 items-center">
            <Button size="sm">ì‘ì€ ë²„íŠ¼</Button>
            <Button size="md">ë³´í†µ ë²„íŠ¼</Button>
            <Button size="lg">í° ë²„íŠ¼</Button>
        </div>
    ),
};
```

## ë³´ì•ˆ ë° ê²€ì¦

### ì…ë ¥ ê²€ì¦ íŒ¨í„´
```typescript
// âœ… DO: ì² ì €í•œ ì…ë ¥ ê²€ì¦
import { z } from 'zod';

const ElementPropsSchema = z.object({
    id: z.string().uuid(),
    tag: z.string().min(1).max(50),
    props: z.record(z.any()),
    parent_id: z.string().uuid().nullable(),
    page_id: z.string().uuid(),
    order_num: z.number().int().min(0),
});

export function validateElementProps(data: unknown): ElementProps {
    return ElementPropsSchema.parse(data);
}

// ì‚¬ìš© ì˜ˆì‹œ
export async function createElementSafely(rawData: unknown) {
    try {
        const validatedData = validateElementProps(rawData);
        return await ElementsApiService.createElement(validatedData);
    } catch (error) {
        if (error instanceof z.ZodError) {
            throw new Error(`ì…ë ¥ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨: ${error.message}`);
        }
        throw error;
    }
}
```

## ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹…

### í†µí•© ì—ëŸ¬ ì²˜ë¦¬
```typescript
// âœ… DO: ì¼ê´€ëœ ì—ëŸ¬ ì²˜ë¦¬
export class AppError extends Error {
    constructor(
        message: string,
        public code: string,
        public statusCode: number = 500
    ) {
        super(message);
        this.name = 'AppError';
    }
}

export function handleApiError(error: any, context: string): AppError {
    console.error(`[${context}]`, error);
    
    if (error instanceof AppError) {
        return error;
    }
    
    if (error?.code === 'PGRST116') {
        return new AppError('ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'NOT_FOUND', 404);
    }
    
    if (error?.message?.includes('duplicate key')) {
        return new AppError('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë°ì´í„°ì…ë‹ˆë‹¤', 'DUPLICATE', 409);
    }
    
    return new AppError(
        error?.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤',
        'UNKNOWN_ERROR'
    );
}

// ì‚¬ìš© ì˜ˆì‹œ
export function useErrorHandler() {
    const showError = useCallback((message: string, error?: any) => {
        const appError = error ? handleApiError(error, message) : new AppError(message, 'USER_ERROR');
        
        // Toast ì•Œë¦¼ ë˜ëŠ” ì—ëŸ¬ ìƒíƒœ ì„¤ì •
        console.error(appError);
        // showToast(appError.message);
    }, []);
    
    return { showError };
}
```

## ê°œë°œ ì›Œí¬í”Œë¡œìš°

### ê°œë°œ ì„œë²„ ë° ë„êµ¬
- **ê°œë°œ ì„œë²„**: `npm run dev` (Vite ê°œë°œ ì„œë²„)
- **Storybook**: `npm run storybook` (ì»´í¬ë„ŒíŠ¸ ë¬¸ì„œ)
- **í…ŒìŠ¤íŠ¸**: `npm run test` (Vitest)
- **ë¹Œë“œ**: `npm run build` (í”„ë¡œë•ì…˜ ë¹Œë“œ)

### Git ì»¤ë°‹ ê·œì¹™
```bash
# âœ… DO: ëª…í™•í•œ ì»¤ë°‹ ë©”ì‹œì§€
feat: ìƒˆë¡œìš´ Button ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
fix: ElementStoreì˜ ì„ íƒ ìƒíƒœ ì´ˆê¸°í™” ë²„ê·¸ ìˆ˜ì •
refactor: useElementCreator í›… ì„±ëŠ¥ ìµœì í™”
docs: API ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ ë¬¸ì„œ ì—…ë°ì´íŠ¸
test: Button ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€

# âŒ DON'T: ëª¨í˜¸í•œ ì»¤ë°‹ ë©”ì‹œì§€
fix: ë²„ê·¸ ìˆ˜ì •
update: ì½”ë“œ ë³€ê²½
misc: ê¸°íƒ€ ìˆ˜ì •
```

### ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] TypeScript íƒ€ì… ì•ˆì „ì„± í™•ì¸
- [ ] React í›… ê·œì¹™ ì¤€ìˆ˜ (ì˜ì¡´ì„± ë°°ì—´, ì¡°ê±´ë¶€ í˜¸ì¶œ ê¸ˆì§€)
- [ ] ì„±ëŠ¥ ìµœì í™” (ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€)
- [ ] ì ‘ê·¼ì„± ê³ ë ¤ (ARIA ì†ì„±, í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜)
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ê²€ì¦
- [ ] í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
- [ ] Storybook ë¬¸ì„œí™”
- [ ] ë³´ì•ˆ ê²€ì¦ (ì…ë ¥ ê²€ì¦, XSS ë°©ì§€)
- [ ] ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€

## ì•Œë ¤ì§„ ì£¼ì˜ì‚¬í•­ ë° ì œí•œì‚¬í•­

### ê°œë°œ ì‹œ ì£¼ì˜í•  ì 
1. **BuilderCore.tsx ë³µì¡ì„±**: í° ì»´í¬ë„ŒíŠ¸ëŠ” ê¸°ëŠ¥ë³„ë¡œ ë¶„ë¦¬ëœ ì»¤ìŠ¤í…€ í›… ì‚¬ìš© ê¶Œì¥
2. **Supabase ë™ê¸°í™”**: ìƒíƒœì™€ ë°ì´í„°ë² ì´ìŠ¤ ê°„ ì¼ê´€ì„± ìœ ì§€ì— ì£¼ì˜
3. **iframe ë©”ì‹œì§€ ì²˜ë¦¬**: ë³´ì•ˆ ë° ì„±ëŠ¥ì„ ìœ„í•´ ë©”ì‹œì§€ ê²€ì¦ í•„ìˆ˜
4. **íƒ€ì… ì•ˆì „ì„±**: `any` íƒ€ì… ì‚¬ìš© ì§€ì–‘, êµ¬ì²´ì ì¸ íƒ€ì… ì •ì˜ ê¶Œì¥
5. **ë©”ëª¨ë¦¬ ê´€ë¦¬**: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì™€ íƒ€ì´ë¨¸ ì •ë¦¬ í•„ìˆ˜

### ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­
```typescript
// âœ… DO: ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
import { PerformanceMonitor } from '../utils/performanceMonitor';

export function useOptimizedElementUpdate() {
    const updateElement = useCallback(async (elementId: string, props: any) => {
        PerformanceMonitor.startMeasure('elementUpdate');
        
        try {
            // 1. ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸ (ë‚™ê´€ì  ì—…ë°ì´íŠ¸)
            updateElementLocal(elementId, props);
            
            // 2. ë””ë°”ìš´ìŠ¤ëœ ì„œë²„ ë™ê¸°í™”
            debouncedSupabaseUpdate(elementId, props);
        } finally {
            PerformanceMonitor.endMeasure('elementUpdate');
        }
    }, []);
    
    return { updateElement };
}
```

### ë””ë²„ê¹… ë„êµ¬
```typescript
// âœ… DO: ê°œë°œ ëª¨ë“œ ë””ë²„ê¹…
if (process.env.NODE_ENV === 'development') {
    // ìš”ì†Œ ìƒì„± ë¡œê·¸
    console.log(`ğŸ§© Element created: ${newElement.id} (${newElement.tag})`);
    
    // ìƒíƒœ ë³€ê²½ ì¶”ì 
    console.log('ğŸ”„ Store state changed:', {
        selectedElementId,
        elementsCount: elements.length
    });
    
    // ì„±ëŠ¥ ê²½ê³ 
    if (renderTime > 16) {
        console.warn(`âš ï¸ Slow render detected: ${renderTime}ms`);
    }
}
```

## í…Œë§ˆ ë° ë””ìì¸ í† í° ì‹œìŠ¤í…œ

### ë””ìì¸ í† í° êµ¬ì¡°
```typescript
// âœ… DO: ì²´ê³„ì ì¸ ë””ìì¸ í† í° ê´€ë¦¬
interface DesignToken {
    id: string;
    name: string;
    type: 'color' | 'spacing' | 'typography' | 'shadow' | 'border';
    value: any;
    scope: 'raw' | 'semantic';
    alias_of?: string;
    css_variable: string;
}

// Raw í† í° (ê¸°ë³¸ê°’)
const rawTokens: DesignToken[] = [
    {
        id: '1',
        name: 'blue-500',
        type: 'color',
        value: { r: 59, g: 130, b: 246, a: 1 },
        scope: 'raw',
        css_variable: '--color-blue-500'
    }
];

// Semantic í† í° (ì˜ë¯¸ ê¸°ë°˜)
const semanticTokens: DesignToken[] = [
    {
        id: '2',
        name: 'primary',
        type: 'color',
        value: 'blue-500',
        scope: 'semantic',
        alias_of: 'blue-500',
        css_variable: '--color-primary'
    }
];
```

### CSS ë³€ìˆ˜ ìƒì„±
```typescript
// âœ… DO: ìë™ CSS ë³€ìˆ˜ ìƒì„±
export function generateCSSVariables(tokens: DesignToken[]): string {
    return tokens.map(token => {
        const value = token.scope === 'semantic' && token.alias_of
            ? `var(--${token.alias_of.replace(/\./g, '-')})`
            : formatTokenValue(token.value, token.type);
            
        return `${token.css_variable}: ${value};`;
    }).join('\n');
}

function formatTokenValue(value: any, type: string): string {
    switch (type) {
        case 'color':
            if (typeof value === 'object') {
                return `rgba(${value.r}, ${value.g}, ${value.b}, ${value.a})`;
            }
            return value;
        case 'spacing':
            return `${value}px`;
        case 'typography':
            return `${value.size}px/${value.lineHeight} ${value.family}`;
        default:
            return String(value);
    }
}
```

## ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¥

### ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ ì ˆì°¨
1. **React Aria ì»´í¬ë„ŒíŠ¸ ìƒì„±**: `src/builder/components/NewComponent.tsx`
2. **ì†ì„± ì—ë””í„° ìƒì„±**: `src/builder/inspector/properties/editors/NewComponentEditor.tsx`
3. **ê¸°ë³¸ê°’ ì •ì˜**: `getDefaultProps` í•¨ìˆ˜ì— ì¶”ê°€
4. **ì»´í¬ë„ŒíŠ¸ íŒ©í† ë¦¬ ë“±ë¡**: `ComponentFactory.ts`ì— ë“±ë¡
5. **Storybook ìŠ¤í† ë¦¬ ì‘ì„±**: `src/stories/NewComponent.stories.tsx`

```typescript
// âœ… DO: ìƒˆ ì»´í¬ë„ŒíŠ¸ ë“±ë¡ ì˜ˆì‹œ
// 1. ComponentFactory.tsì— ë“±ë¡
export const ComponentFactory = {
    // ... ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ë“¤
    'my-new-component': {
        create: (props: any) => <MyNewComponent {...props} />,
        defaultProps: {
            text: 'ìƒˆ ì»´í¬ë„ŒíŠ¸',
            variant: 'default',
            size: 'md'
        },
        editableProps: ['text', 'variant', 'size'],
        category: 'form' // ë˜ëŠ” 'layout', 'content', 'media'
    }
};

// 2. ì†ì„± ì—ë””í„° ìƒì„±
export function MyNewComponentEditor({ element, onChange }: EditorProps) {
    return (
        <div className="space-y-4">
            <PropertyInput
                label="í…ìŠ¤íŠ¸"
                value={element.props.text}
                onChange={(text) => onChange({ text })}
            />
            <PropertySelect
                label="ë³€í˜•"
                value={element.props.variant}
                options={[
                    { value: 'default', label: 'ê¸°ë³¸' },
                    { value: 'outline', label: 'ì•„ì›ƒë¼ì¸' }
                ]}
                onChange={(variant) => onChange({ variant })}
            />
        </div>
    );
}
```

## ê³ ê¸‰ ìƒíƒœ ê´€ë¦¬ íŒ¨í„´

### íˆìŠ¤í† ë¦¬ ê´€ë¦¬ (Undo/Redo)
```typescript
// âœ… DO: íš¨ìœ¨ì ì¸ íˆìŠ¤í† ë¦¬ ê´€ë¦¬
interface HistoryState {
    past: ElementState[];
    present: ElementState;
    future: ElementState[];
}

const useHistoryStore = create<HistoryState & {
    undo: () => void;
    redo: () => void;
    pushHistory: (newState: ElementState) => void;
    canUndo: boolean;
    canRedo: boolean;
}>()(
    immer((set, get) => ({
        past: [],
        present: { elements: [], selectedElementId: null },
        future: [],
        
        get canUndo() {
            return get().past.length > 0;
        },
        
        get canRedo() {
            return get().future.length > 0;
        },
        
        undo: () => set((state) => {
            if (state.past.length === 0) return;
            
            const previous = state.past.pop()!;
            state.future.unshift(state.present);
            state.present = previous;
        }),
        
        redo: () => set((state) => {
            if (state.future.length === 0) return;
            
            const next = state.future.shift()!;
            state.past.push(state.present);
            state.present = next;
        }),
        
        pushHistory: (newState) => set((state) => {
            // í˜„ì¬ ìƒíƒœë¥¼ ê³¼ê±°ë¡œ ì´ë™
            state.past.push(state.present);
            state.present = newState;
            
            // ë¯¸ë˜ ê¸°ë¡ ì´ˆê¸°í™”
            state.future = [];
            
            // íˆìŠ¤í† ë¦¬ í¬ê¸° ì œí•œ (ìµœëŒ€ 50ê°œ)
            if (state.past.length > 50) {
                state.past.shift();
            }
        })
    }))
);
```

### ë³µì¡í•œ í¼ ìƒíƒœ ê´€ë¦¬
```typescript
// âœ… DO: í¼ ìƒíƒœì™€ ê²€ì¦
interface FormState<T> {
    values: T;
    errors: Partial<Record<keyof T, string>>;
    touched: Partial<Record<keyof T, boolean>>;
    isValid: boolean;
    isDirty: boolean;
}

export function useFormState<T extends Record<string, any>>(
    initialValues: T,
    validationSchema?: z.ZodSchema<T>
) {
    const [state, setState] = useState<FormState<T>>({
        values: initialValues,
        errors: {},
        touched: {},
        isValid: true,
        isDirty: false
    });
    
    const setValue = useCallback(<K extends keyof T>(
        field: K,
        value: T[K]
    ) => {
        setState(prev => {
            const newValues = { ...prev.values, [field]: value };
            
            // ê²€ì¦ ì‹¤í–‰
            let errors = {};
            let isValid = true;
            
            if (validationSchema) {
                try {
                    validationSchema.parse(newValues);
                } catch (error) {
                    if (error instanceof z.ZodError) {
                        errors = error.flatten().fieldErrors;
                        isValid = false;
                    }
                }
            }
            
            return {
                values: newValues,
                errors,
                touched: { ...prev.touched, [field]: true },
                isValid,
                isDirty: true
            };
        });
    }, [validationSchema]);
    
    const reset = useCallback(() => {
        setState({
            values: initialValues,
            errors: {},
            touched: {},
            isValid: true,
            isDirty: false
        });
    }, [initialValues]);
    
    return {
        ...state,
        setValue,
        reset
    };
}
```

## êµ­ì œí™” ë° ì ‘ê·¼ì„±

### ì ‘ê·¼ì„± ê³ ë ¤ì‚¬í•­
```typescript
// âœ… DO: ì ‘ê·¼ì„±ì„ ê³ ë ¤í•œ ì»´í¬ë„ŒíŠ¸
import { useId } from 'react';
import { VisuallyHidden } from 'react-aria-components';

export function AccessibleFormField({ 
    label, 
    error, 
    children,
    isRequired = false 
}: {
    label: string;
    error?: string;
    children: React.ReactElement;
    isRequired?: boolean;
}) {
    const id = useId();
    const errorId = useId();
    
    return (
        <div className="form-field">
            <label 
                htmlFor={id}
                className="block text-sm font-medium text-gray-700"
            >
                {label}
                {isRequired && (
                    <span className="text-red-500 ml-1" aria-label="í•„ìˆ˜ í•­ëª©">
                        *
                    </span>
                )}
            </label>
            
            {React.cloneElement(children, {
                id,
                'aria-describedby': error ? errorId : undefined,
                'aria-invalid': !!error,
                'aria-required': isRequired
            })}
            
            {error && (
                <div
                    id={errorId}
                    className="mt-1 text-sm text-red-600"
                    role="alert"
                >
                    <VisuallyHidden>ì˜¤ë¥˜: </VisuallyHidden>
                    {error}
                </div>
            )}
        </div>
    );
}
```

### í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
```typescript
// âœ… DO: í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì§€ì›
export function useKeyboardShortcuts() {
    useEffect(() => {
        const handleKeyDown = (event: KeyboardEvent) => {
            // Ctrl/Cmd + Z: ì‹¤í–‰ ì·¨ì†Œ
            if ((event.ctrlKey || event.metaKey) && event.key === 'z' && !event.shiftKey) {
                event.preventDefault();
                undo();
            }
            
            // Ctrl/Cmd + Shift + Z: ë‹¤ì‹œ ì‹¤í–‰
            if ((event.ctrlKey || event.metaKey) && event.key === 'z' && event.shiftKey) {
                event.preventDefault();
                redo();
            }
            
            // Delete: ì„ íƒëœ ìš”ì†Œ ì‚­ì œ
            if (event.key === 'Delete' && selectedElementId) {
                event.preventDefault();
                deleteElement(selectedElementId);
            }
            
            // Escape: ì„ íƒ í•´ì œ
            if (event.key === 'Escape') {
                event.preventDefault();
                selectElement(null);
            }
        };
        
        document.addEventListener('keydown', handleKeyDown);
        return () => document.removeEventListener('keydown', handleKeyDown);
    }, [selectedElementId, undo, redo, deleteElement, selectElement]);
}
```

## ë°°í¬ ë° í™˜ê²½ ê´€ë¦¬

### í™˜ê²½ë³„ ì„¤ì •
```typescript
// âœ… DO: í™˜ê²½ë³„ ì„¤ì • ê´€ë¦¬
interface AppConfig {
    apiUrl: string;
    supabaseUrl: string;
    supabaseKey: string;
    isDevelopment: boolean;
    isProduction: boolean;
    enableDebugLogs: boolean;
}

export const config: AppConfig = {
    apiUrl: import.meta.env.VITE_API_URL || 'http://localhost:3000',
    supabaseUrl: import.meta.env.VITE_SUPABASE_URL!,
    supabaseKey: import.meta.env.VITE_SUPABASE_ANON_KEY!,
    isDevelopment: import.meta.env.DEV,
    isProduction: import.meta.env.PROD,
    enableDebugLogs: import.meta.env.VITE_ENABLE_DEBUG_LOGS === 'true'
};

// í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
function validateConfig() {
    const requiredVars = ['VITE_SUPABASE_URL', 'VITE_SUPABASE_ANON_KEY'];
    const missing = requiredVars.filter(key => !import.meta.env[key]);
    
    if (missing.length > 0) {
        throw new Error(`í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤: ${missing.join(', ')}`);
    }
}

validateConfig();
```

### ë¹Œë“œ ìµœì í™”
```typescript
// vite.config.ts ìµœì í™” ì„¤ì •
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react-swc';

export default defineConfig({
    plugins: [react()],
    build: {
        // ì²­í¬ ë¶„í•  ìµœì í™”
        rollupOptions: {
            output: {
                manualChunks: {
                    vendor: ['react', 'react-dom'],
                    ui: ['react-aria-components'],
                    utils: ['lodash', 'zustand']
                }
            }
        },
        // ë²ˆë“¤ í¬ê¸° ë¶„ì„
        reportCompressedSize: true,
        // ì†ŒìŠ¤ë§µ ìƒì„± (í”„ë¡œë•ì…˜ì—ì„œëŠ” ì œê±°)
        sourcemap: process.env.NODE_ENV !== 'production'
    },
    // ê°œë°œ ì„œë²„ ì„¤ì •
    server: {
        port: 3000,
        open: true,
        cors: true
    }
});
```

## ë§ˆì´ê·¸ë ˆì´ì…˜ ë° ë°ì´í„° ë°±ì—…

### ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
```sql
-- âœ… DO: ì•ˆì „í•œ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì˜ˆì‹œ
-- 2024-03-01: elements í…Œì´ë¸”ì— version ì»¬ëŸ¼ ì¶”ê°€
ALTER TABLE public.elements 
ADD COLUMN IF NOT EXISTS version INTEGER DEFAULT 1;

-- ì¸ë±ìŠ¤ ì¶”ê°€
CREATE INDEX IF NOT EXISTS idx_elements_version 
ON public.elements(version);

-- ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ (í•„ìš”í•œ ê²½ìš°)
UPDATE public.elements 
SET version = 1 
WHERE version IS NULL;

-- NOT NULL ì œì•½ ì¡°ê±´ ì¶”ê°€
ALTER TABLE public.elements 
ALTER COLUMN version SET NOT NULL;
```

### ë°±ì—… ì „ëµ
```typescript
// âœ… DO: ìë™ ë°±ì—… ìœ í‹¸ë¦¬í‹°
export class BackupService {
    static async exportProject(projectId: string): Promise<ProjectBackup> {
        try {
            const [project, pages, elements, tokens] = await Promise.all([
                ProjectsApiService.getProject(projectId),
                PagesApiService.getProjectPages(projectId),
                ElementsApiService.getProjectElements(projectId),
                DesignTokensApiService.getProjectTokens(projectId)
            ]);
            
            const backup: ProjectBackup = {
                version: '1.0',
                timestamp: new Date().toISOString(),
                project,
                pages,
                elements,
                designTokens: tokens
            };
            
            return backup;
        } catch (error) {
            throw new Error(`í”„ë¡œì íŠ¸ ë°±ì—… ì‹¤íŒ¨: ${error.message}`);
        }
    }
    
    static async importProject(backup: ProjectBackup): Promise<string> {
        // ë°±ì—… ë°ì´í„° ê²€ì¦ ë° ë³µì› ë¡œì§
        // íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¡œ ì›ìì„± ë³´ì¥
    }
}
```

---

ì´ í†µí•© ê·œì¹™ ë¬¸ì„œëŠ” XStudio í”„ë¡œì íŠ¸ì˜ ê°œë°œ, ìœ ì§€ë³´ìˆ˜, í™•ì¥ì„ ìœ„í•œ ì¢…í•©ì ì¸ ê°€ì´ë“œë¼ì¸ì„ ì œê³µí•©ë‹ˆë‹¤. ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ë‚˜ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì‹œ ì´ ê·œì¹™ë“¤ì„ ì°¸ê³ í•˜ì—¬ ì¼ê´€ì„± ìˆê³  ì•ˆì •ì ì¸ ì½”ë“œë² ì´ìŠ¤ë¥¼ ìœ ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.