import{r as c,u as m,j as a,P as r,a as C,b as n,f as A,F as D,D as f,y as B,d as x,ai as L,aC as _,e as g,T as N,H as y,aw as O,i as h,g as K,E as w,h as R}from"./index-CvhBI1Ng.js";import{P as s}from"./labels-C7QIhqP9.js";import{S as F}from"./square-x-BXKdMJlE.js";import{P as M}from"./pointer-off-D2dgyk3N.js";import{F as k}from"./focus-zrqomX56.js";const Y=[{value:"none",label:s.NONE},{value:"single",label:s.SINGLE},{value:"multiple",label:s.MULTIPLE}],P=[{value:"replace",label:s.REPLACE},{value:"toggle",label:s.TOGGLE}],V=c.memo(function({elementId:d,currentProps:t,onUpdate:S}){const{addElement:I}=m(),[E,u]=c.useState(""),T=c.useMemo(()=>m.getState().elementsMap.get(d)?.customId||"",[d]),i=(e,l)=>{const o={...t,[e]:l};S(o)},j=e=>{const l={...t,dataBinding:e||void 0};S(l)},b=c.useMemo(()=>{const{elements:e}=m.getState();return e.filter(l=>l.parent_id===d&&l.tag==="TreeItem").sort((l,o)=>(l.order_num||0)-(o.order_num||0))},[d]);c.useEffect(()=>{const{currentPageId:e}=m.getState();e&&u(e)},[]);const v=async()=>{try{if(!E){alert("íŽ˜ì´ì§€ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.");return}const{elements:e}=m.getState(),l=b.length||0,o={id:w.generateId(),customId:K("TreeItem",e),page_id:E,tag:"TreeItem",props:{title:`Item ${l+1}`,value:`Item ${l+1}`,children:`Item ${l+1}`,isDisabled:!1,style:{},className:""},parent_id:d,order_num:l},p=await(await R()).elements.insert(o);I(p),console.log("âœ… [IndexedDB] ìƒˆ TreeItemì´ ì¶”ê°€ë¨:",p)}catch(e){console.error("Add TreeItem error:",e),alert("TreeItem ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}};return a.jsxs(a.Fragment,{children:[a.jsx(r,{title:"Basic",children:a.jsx(C,{label:"ID",value:T,elementId:d,placeholder:"tree_1"})}),a.jsxs(r,{title:"Content",children:[a.jsx(n,{label:s.LABEL,value:String(t.label||""),onChange:e=>i("label",e||void 0),icon:A}),a.jsx(n,{label:s.DESCRIPTION,value:String(t.description||""),onChange:e=>i("description",e||void 0),icon:D})]}),a.jsx(r,{title:"Data Binding",icon:f,children:a.jsx(B,{label:"ë°ì´í„° ì†ŒìŠ¤",value:t.dataBinding,onChange:j})}),a.jsxs(r,{title:"State",children:[a.jsx(x,{label:s.SELECTION_MODE,value:String(t.selectionMode||"single"),onChange:e=>i("selectionMode",e),options:Y,icon:L}),a.jsx(x,{label:s.SELECTION_BEHAVIOR,value:String(t.selectionBehavior||"replace"),onChange:e=>i("selectionBehavior",e),options:P,icon:_}),a.jsx(g,{label:s.DISALLOW_EMPTY_SELECTION,isSelected:!!t.disallowEmptySelection,onChange:e=>i("disallowEmptySelection",e),icon:F}),a.jsx(n,{label:s.EXPANDED_KEYS,value:Array.isArray(t.expandedKeys)?t.expandedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("expandedKeys",l)},placeholder:"item1, item2, item3"}),a.jsx(n,{label:s.SELECTED_KEYS,value:Array.isArray(t.selectedKeys)?t.selectedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("selectedKeys",l)},placeholder:"item1, item2"}),a.jsx(n,{label:s.DEFAULT_EXPANDED_KEYS,value:Array.isArray(t.defaultExpandedKeys)?t.defaultExpandedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("defaultExpandedKeys",l)},placeholder:"item1, item2"}),a.jsx(n,{label:s.DEFAULT_SELECTED_KEYS,value:Array.isArray(t.defaultSelectedKeys)?t.defaultSelectedKeys.join(", "):"",onChange:e=>{const l=e?e.split(",").map(o=>o.trim()).filter(Boolean):[];i("defaultSelectedKeys",l)},placeholder:"item1"})]}),a.jsxs(r,{title:"Behavior",children:[a.jsx(g,{label:s.DISABLED,isSelected:!!t.isDisabled,onChange:e=>i("isDisabled",e),icon:M}),a.jsx(g,{label:s.AUTO_FOCUS,isSelected:!!t.autoFocus,onChange:e=>i("autoFocus",e),icon:k})]}),a.jsxs(r,{title:"Accessibility",children:[a.jsx(n,{label:s.ARIA_LABEL,value:String(t["aria-label"]||""),onChange:e=>i("aria-label",e||void 0),icon:N,placeholder:"Tree label for screen readers"}),a.jsx(n,{label:s.ARIA_LABELLEDBY,value:String(t["aria-labelledby"]||""),onChange:e=>i("aria-labelledby",e||void 0),icon:y,placeholder:"label-element-id"}),a.jsx(n,{label:s.ARIA_DESCRIBEDBY,value:String(t["aria-describedby"]||""),onChange:e=>i("aria-describedby",e||void 0),icon:y,placeholder:"description-element-id"})]}),a.jsxs(r,{title:s.TREE_ITEMS,children:[a.jsxs("div",{className:"tree-overview",children:[a.jsxs("p",{className:"tree-overview-text",children:["Total tree items: ",b.length||0]}),a.jsx("p",{className:"tree-overview-help",children:"ðŸ’¡ Select individual tree items from layer tree to edit their properties"})]}),a.jsx("div",{className:"tree-actions",children:a.jsxs("button",{className:"control-button add",onClick:v,disabled:!E,children:[a.jsx(O,{color:h.color,strokeWidth:h.stroke,size:h.size}),"Add TreeItem"]})})]})]})});export{V as TreeEditor};
